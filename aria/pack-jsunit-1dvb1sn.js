/*
 * Copyright 2009-2015 Amadeus s.a.s.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
//***MULTI-PART
//*******************
//LOGICAL-PATH:aria/jsunit/$RobotSelection.js
//*******************
var e=require("noder-js/promise"),t=require("../Aria"),i=null,r=(new Date).getTime()+2e3,s=function(){return t.$frameworkWindow.top.phantomJSRobot?"aria.jsunit.RobotPhantomJS":t.$frameworkWindow.top.SeleniumJavaRobot?"aria.jsunit.RobotJavaSelenium":null},a=new e(function(e){var t=function(){i=s(),i||(new Date).getTime()>r?e():setTimeout(t,100)};t()}),n=exports.getRobotClasspath=function(){return i};n.$preload=function(){return a};
//*******************
//LOGICAL-PATH:aria/jsunit/Test.js
//*******************
var e=require("../Aria"),t=require("../core/ClassMgr");module.exports=e.classDefinition({$classpath:"aria.jsunit.Test",$events:{failure:"",error:"",stateChange:"",start:"",end:"",testLoad:"",preloadEnd:""},$constructor:function(){this._isFinished=!1,this._parentTest=null,this._executionTime=-1,this._errors=[],this._failedOnCreate=!1,this.$JsObject.constructor.call(this)},$destructor:function(){if(this._parentTest=null,!this._failedOnCreate){var i=e.getClassRef(this.$classpath);if(t.unloadClass(this.$classpath),i&&i.classDefinition&&i.classDefinition.$dependencies)for(var r=i.classDefinition.$dependencies,s=0,a=r.length;a>s;s+=1)"test."==r[s].substring(0,5)&&t.unloadClass(r[s])}this.$JsObject.$destructor.call(this)},$prototype:{run:function(){},_startTest:function(){this._timestampBegin=(new Date).getTime()},_endTest:function(){this._timestampEnd=(new Date).getTime(),this._executionTime=this._timestampEnd-this._timestampBegin},getExecutionTime:function(){return this._executionTime},setParentTest:function(e){this._parentTest=e},getParentTest:function(){return this._parentTest},isFinished:function(){return this._isFinished===!0},getFinishedTestsCount:function(){return this._testPassed},init:function(){this.$raiseEvent({name:"preloadEnd",testSuite:this})},hasError:function(){return this.getErrors().length>0},getErrors:function(){return this._errors},hasWarning:function(){return!1},getExecutionErrors:function(){for(var e=[],t=this.getErrors(),i=0,r=t.length;r>i;i++){var s=t[i];s.type==this.ERROR_TYPES.ERROR&&e.push(s)}return e},getFailures:function(){for(var e=[],t=this.getErrors(),i=0,r=t.length;r>i;i++){var s=t[i];s.type==this.ERROR_TYPES.FAILURE&&e.push(s)}return e},raiseError:function(e,t){var i=e.description?e.description:e.message;i="["+i+"]",t&&(i+=" "+t),this._errors.push({type:this.ERROR_TYPES.ERROR,testMethod:this._currentTestName,description:i}),this.$raiseEvent({name:"error",testClass:this.$classpath,testState:this._currentTestName,exception:e,msg:i})},raiseFailure:function(e){this._errors.push({type:this.ERROR_TYPES.FAILURE,testMethod:this._currentTestName,description:e}),this.$raiseEvent({name:"failure",testClass:this.$classpath,testState:this._currentTestName,description:e})}}});
//*******************
//LOGICAL-PATH:aria/jsunit/Assert.js
//*******************
var e=require("../Aria"),t=require("../core/Log"),i=require("../utils/Type"),r=require("../utils/String"),s=require("../utils/Json");!function(){var a=e.$global.console,n=function(e,t){if(e===t)return null;if(typeof t!=typeof e)return[];if("object"==typeof t)for(var i in t){var r=n(e[i],t[i]);if(null!=r)return r.unshift(i),r}else if(e!=t)return[];return null};module.exports=e.classDefinition({$classpath:"aria.jsunit.Assert",$extends:require("./Test"),$statics:{ERROR_TYPES:{ERROR:"error",FAILURE:"failure"}},$constructor:function(){this.$Test.constructor.call(this),this._currentTestName="",this._assertCount=0,this._totalAssertCount=0,this._overriddenClasses=null,this._expectedEventsList=null,this._eventIndexInList=0,this.evtLogs=[],this._expectedErrorList=null,t.clearAppenders(),t.addAppender(new(require("../core/log/SilentArrayAppender"))),e.verbose&&t.addAppender(new(require("../core/log/DefaultAppender"))),t.resetLoggingLevels(),t.setLoggingLevel("*",1)},$destructor:function(){this._expectedEventsList=null,this.$Test.$destructor.call(this)},$prototype:{ASSERT_FAILURE:"Assert Failure",_startTest:function(){this.$Test._startTest.call(this),this._totalAssertCount=0,this.$raiseEvent({name:"start",testObject:this,testClass:this.$classpath})},_endTest:function(){this.$Test._endTest.call(this),this.checkExpectedEventListEnd(),this.resetClassOverrides(),this.assertLogsEmpty(!1,!1),this._assertCount=0,this._currentTestName="",this._isFinished=!0,this.$raiseEvent({name:"end",testObject:this,testClass:this.$classpath,nbrOfAsserts:this._totalAssertCount})},_updateAssertInfo:function(e){this._assertCount=0,this._currentTestName=e,this.$raiseEvent({name:"stateChange",testClass:this.$classpath,testState:this._currentTestName})},assertTrue:function(e,t){if(this._assertCount++,this._totalAssertCount++,e!==!0){var r="Assert #"+this._assertCount+" failed";throw t&&(r+=" : "+t),this.raiseFailure(r),a&&i.isFunction(a.trace)&&a.assert(!1,"Stack trace for failed Assert #"+this._assertCount+" in test : ["+this._currentTestName+"]"),{name:this.ASSERT_FAILURE,message:r}}},assertFalse:function(e,t){this.assertTrue(e===!1,t||"Expected false. Got: "+e)},assertNull:function(e,t){this.assertTrue(null===e,t||"Expected value to be null. Got: "+e)},assertNotNull:function(e,t){this.assertTrue(null!==e,t||"Expected value to be not null. Got: null")},assertUndefined:function(e,t){this.assertTrue(void 0===e,t||"Expected undefined. Got: "+e)},assertNotUndefined:function(e,t){this.assertTrue(void 0!==e,t||"Expected value to not be undefined. Got: undefined")},assertTruthy:function(e,t){this.assertTrue(e?!0:!1,t||"Expected a truthy value. Got: "+e)},assertFalsy:function(e,t){this.assertTrue(e?!1:!0,t||"Expected a falsy value. Got: "+e)},assertEquals:function(e,t,i){var s;s=i?r.substitute(i,['"'+e+'"','"'+t+'"']):'First value: "'+e+'" differs from the second: "'+t+'".',this.assertTrue(e===t,s)},assertEqualsWithTolerance:function(e,t,i,s){var a;a=s?r.substitute(s,['"'+e+'"','"'+t+'"']):"First value: "+e+", second value: "+t+", tolerance was: "+i,this.assertTrue(Math.abs(e-t)<=i,a)},assertNotEquals:function(e,t,i){var r=i||"First and second value shouldn't be equal but they are both equal to: "+e;this.assertTrue(e!==t,r)},assertLogsEmpty:function(e,r){r!==!1&&(this._assertCount++,this._totalAssertCount++);var s=t.getAppenders()[0];if(!s.isEmpty()){for(var n=s.getLogs(),o=!1,l="",c=0;c<n.length;c++){var h=n[c];if("error"==h.level){o=!0,l="Uncaught error detected: ["+h.className+"] "+h.msg;var u=h.objOrErr;u&&(u.logDetails&&u.logDetails(),l+="\n",l+=u.name&&u.message?u.name+": "+u.message:u,a&&i.isFunction(a.error)&&a.error(this.$classpath+"."+this._currentTestName+": "+l+"\n"+u.stack)),this.raiseFailure(l)}}if(s.empty(),o&&e!==!1)throw{name:this.ASSERT_FAILURE,message:l}}},assertErrorInLogs:function(e,i){var r=null,s=t.getAppenders()[0],a=s.getLogs(),n=!1,o=[];if(e||this.assertTrue(!1,"assertErrorInLogs was called with a null error message."),i&&i>0){r=[];for(var l=0,c=0;a.length>c;c++)i>l&&a[c].msgId==e?(l++,r.push(a[c])):o.push(a[c]);s.setLogs(o),this.assertTrue(l==i,"Expected error "+e+" found "+l+" times in logs")}else{for(var c=0;a.length>c;c++)a[c].msgId==e?(n=!0,r=a[c]):o.push(a[c]);s.setLogs(o),this.assertTrue(n,"Expected error not found in logs: "+e)}return r},assertJsonContains:function(e,t,i){this.assertTrue(s.contains(e,t),i)},assertJsonEquals:function(e,t,i){if(!i){var r={indent:"   "},a=s.convertToJsonString(e,r),n=s.convertToJsonString(t,r);i="JSON comparison failed. First object:<br><code><pre>"+a+"</pre></code> differs from the second:<br><code><pre>"+n+"</pre></code>"}this.assertTrue(s.equals(e,t),i)},assertJsonNotEquals:function(e,t,i){this.assertFalse(s.equals(e,t),i)},fail:function(e){var t="Forced Failure";throw e&&(t+=" ("+e+")"),this.raiseFailure(t),{name:this.ASSERT_FAILURE,message:t}},registerObject:function(e){e.$on({"*":this._logEvent,scope:this})},unregisterObject:function(e){e.$removeListeners({"*":this._logEvent,scope:this})},_logEvent:function(e){this.evtLogs.push(e)},assertEventFired:function(e,t){t=t||"Event "+e+" not fired",this.assertTrue(this.__hasEvent(e),t)},assertEventNotFired:function(e,t){t=t||"Event "+e+" fired",this.assertFalse(this.__hasEvent(e),t)},getEvent:function(e){for(var t=0;t<this.evtLogs.length;t++)if(this.evtLogs[t].name==e)return this.evtLogs[t];return null},__hasEvent:function(e){return null!==this.getEvent(e)},clearLogs:function(){for(;this.evtLogs.length>0;)this.evtLogs.pop()},registerExpectedEventsList:function(e){if("object"!=typeof e)throw"registerExpectedEventsList error";this._expectedEventsList=e,this._eventIndexInList=0,0===this._expectedEventsList.length&&(this._expectedEventsList=null)},checkExpectedEvent:function(e){if(this._expectedEventsList){var t=this._expectedEventsList[this._eventIndexInList],i=n(e,t);i&&this.$raiseEvent({name:"failure",testClass:this.$classpath,testState:this._currentTestName,description:"Event does not respect what was expected (expected: "+t.name+", occured: "+e.name+", unmatching property: "+i.join(".")+")"}),this._eventIndexInList++,this._eventIndexInList>=this._expectedEventsList.length&&(this._expectedEventsList=null)}else this.$raiseEvent({name:"failure",testClass:this.$classpath,testState:this._currentTestName,description:"Unexpected event: "+e.name})},checkExpectedEventListEnd:function(){null!=this._expectedEventsList&&(this.$raiseEvent({name:"failure",testClass:this.$classpath,testState:this._currentTestName,description:"Not all expected events have occured. First missing event (#"+this._eventIndexInList+"): "+this._expectedEventsList[this._eventIndexInList].name}),this._expectedEventsList=null)},checkExpectedErrorListEnd:function(){if(this._expectedErrorList)for(;this._expectedErrorList.length;)this.assertErrorInLogs(this._expectedErrorList.shift())},overrideClass:function(t,i){null==this._overriddenClasses&&(this._overriddenClasses={});var r=e.getLogicalPath(t,".js",!0),s=this._overriddenClasses[t];if(null==s){var a=e.nspace(t);if(null==a)return;var n=t.lastIndexOf(".");s=n>-1?{clsNs:t.slice(0,n),clsName:t.slice(n+1),initialClass:a}:{clsNs:"",clsName:t,initialClass:a},s.cachedModule=require.cache[r],this._overriddenClasses[t]=s}var o=e.nspace(s.clsNs);o[s.clsName]=i,delete require.cache[r];var l,c=require("noder-js/currentContext");c?l=c.getModule(r):(l={id:r,filename:r},require.cache[r]=l),l.exports=i,l.loaded=!0,l.preloaded=!0},resetClassOverrides:function(){if(null!=this._overriddenClasses){for(var t in this._overriddenClasses){var i=this._overriddenClasses[t],r=e.nspace(i.clsNs);r[i.clsName]=i.initialClass;var s=i.clsNs+"."+i.clsName,a=e.getLogicalPath(s,".js",!0);require.cache[a]=i.cachedModule}this._overriddenClasses=null}},checkEvent:function(e){try{this.assertTrue("object"==typeof e&&"string"==typeof e.name&&"object"==typeof e.src&&"object"==typeof e.src.$events,"The object passed to checkEvent is not an event.");var t=e.src.$events[e.name];this.assertTrue(null!=t,'The event "'+e.name+'" is not defined in '+e.src.$classpath);for(var i in e)"src"!=i&&"name"!=i&&this.assertTrue(null!=t.properties[i],'Undocumented event property "'+i+'" in '+e.name+" from "+e.src.$classpath)}catch(r){}}}})}();
//*******************
//LOGICAL-PATH:aria/jsunit/ConnectionSession.js
//*******************
var e=require("../Aria");module.exports=e.classDefinition({$classpath:"aria.jsunit.ConnectionSession",$constructor:function(e){this.requestUrl="",this.ioRequest=null,this.ioResponse=null,e.ioRequest&&this.setIORequest(e.ioRequest)},$destructor:function(){this.ioRequest=null,this.ioResponse=null},$prototype:{setIORequest:function(e){this.ioRequest=e,this.requestUrl=e.url},setIOResponse:function(){this.ioResponse=this.ioRequest.res,this.requestUrl=this.ioRequest.url},getRequestUrl:function(){return this.requestUrl}}});
//*******************
//LOGICAL-PATH:aria/jsunit/IOViewer.js
//*******************
var e=require("../Aria"),t=require("../core/IO");module.exports=e.classDefinition({$classpath:"aria.jsunit.IOViewer",$singleton:!0,$constructor:function(){this._outputDiv=null,this._requests=[]},$destructor:function(){this._outputDiv=null,this._requests=null,t.$unregisterListeners(this)},$prototype:{outputDivId:"_IOViewerOutput_",run:function(){var i=e.$window.document,r=i.getElementById(this.outputDivId);null==r&&(r=i.createElement("div"),i.body.appendChild(r)),this._outputDiv=r,t.$on({request:this._onRequest,response:this._onResponse,scope:this}),this._refreshDisplay()},_onRequest:function(e){this._requests[e.req.id]=e.req,this._refreshDisplay()},_onResponse:function(){this._refreshDisplay()},_refreshDisplay:function(){for(var e=['<div style="font-family:Arial;font-size:12px">','<span style="font-size:15px;font-weight:bold">IO Report</span>',"<hr/>",'<div style="padding: 3px;font-size: 12px; font-weight: bold;font-family:Arial">',"Requests: ",t.nbRequests," (pending: ",t.nbRequests-t.nbOKResponses-t.nbKOResponses,", OK: ",t.nbOKResponses,", failed: ",t.nbKOResponses,")<br />Traffic: ",t.trafficDown+t.trafficUp," bytes (down: ",t.trafficDown," bytes, up: ",t.trafficUp," bytes)","</div>",'<table style="font-size:12px;font-family:Arial; width:100%;">','<tr style="font-weight: bold;">','<td style="width: 50px;">Method</td>',"<td>URL</td>",'<td style="text-align: right; width: 50px;">Up</td>','<td style="text-align: right; width: 50px;">Down</td>','<td style="text-align: right; width: 50px;">Status</td>','<td style="width: 250px;">Result</td>','<td style="width: 80px;">Duration</td>',"</tr>"],i=this._requests.length-1;i>=0;i--){var r=this._requests[i];if(r){var s;if(r.res)s=['<tr style="',"200"==r.res.status?"color: green;":"color: red;",'">',"<td>",r.method,"</td>",'<td style="font-weight: bold;">',r.url,"</td>",'<td style="text-align: right;">',r.requestSize,"</td>",'<td style="text-align: right;">',r.responseSize,"</td>",'<td style="text-align: right;">',r.res.status,"</td>","<td>",r.res.error?r.res.error:"OK","</td>","<td>",r.downloadTime," ms</td>"];else var s=["<tr>","<td>",r.method,"</td>",'<td style="font-weight: bold;">',r.url,"</td>",'<td style="text-align: right;">',r.requestSize,"</td>","<td></td>","<td></td>","<td>Pending...</td>","<td></td>"];e.push(s.join(""))}}e.push("</table>"),this._outputDiv.innerHTML=e.join("")}}});
//*******************
//LOGICAL-PATH:aria/jsunit/IRobot.js
//*******************
var e=require("../Aria");module.exports=e.interfaceDefinition({$classpath:"aria.jsunit.IRobot",$interface:{KEYS:{$type:"Object"},isUsable:function(){},initRobot:{$type:"Function",$callbackParam:0},absoluteMouseMove:{$type:"Function",$callbackParam:1},mouseMove:{$type:"Function",$callbackParam:1},smoothMouseMove:{$type:"Function",$callbackParam:3},mousePress:{$type:"Function",$callbackParam:1},mouseRelease:{$type:"Function",$callbackParam:1},mouseWheel:{$type:"Function",$callbackParam:1},keyPress:{$type:"Function",$callbackParam:1},keyRelease:{$type:"Function",$callbackParam:1}}});
//*******************
//LOGICAL-PATH:aria/jsunit/JsCoverageObject.js
//*******************
var e=require("../Aria");module.exports=e.classDefinition({$classpath:"aria.jsunit.JsCoverageObject",$singleton:!1,$statics:{sort:function(e,t){var i=e.filename.toLowerCase(),r=t.filename.toLowerCase();return i>r?1:i==r?0:-1}},$constructor:function(e){this.filename=e.filename||"",this.source=e.source||"",this.classname=e.classname||"",this.linesCount=e.linesCount||0,this.coveredLinesCount=e.coveredLinesCount||0,this._data=e.data,this._data&&this.init(this._data)},$prototype:{init:function(e){this.source=e.source;var t=0,i=0;for(var r in e)"source"!=r&&(t++,e[r]>0&&i++);this.linesCount=t,this.coveredLinesCount=i},toString:function(){return(this.classname||this.filename)+" : "+this.getCoverage()+"%"},getCoverage:function(){return Math.floor(this.coveredLinesCount/this.linesCount*100)}}});
//*******************
//LOGICAL-PATH:aria/jsunit/JsCoverageReport.js
//*******************
var e=require("../Aria");module.exports=e.classDefinition({$classpath:"aria.jsunit.JsCoverageReport",$singleton:!1,$constructor:function(e){this.jsCoverage=e.jsCoverage||{},this._reportContainer=null},$prototype:{getReport:function(e){var t=parseInt(this.jsCoverage.getCoverage(),10),i=this.jsCoverage.getLinesCount(),r=this.jsCoverage.getFilesCount(),s=this.jsCoverage.jsCoverageStore.getBaseReportsURL(),a="<a href='"+s+"jscoverage.html' target='_blank'>Global Coverage</a>",n=["<h2>JsCoverage report</h2><br>","<table style='border-collapse: collapse;font-size: small;'>","<tbody>"];return e?n.push("<tr><td width='350px'><strong>"+a+"</strong> (on "+r+" files and "+i+" lines)</td>","<td><strong>",t,"%<strong></td>",'<td width="100px"><table><tbody><tr>','<td bgcolor="lime" width="'+t+'px"/>','<td bgcolor="red" width="'+(100-t)+'px"/>',"</tr></tbody></table></td></tr><br>"):n.push("<tr>","<td><strong>"+a+"</strong> (on "+r+" files and "+i+" lines)</td>","<td><strong>",t,"%</td>",'<td style="float: right;margin-right: 5px;">','<div style="background-color: #E00000;border: 1px solid #000000;float: right;height: 10px;margin-top: 4px;overflow: hidden;width: 100px;">','<div style="background-color: #00F000;height: 10px;width: '+t+'px;"></div>',"</div>","</td>","</tr>"),n.push("</tbody>","</table>"),n.join("")},_createJsCoverageReport:function(){var t=e.$window.document,i=t.createElement("div");i.id="jsCoverageTableContainer",i.style.cssText=["background-color: white","border: 3px solid Grey","top: 100px","bottom: 100px","left: 295px","overflow-y: auto","padding: 0 10px 10px","position: absolute","width: 600px","z-index: 1"].join(";"),t.body.appendChild(i),this._reportContainer=i,this.refreshReport()},showReport:function(){this._reportContainer||this._createJsCoverageReport(),this._reportContainer.style.display="block"},refreshReport:function(){this._reportContainer||this._createJsCoverageReport();var e=this.getReport();this._reportContainer.innerHTML=e},hideReport:function(){this._reportContainer||this._createJsCoverageReport(),this._reportContainer.style.display="none"}}});
//*******************
//LOGICAL-PATH:aria/jsunit/JsCoverageStore.js
//*******************
var e=require("../Aria"),t=require("../utils/Date"),i=require("../core/Browser");module.exports=e.classDefinition({$classpath:"aria.jsunit.JsCoverageStore",$statics:{baseReportsURL:"http://aria/jscoverage-reports/",baseStoreURL:"http://aria/jscoverage-store/"},$constructor:function(){this.reportDate=t.format(new Date,"yyyy'_'MM'_'dd'_'hh'_'mm'_'ss"),this._urlSuffix=i.name.toLowerCase()+"/"+this.reportDate+"/"},$prototype:{store:function(e){this.storeReport(),e.callback&&e.callback.fn.call(e.callback.scope)},storeReport:function(){var e=this.getBaseStoreURL(),t=this.getJSONReport();this.sendJSONReport(t,e)},getBaseStoreURL:function(){return this.baseStoreURL+this._getURLSuffix()},getBaseReportsURL:function(){return this.baseReportsURL+this._getURLSuffix()},_getURLSuffix:function(){return this._urlSuffix},sendJSONReport:function(t,i){var r=function(){return e.$global.XMLHttpRequest?new e.$global.XMLHttpRequest:e.$global.ActiveXObject?new e.$global.ActiveXObject("Microsoft.XMLHTTP"):void 0},s=r();if(s.open("POST",i,!1),s.setRequestHeader("Content-Type","application/json"),s.setRequestHeader("Content-Length",t.length.toString()),s.send(t),200===s.status||201===s.status||204===s.status)return s.responseText;throw s.status},getJSONReport:function(){var t=function(e){return"0000".substr(e.length)+e},i=function(e){return'"'+e.replace(/[\u0000-\u001f"\\\u007f-\uffff]/g,function(e){switch(e){case"\b":return"\\b";case"\f":return"\\f";case"\n":return"\\n";case"\r":return"\\r";case"	":return"\\t";case'"':return'\\"';case"\\":return"\\\\";default:return"\\u"+t(e.charCodeAt(0).toString(16))}})+'"'},r=[],s=e.$global._$jscoverage;if(s)for(var a in s)if(s.hasOwnProperty(a)){for(var n=s[a],o=[],l=n.length,c=0;l>c;c++){var h=n[c];(void 0===h||null===h)&&(h="null"),o.push(h)}var u=n.source,p=[];l=u.length;for(var c=0;l>c;c++)p.push(i(u[c]));r.push(i(a)+(':{"coverage":['+o.join(",")+'],"source":['+p.join(",")+"]}"))}return r="{"+r.join(",")+"}"}}});
//*******************
//LOGICAL-PATH:aria/jsunit/JsCoverage.js
//*******************
var e=require("../Aria"),t=require("../utils/Function"),i=require("./JsCoverageObject"),r=require("./JsCoverageReport"),s=require("./JsCoverageStore"),a=require("../utils/Type"),n=require("../utils/QueryString");module.exports=e.classDefinition({$classpath:"aria.jsunit.JsCoverage",$singleton:!0,$constructor:function(){this.jsCoverageObjects=[],this.filters=[],this._reporter=new r({jsCoverage:this}),this.jsCoverageStore=new s},$destructor:function(){this._reporter.$dispose(),this.jsCoverageStore.$dispose();for(var e=0,t=this.jsCoverageObjects;t>e;e+=1)this.jsCoverageObjects[e].$dispose()},$prototype:{extractData:function(){var t=0,r=0,s=e.$global._$jscoverage;if(s){for(var a in s)if(s.hasOwnProperty(a)){var n=new i({data:s[a],filename:a}),o=this.isCoverageObjectValid(n);o&&(t+=n.linesCount,r+=n.coveredLinesCount,this.jsCoverageObjects.push(n))}return this.linesCount=t,this.coveredLinesCount=r,this.jsCoverageObjects}},addFiltersFromString:function(e){for(var i=function(e,t){var i=t.filename.toLowerCase(),r=0!==n.indexOf("-");return-1!=i.indexOf(e)?r:!r},r=e.split(","),s=0,a=r.length;a>s;s++){var n=r[s],o=t.bind(i,this,n);this.addFilter(o)}},addFiltersFromQueryString:function(){var e=n,t=e.getKeyValue("filter");a.isString(t)&&this.addFiltersFromString(t)},addFilter:function(e){this.filters.push(e)},reset:function(){this.filters=[],this.jsCoverageObjects=[]},isCoverageObjectValid:function(e){for(var t=!0,i=this.filters,r=0,s=i.length;s>r;r++){var a=i[r];a(e)||(t=!1)}return t},refresh:function(e){this.filters=[],this.jsCoverageObjects=[],this.addFiltersFromString(e),this.extractData(),this._reporter.refreshReport()},getReport:function(){return this._reporter.getReport.apply(this._reporter,arguments)},getReportForEmail:function(){return this._reporter.getReport(!0)},getFilesCount:function(){return this.jsCoverageObjects.length},getLinesCount:function(){return this.linesCount},getCoverage:function(){return Math.floor(this.coveredLinesCount/this.linesCount*100)},store:function(e){this.jsCoverageStore.store(e)}}});
//*******************
//LOGICAL-PATH:aria/jsunit/LayoutTester.js
//*******************
var e=require("../Aria");module.exports=e.classDefinition({$classpath:"aria.jsunit.LayoutTester",$singleton:!0,$statics:{excludeRegExp:/"^(script|noscript|style|option)$"/gi},$constructor:function(){this.elements=[]},$prototype:{captureJsonScreenshot:function(t){return this.elements=[],t||(t=e.$window.document.body),this._captureJsonScreenshot(t),this.elements},_captureJsonScreenshot:function(e){for(var t=this.excludeRegExp,i=e.childNodes,r=0,s=i.length;s>r;r++){var a=i[r];a.tagName&&!t.test(a.tagName)&&(this._isHumanVisible(a)&&this._saveElement(a,e),this._captureJsonScreenshot(a))}},compare:function(e,t){if(t=t||0,!e)return["Array to compare is null"];var i=[],r=this.elements;if(e.length!=r.length){i.push("The items number is not the same");for(var s=0,a=r.length;a>s;s++)if(!e[s]||!this.itemCompare(r[s],e[s],t)){i.push("Different from item "+s);break}return i}for(var s=0,a=r.length;a>s;s++)e[s]&&this.itemCompare(r[s],e[s],t)||i.push("Item "+s+" is different");return i},itemCompare:function(e,t,i){i=i||0;for(var r in e)if("element"!=r&&e[r]!==t[r]&&(isNaN(e[r])||Math.abs(e[r]-t[r])>i))return!1;return!0},_saveElement:function(t,i){var r=this._getCoordinates(t),s=this._getCoordinates(i||e.$window.document.body),a=this._getDirectTextContent(t);this.elements.push({element:t,id:t.id,tagName:t.tagName,top:r.top-s.top,left:r.left-s.left,width:r.width,height:r.height,text:a})},_isHumanVisible:function(e){if("img"==e.tagName.toLowerCase())return!0;if("none"==e.style.display||"hidden"==e.style.visibility)return!1;var t=this._getCoordinates(e);return 0===t.width&&0===t.height?!1:this._hasDirectChildText(e)?!0:this._hasStyleThatMakesItVisible(e)},_hasDirectChildText:function(e){return""!==this._getDirectTextContent(e)},_hasStyleThatMakesItVisible:function(e){var t=e.currentStyle||e.ownerDocument.defaultView.getComputedStyle(e,null);return""!==t.border||""!==t.borderWidth||""!==t.borderTopWidth||""!==t.borderLeftWidth||""!==t.borderBottomWidth||""!==t.borderRightWidth||""!==t.background&&"none"!==t.background||""!==t.backgroundImage&&"none"!==t.backgroundImage||""!==t.backgroundColor&&"transparent"!==t.backgroundColor},_getCoordinates:function(e){var t=e.getBoundingClientRect(),i={};return i.top=Math.round(t.top),i.left=Math.round(t.left),i.width=Math.round(t.width||e.offsetWidth),i.height=Math.round(t.height||e.offsetHeight),i},_getDirectTextContent:function(e){if("input"==e.tagName.toLowerCase()&&"text"==e.getAttribute("type"))return e.value;for(var t=e.childNodes,i="",r=0,s=t.length;s>r;r++){var a=t[r];if(3==a.nodeType){var n=a.textContent||a.innerText||a.nodeValue;n&&(n=n.replace(/(\r\n|[\r\n])/g,"").replace(new RegExp(String.fromCharCode(160),"g")," ").replace(/^\s+|\s+$/g,""),""!==n&&(i+=n))}}return i}}});
//*******************
//LOGICAL-PATH:aria/jsunit/TestMsgHandler.js
//*******************
var e=require("../Aria"),t=require("./ConnectionSession"),i=require("../core/IOFilter");!function(){var r=0;module.exports=e.classDefinition({$classpath:"aria.jsunit.TestMsgHandler",$extends:i,$constructor:function(e){this.$IOFilter.constructor.call(this),this._metaData=this.CONNECTION_SESSION_METADATA+r,r++,this.cxLogs=[],e.cxLogs=this.cxLogs},$destructor:function(){this.cxLogs=null,this.$IOFilter.$destructor.call(this)},$statics:{CONNECTION_SESSION_METADATA:"aria.jsunit.TestMsgHandler:connectionSession"},$prototype:{onRequest:function(e){var i=e.sender;if(i&&"aria.modules.RequestMgr"==i.classpath){this.$assert(38,null==i[this._metaData]);var r=new t({ioRequest:e});i[this._metaData]=r,this.cxLogs.push(r)}},onResponse:function(e){var t=e.sender;if(t){var i=t[this._metaData];i&&i.setIOResponse()}}}})}();
//*******************
//LOGICAL-PATH:aria/jsunit/TestCase.js
//*******************
var e=require("../Aria"),t=require("../core/Sequencer"),i=require("../utils/Json"),r=require("../utils/Type"),s=require("../utils/Object"),a=require("../utils/Array"),n=require("../core/Browser"),o=require("./Assert"),l=require("../core/Timer"),c=require("../core/AppEnvironment");module.exports=e.classDefinition({$classpath:"aria.jsunit.TestCase",$extends:o,$statics:{defaultTestTimeout:n.isIE7?3e4:2e4,IFRAME_BASE_CSS_TEXT:"position:fixed;top:20px;left:20px;z-index:10000;width:1000px;height:700px;border:1px solid blue;background:aliceblue;opacity:0.8;-ms-filter: 'progid:DXImageTransform.Microsoft.Alpha(Opacity=80)';filter: alpha(opacity=80);",ERROR_NOTIFY_END:"Synchronous test is calling notifyTestEnd",EXCEPTION_IN_METHOD:"Exception raised while calling '%1' in an asynchronous test",ASYNC_IN_SYNC_TEST:"Doing asynchronous actions inside a synchronous test, please check '%1'"},$constructor:function(){this.$Assert.constructor.call(this),this._sequencer=null,this._currentTaskId=-1,this.skipTest=!1,this._testsCount=0,this._testPassed=0,this._waitForStatus={count:0,msg:null,ongoing:!1},this.__appEnv={};var t=e.nspace(this.$classpath).classDefinition.$prototype,i=s.keys(t),n=r.isFunction;i=a.filter(i,function(e){return n(t[e])&&!a.contains(["setUp","tearDown"],e)}),this.__wrapTestMethods(i),this.__wrapAriaLoad(),this.__pendingAriaLoad=0,this.__pendingActions=[]},$destructor:function(){this.__restoreAriaLoad(),this._sequencer&&this._sequencer.$dispose(),this.$Assert.$destructor.call(this),this._currentTaskId=null,this.__pendingActions=null},$prototype:{run:function(){this._saveAppEnvironment(),this._startTest(),this._sequencer=new t;var e=r.isFunction;if(!this.skipTest)for(var i in this)if(0===i.indexOf("test")&&e(this[i])){var s=0===i.indexOf("testAsync");this._sequencer.addTask({name:i,fn:this._execTestTask,scope:this,asynchronous:s}),this._testsCount++}this._sequencer.$on({end:this._onSequencerEnd,scope:this}),this._sequencer.start()},__wrapTestMethods:function(e){for(var t={},i=0,r=e.length;r>i;i+=1){var s=e[i];0!==s.indexOf("test")&&(t[s]=this[s],this[s]=function(e){return function(){var i=this._currentTestName;if(!i||0!==i.indexOf("testAsyn"))return t[e].apply(this,arguments);try{return t[e].apply(this,arguments)}catch(r){this.__failInTestMethod(r,e)}}}(s))}},__failInTestMethod:function(e,t){var i=this._currentTestName;0===i.indexOf("testAsyn")&&(this.$logError(this.EXCEPTION_IN_METHOD,t,e),this.notifyTestEnd(i.substring(0,i.length-2)))},__wrapAriaLoad:function(){var t=e.load,i=this;e.load=function(r){i.__pendingAriaLoad+=1;var s=r.oncomplete,a=r.onerror;r.oncomplete={fn:i.__AriaLoadCallback,scope:i,args:s},r.onerror={fn:i.__AriaLoadCallback,scope:i,args:a,override:a&&a.override},t.call(e,r)},e.load.originalLoad=t},__AriaLoadCallback:function(t){if(this.__pendingAriaLoad-=1,t){"function"==typeof t&&(t={fn:t});var i=t.scope?t.scope:e;t.fn.call(i,t.args)}if(this.__pendingAriaLoad<1&&this.__pendingActions.length>0)for(;this.__pendingActions.length>0;){var r=this.__pendingActions.shift();r.fn.apply(this,r.args)}},__restoreAriaLoad:function(){var t=e.load.originalLoad;t&&(e.load=t)},waitFor:function(e){var t=e.delay||250,i=e.timeout||1e4,r=(new Date).getTime()+i,s=e.condition,a=this._waitForStatus;a.count++,a.msg=e.msg,a.ongoing=!0;var n=function(){this.$callback(s)?(a.msg=null,a.ongoing=!1,this.$callback(e.callback)):(new Date).getTime()>r?this.setTestTimeout(0,this._currentTestName):l.addCallback({fn:n,scope:this,delay:t})};l.addCallback({fn:n,scope:this,delay:t})},_execTestTask:function(e){var t,i=e.name;this._updateAssertInfo(i+"()");var r=!1;try{this._currentTaskId=e.id,this.setUp&&this.setUp(),e.asynchronous?this.setTestTimeout(this.defaultTestTimeout,i):t=this._disableTestEnd();try{this[i].call(this)}catch(s){s.name!=this.ASSERT_FAILURE&&this.raiseError(s),r=!0}}catch(a){this.raiseError(a,"Error location: setUp() method"),r=!0}(!e.asynchronous||r)&&(!e.asynchronous&&this.__pendingAriaLoad>0&&(e.asynchronous=!0,this.$logError(this.ASYNC_IN_SYNC_TEST,this._currentTestName)),this._enableTestEnd(t),this.notifyTestEnd(i,r,e.asynchronous))},_disableTestEnd:function(){var e=this.notifyTestEnd;return this.notifyTestEnd=this._failOnNotify,e},_enableTestEnd:function(e){e&&(this.notifyTestEnd=e)},_failOnNotify:function(){this.$logError(this.ERROR_NOTIFY_END)},setTestTimeout:function(e,t){if(!this.demoMode){this._timeoutTimer&&l.cancelCallback(this._timeoutTimer);var i=new Error("Assert "+t+" has timed out");this._timeoutTimer=l.addCallback({fn:function(e){var i=this._waitForStatus;if(i.ongoing){var r="Assert "+t+", waitFor #"+i.count+" has timed out";if(i.msg){var s=i.msg;r+=": "+("function"==typeof s?s.call(this):s)}e=new Error(r)}this.handleAsyncTestError(e)},scope:this,delay:e,args:i})}},notifyTestEnd:function(t,i,r){if(this.__pendingAriaLoad>0)return this.__pendingActions.push({fn:this.notifyTestEnd,args:[t,i,r]}),this.$logInfo("notifyTestEnd called when Aria.load is still pending, waiting");this._timeoutTimer&&(l.cancelCallback(this._timeoutTimer),this._timeoutTimer=null),this.checkExpectedEventListEnd(),this.checkExpectedErrorListEnd(),this.assertLogsEmpty(!1,!1),this.clearLogs();try{this.tearDown&&this.tearDown()}catch(s){this.raiseError(s,"Error location: tearDown() method")}this._restoreAppEnvironment();var a=e.__undisposedObjects;for(var n in a)a.hasOwnProperty(n)&&null==a[n]["aria:createdFromTest"]&&(a[n]["aria:createdFromTest"]=this.$classpath+"."+this._currentTestName);l.callbacksRemaining(),r!==!1&&this._sequencer&&this._sequencer.notifyTaskEnd(this._currentTaskId)},callAsyncMethod:function(e,t,i,s){var a={cb:s,testName:this._currentTestName};null==e[t]&&this.raiseError(new Error("Object "+e+"has no method called '"+t+"'")),r.isFunction(e[t])||this.raiseError(new Error("Method '"+t+"' in "+e+" is not a Function"));try{i.push({fn:"_callAsyncMethodCb",scope:this,args:a}),e[t].apply(e,i)}catch(n){this.handleAsyncTestError(n,!1),this.notifyTestEnd(this._currentTestName)}},_callAsyncMethodCb:function(e,t){try{this.$callback(t.cb,e)}catch(i){this.handleAsyncTestError(i,!1)}this.notifyTestEnd(t.testName)},_onSequencerEnd:function(){this._sequencer&&(this._sequencer.$dispose(),this._sequencer=null),this._testPassed++,this._endTest(),this._currentTaskId=-1},handleAsyncTestError:function(e,t){e.name!=this.ASSERT_FAILURE&&this.raiseError(e),t!==!1&&this.notifyTestEnd(this._currentTestName)},_saveAppEnvironment:function(){this.__appEnv=i.copy(c.applicationSettings)},_restoreAppEnvironment:function(){c.setEnvironment(i.copy(this.__appEnv))}}});
//*******************
//LOGICAL-PATH:aria/jsunit/ModuleCtrlTestCase.js
//*******************
var e=require("../Aria");require("./TestMsgHandler");var t=require("../templates/ModuleCtrlFactory"),i=require("./TestCase"),r=require("../utils/Type"),s=require("../core/IOFiltersMgr");module.exports=e.classDefinition({$classpath:"aria.jsunit.ModuleCtrlTestCase",$extends:i,$constructor:function(){this.$TestCase.constructor.call(this),this.cxLogs=[],s.addFilter({classpath:"aria.jsunit.TestMsgHandler",initArgs:this})},$destructor:function(){s.removeFilter({classpath:"aria.jsunit.TestMsgHandler",initArgs:this}),this.cxLogs=null,this.evtLogs=null,this.$moduleCtrl&&(this.unregisterObject(this.$moduleCtrl),this.$moduleCtrl=null),this.$moduleCtrlPrivate&&(this.$moduleCtrlPrivate.$dispose(),this.$moduleCtrlPrivate=null),this.$TestCase.$destructor.call(this)},$statics:{FACTORY_ERROR:"Unable to create a module controller instance of %1"},$prototype:{run:function(){if(this.$controller){var e=r.isString(this.$controller)?{classpath:this.$controller}:this.$controller;t.createModuleCtrl(e,{fn:this._goOnWithRun,scope:this,args:e},!1)}else this.$TestCase.run.call(this)},_goOnWithRun:function(e,t){e.error?this.$logError(this.FACTORY_ERROR,[t.classpath]):(this.$moduleCtrl=e.moduleCtrl,this.$moduleCtrlPrivate=e.moduleCtrlPrivate,this.registerObject(this.$moduleCtrl)),this.$TestCase.run.call(this)},clearLogs:function(){for(;this.cxLogs.length>0;)this.cxLogs.pop().$dispose();this.$TestCase.clearLogs.apply(this)},registerController:function(e){this.registerObject(e)},assertEvent:function(e,t){t=t||"Event "+e+" not fired",this.assertEventFired(e,t)},assertLogsClean:function(e){e=e||"assertLogsClean failed",this.assertFalse(this.__hasErrorInLogs(),e)},assertLogsNotClean:function(e){e=e||"assertLogsNotClean failed",this.assertTrue(this.__hasErrorInLogs(),e)},__hasErrorInLogs:function(){for(var e=0;e<this.evtLogs.length;e++)if("error"==this.evtLogs[e].name)return!0;for(var t=0;t<this.cxLogs.length;t++)if(null!=this.cxLogs[t].ioResponse.error)return!0;return!1}}});
//*******************
//LOGICAL-PATH:aria/jsunit/TemplateTestCase.js
//*******************
var e=require("../Aria"),t=require("../utils/SynEvents");require("../templates/RefreshManager");var i=require("../utils/Dom"),r=require("./TestCase"),s=require("../core/Log"),a=require("../core/Timer");module.exports=e.classDefinition({$classpath:"aria.jsunit.TemplateTestCase",$extends:r,$events:{beforeLoadTplInIframe:""},$constructor:function(){this.$TestCase.constructor.call(this),this.env={template:this.$classpath+"Tpl",moduleCtrl:null,data:{},iframe:!1,baseCss:this.IFRAME_BASE_CSS_TEXT,iframePageCss:""},this.templateCtxt=null,this.testDivId="testArea_"+this.$class,this.testWindow=null,this.testDocument=null,this.testDiv=null,this.testIframe=null,this._started=!1,this.synEvent=t},$destructor:function(){this.__cleanEnv(!0),this.__removeTestDiv(),this.testIframe&&(this.testIframe.parentNode.removeChild(this.testIframe),this.testIframe=null),this.templateCtxt=null,this.testDocument=null,this.testWindow=null,this.$TestCase.$destructor.call(this)},$statics:{IFRAME_LOAD_TEMPLATE:"Error loading template '%1' in iframe",IFRAME_LOADER:"Unable to load Aria Templates in iframe because: %1"},$prototype:{needVisibleDocument:!0,setTestEnv:function(e){e.moduleCtrl&&(this.env.data=null);for(var t in e)e.hasOwnProperty(t)&&(this.env[t]=e[t])},testAsyncStartTemplateTest:function(){this.env.iframe?this.loadTemplateInIframe(this.env,{fn:this._iframeSetUpComplete,scope:this},{fn:this._iframeSetUpFailed,scope:this}):this._loadTestTemplate({fn:this._startTests,scope:this})},_loadTestTemplate:function(t){if(this.testWindow=e.$window,this.testDocument=e.$window.document,!this.testDiv){var i=this.testDocument.createElement("div");i.id=this.testDivId,i.style.cssText=this._getCssTextForTestFrame(this.env),this.testDocument.body.appendChild(i),this.testDiv=i}this.testWindow.scroll(0,0),e.loadTemplate({classpath:this.env.template,div:this.testDiv,data:this.env.data,moduleCtrl:this.env.moduleCtrl,provideContext:!0},{fn:this._templateLoadCB,scope:this,args:{cb:t}})},_templateLoadCB:function(e,t){this.templateCtxt=e.tplCtxt;var i=t.cb;return e.success?void(this.templateCtxt.isReady()?this.$callback(i):this.templateCtxt.$onOnce({Ready:{fn:function(e,t){this._started||t&&(t.delay=50,a.addCallback({fn:function(e){this.$callback(e)},scope:this,args:t}))},scope:this,args:i}})):void this.$callback(i)},_iframeSetUpComplete:function(e){this.testDiv=e.div,this.testIframe=e.iframe,this.testWindow=e.iframe.contentWindow,this.testDocument=e.document,this.synEvent=this.testWindow.aria.utils.SynEvents,this._templateLoadCB({success:!0,tplCtxt:e.templateCtxt},{cb:{fn:this._startTests,scope:this}})},_iframeSetUpFailed:function(e){this.testDiv=e.div,e.iframe&&(this.testIframe=e.iframe,this.testWindow=e.iframe.contentWindow),this._startTests()},_startTests:function(){this._started=!0,this.runTemplateTest()},_disposeTestTemplate:function(){this.testWindow.Aria.disposeTemplate(this.testDiv),this.templateCtxt=null,this._started=!1},_replaceTestTemplate:function(e,t){a.addCallback({fn:function(){this._disposeTestTemplate(),this.__cleanEnv(),this.setTestEnv(e),this._loadTestTemplate(t)},scope:this})},_refreshTestTemplate:function(){this.templateCtxt.$refresh()},runTemplateTest:function(){},nextTest:function(){var e=this._testsToExecute.shift();e?a.addCallback({fn:function(){this._currentTestName=e,this[e]()},scope:this,delay:10}):this.notifyTemplateTestEnd()},notifyTemplateTestEnd:function(){this.demoMode||a.addCallback({fn:function(){this._disposeTestTemplate();try{this.__removeTestDiv(),this.testIframe&&(this.testIframe.style.display="none"),this.notifyTestEnd("testAsyncStartTemplateTest")}catch(e){this.handleAsyncTestError(e)}},scope:this,delay:50})},getElementById:function(e,t,i,r){var s=r||this.testWindow.aria.utils.Dom,a=i||this.templateCtxt,n=a.$getId(e),o=s.getElementById(n);if(t&&!o){var l=[];this._retrieveDirectSubTemplates(a,l);for(var c=0,h=l.length;h>c;c++)if(o=this.getElementById(e,!0,l[c],s))return o}return o},getElementsByClassName:function(e,t){return i.getElementsByClassName(e,t)},_retrieveDirectSubTemplates:function(e,t){t=t||[];for(var i=e.$TemplateCtxt?e._mainSection:e,r=i._content,s=0,a=r.length;a>s;s++)r[s].behavior&&r[s].behavior.subTplCtxt?t.push(r[s].behavior.subTplCtxt):r[s]._content&&this._retrieveDirectSubTemplates(r[s],t);return t},getInputField:function(e){var t=this.getWidgetInstance(e);return t.getTextInputField?t.getTextInputField():t.getDom()?t.getDom().getElementsByTagName("input")[0]:null},getWidgetDomElement:function(e,t){var i=this.getWidgetInstance(e),r=i.getDom().getElementsByTagName(t)[0];return r},getExpandButton:function(e){var t=this.getWidgetInstance(e);return t.getDom(),t._frame.getIcon?t._frame.getIcon("dropdown"):null},getMultiSelectIcon:function(e){return this.getExpandButton(e)},getWidgetDropDownPopup:function(e){var t=this.getWidgetInstance(e);return t._dropdownPopup?t._dropdownPopup.domElement:void 0},getSortIndicator:function(e){var t=this.getWidgetInstance(e);return t.getDom(),t?t._domElt:null},getWidgetInstance:function(e){var t=this.testWindow.aria.templates.RefreshManager;return this.getWidgetInstanceInRefreshMgr(t,e)},getWidgetInstanceInRefreshMgr:function(e,t){e.updateHierarchies();for(var i=e.getHierarchies(),r=0;r<i.length;r++){var s=this._findInHierarchy(i[r],t);if(s)return s}},getWidgetInstanceInIframe:function(e,t){return this.getWidgetInstanceInRefreshMgr(e.contentWindow.aria.templates.RefreshManager,t)},getLink:function(e){return this.getWidgetDomElement(e,"a")},waitForWidgetFocus:function(e,t){this.waitForDomEltFocus(this.getInputField(e),t)},waitForDomEltFocus:function(e,t){this.waitFor({condition:function(){return e===this.testDocument.activeElement},callback:t})},waitForWidgetBlur:function(e,t){this.waitForDomEltBlur(this.getInputField(e),t)},waitForDomEltBlur:function(e,t){this.waitFor({condition:function(){return e!==this.testDocument.activeElement},callback:t})},_findInHierarchy:function(e,t,i){var r=!1;if("template"==e.type?(i=e.elem,r=!0):"templateWidget"==e.type&&(i=e.elem.behavior?e.elem.behavior.subTplCtxt:e.elem.subTplCtxt,r=!0),r){var s=i.getBehaviorById(t);if(s)return s}if(e.content)for(var a=0;a<e.content.length;a++){var n=e.content[a],s=this._findInHierarchy(n,t,i);if(null!=s)return s}return null},assertTrue:function(e,t){try{this.$TestCase.assertTrue.apply(this,[e,t])}catch(i){this.handleAsyncTestError(i,!1)}},end:function(){this.notifyTemplateTestEnd()},clickAndType:function(e,t,i,r){var s=this.getInputField(e);this.synEvent.click(s,{fn:function(){this.waitForDomEltFocus(s,function(){this.__afterClick(s,t,i,r)})},scope:this})},__afterClick:function(e,t,i,r){this.synEvent.type(e,t,{fn:this.__afterType,scope:this,args:[i,r],apply:!0,resIndex:-1})},__afterType:function(e,t){t===!1?this.$callback(e):this.synEvent.click(this.testDocument.body,e)},__cleanEnv:function(e){if(this.testWindow){var t=this.testWindow.Aria.getClassRef(this.env.template),i=this.testWindow.aria.core.ClassMgr;t&&t.classDefinition.$hasScript&&i.unloadClass(this.env.template+"Script"),i.unloadClass(this.env.template),e&&this.env.moduleCtrl&&this.env.moduleCtrl.classpath&&i.unloadClass(this.env.moduleCtrl.classpath)}},computeZIndex:function(e){for(var t=this.testDocument.body;e&&e!=t;){var i=e.style?e.style:null,r=i&&i.zIndex?i.zIndex:null;if(r){var s=parseInt(r,10);return s}e=e.parentNode}return null},loadTemplateInIframe:function(t,i,r){var s={def:t,cb:i,err:r||{fn:this.end,scope:this}};e.load({classes:["aria.utils.FrameATLoader"],template:[t.template],oncomplete:{fn:this._iframeDepLoad,args:s,scope:this},onerror:s.err})},_iframeDepLoad:function(t){var i=e.$window.document,r=i.createElement("div");r.style.cssText="background-color:#F7F6F1;position:absolute;";var s=i.createElement("iframe");s.id="testIframe_"+this.$class,s.style.cssText=this._getCssTextForTestFrame(t.def),r.appendChild(s),i.body.appendChild(r),t.iframe=s;var a={fn:this._iframeInnerDepLoad,scope:this,args:t},n={iframePageCss:this.env.iframePageCss};aria.utils.FrameATLoader.loadAriaTemplatesInFrame(s,a,n)},_iframeInnerDepLoad:function(e,t){if(!e.success)return this._iframeLoadError(t,e.reason);for(var i=t.iframe.contentWindow,r=s.getAppenders(),a=0,n=r.length;n>a;a+=1)i.aria.core.Log.addAppender(r[a]);i.Aria.load({classes:["aria.jsunit.TemplateTestCase"],oncomplete:{fn:this._iframeLoad,scope:this,args:t},onerror:{fn:function(e){this._iframeLoadError(e,"onerror callback of Aria.load(aria.jsunit.TemplateTestCase)")},scope:this,args:t}})},_iframeLoad:function(e){var t=e.iframe.contentWindow,i=e.iframe.contentDocument||t.document,r=i.createElement("div");i.body.appendChild(r),e.div=r;var s=e.def;this.$raiseEvent({name:"beforeLoadTplInIframe",window:t,document:i}),t.Aria.loadTemplate({classpath:s.template,div:r,data:s.data,moduleCtrl:s.moduleCtrl,provideContext:!0,width:s.width,height:s.height,rootDim:s.rootDim},{fn:this._iframeDone,scope:this,args:e})},_iframeLoadError:function(e,t){return t===aria.utils.FrameATLoader.BOOTSTRAP?t="unable to load the bootstrap in the iframe":t===aria.utils.FrameATLoader.WAIT&&(t="the iframe didn't load the framework quick enough"),this.$logError(this.IFRAME_LOADER,t),this.$callback(e.err,e)},_iframeDone:function(e,t){return e.success?void this.$callback(t.cb,{iframe:t.iframe,div:t.div,document:t.iframe.contentDocument||t.iframe.contentWindow.document,templateCtxt:e.tplCtxt}):(this.$logError(this.IFRAME_LOAD_TEMPLATE,t.def.template),this.$callback(t.err,t))},_getCssTextForTestFrame:function(e){return e.baseCss+(e.css?";"+e.css:"")},__failInTestMethod:function(e,t){this.$logError(this.EXCEPTION_IN_METHOD,t,e),this.notifyTemplateTestEnd()},__removeTestDiv:function(){this.testDiv&&(this.testDiv.parentNode.removeChild(this.testDiv),this.testDiv=null)}}});
//*******************
//LOGICAL-PATH:aria/jsunit/MultiSelectTemplateTestCase.js
//*******************
var e=require("../Aria"),t=require("./TemplateTestCase");module.exports=e.classDefinition({$classpath:"aria.jsunit.MultiSelectTemplateTestCase",$extends:t,$prototype:{_MSClick:function(e,t,i){i.synEvent.click(e,{fn:t,scope:i})},_MSType:function(e,t,i,r){r.synEvent.type(e,t,{fn:i,scope:r})},getCheckBox:function(e,t){var i=this.getWidgetInstance(e),r=i.controller.getListWidget();return r._tplWidget?r._tplWidget.subTplCtxt._mainSection._content[1]._content[0].section._content[t].behavior:null},toggleMultiSelectOption:function(e,t,i){var r=this.getCheckBox(e,t).getDom();r&&this.synEvent.click(r,{fn:i,scope:this})},isMultiSelectOpen:function(e){var t=this.getWidgetInstance(e).controller.getListWidget();return!!(t&&t._tplWidget&&t._tplWidget.subTplCtxt)},toggleMultiSelectOn:function(e,t){var i=this.getMultiSelectIcon(e);this.synEvent.click(i,{fn:this.__waitMSOpenByClick,scope:this,args:[e,t]})},toggleMultiSelectOff:function(e,t){var i=this.getMultiSelectIcon(e);this.synEvent.click(i,{fn:t,scope:this})},waitUntilMsOpened:function(e,t){this.__waitUntilMsState(e,t,!0)},waitUntilMsClosed:function(e,t){this.__waitUntilMsState(e,t,!1)},__waitUntilMsState:function(e,t,i){this.waitFor({condition:function(){var t=this.isMultiSelectOpen(e);return i?t:!t},callback:{fn:t,scope:this}})},__waitMSOpenByClick:function(e,t){var i=t[0],r=t[1];this.waitUntilMsOpened(i,r)}}});
//*******************
//LOGICAL-PATH:aria/jsunit/TestEngine.js
//*******************
var e=require("../Aria"),t=require("../utils/Type"),i=require("../utils/Array"),r=require("../utils/QueryString");module.exports=e.classDefinition({$classpath:"aria.jsunit.TestEngine",$events:{change:""},$constructor:function(){this.testReport=null,this._testStack=[],this._currentTest=null,this._isFinished=!1,this.runIsolated=!1},$destructor:function(){this.testReport=null},$prototype:{runTest:function(e,t){this.skipTests=t,this._registerAsListener(e),e.run()},_onFailure:function(e){null==this._currentTest.failures&&(this._currentTest.failures=[]),this._currentTest.failures.push({testState:e.testState,description:e.description});for(var t=this._testStack.length,i=0;t>i;i++)this._testStack[i].totalNbrOfFailures++;this._raiseChange("failure")},_onError:function(e){null==this._currentTest.errors&&(this._currentTest.errors=[]),this._currentTest.errors.push({testState:e.testState,description:e.msg,exception:e.exception});for(var t=this._testStack.length,i=0;t>i;i++)this._testStack[i].totalNbrOfErrors++;this._raiseChange("error")},_onTestLoad:function(t){var r=t.testObject,s=r.$classpath;null!=this.skipTests&&i.contains(this.skipTests,r.$classpath)&&(r.skipTest=!0);do{var a=e.nspace(s).classDefinition;if(!a)break;i.contains(this.skipTests,a.$extends)&&(r.skipTest=!0),s=a.$extends}while(s);this._registerAsListener(r)},_onTestStart:function(e){var t={testClass:e.testObject.$classpath,instance:e.testObject,totalNbrOfFailures:e.testObject._failedOnCreate?1:0,totalNbrOfErrors:0,totalNbrOfAsserts:0,state:"processing",processingState:"",subTests:null,failures:null,errors:null,retryURL:this._getRetryTestUrl(e.testObject.$classpath)},i=this._testStack.length;if(0===i)this._testStack.push(t),this.testReport=t;else{var r=this._testStack[i-1];null==r.subTests&&(r.subTests=[]),r.subTests.push(t),this._testStack.push(t)}this._currentTest=t,this._raiseChange("testStart")},_onTestEnd:function(e){e.testObject.$unregisterListeners(this),this._currentTest.processingState="",this._currentTest.state=e.testObject.skipTest?"skipped":"done",e.nbrOfAsserts&&(this._currentTest.totalNbrOfAsserts+=e.nbrOfAsserts),this._testStack.pop();var t=this._testStack.length;t>0?this._currentTest=this._testStack[t-1]:(this._currentTest=null,this._isFinished=!0),this._raiseChange("testEnd")},isFinished:function(){return this._isFinished===!0},_onStateChange:function(e){this._currentTest.processingState=e.testState,this._raiseChange("testProcessingState")},_registerAsListener:function(e){this.runIsolated&&t.isInstanceOf(e,"aria.jsunit.TestSuite")&&(e.runIsolated=!0),e.$on({failure:this._onFailure,error:this._onError,start:this._onTestStart,end:this._onTestEnd,stateChange:this._onStateChange,testLoad:this._onTestLoad,scope:this})},_raiseChange:function(e){this.$raiseEvent({name:"change",testReport:this.testReport,changeType:e})},_getRetryTestUrl:function(t){var i=r;i.getKeyValue("testClasspath");var s=i.keyValues;s.testClasspath=t;var a=[];for(var n in s)s.hasOwnProperty(n)&&"store"!=n&&a.push([n,s[n]].join("="));var o="?"+a.join("&"),l=e.$frameworkWindow,c=l.location.href.replace(/#$/,"");return c=c.replace(l.location.search,""),c+=o},getCurrentTest:function(){return this._currentTest},pause:function(e){var t,i=this._currentTest.instance;t=i.$TestSuite?i:this._testStack[this._testStack.length-2].instance,t&&t.$TestSuite?t.pause(e):(this.$logError("Pause couldn't find a test suite to pause"),this.$callback(e))},resume:function(e){var t=this._currentTest.instance;t.resume(e)}}});
//*******************
//LOGICAL-PATH:aria/jsunit/TestReport.js
//*******************
var e=require("../Aria");module.exports=e.classDefinition({$classpath:"aria.jsunit.TestReport",$singleton:!1,$constructor:function(e){this.testRunner=e.testRunner},$destructor:function(){this.testRunner=null},$prototype:{getReport:function(){for(var e=this.testRunner.getErrors(),t=(new Date).toLocaleString(),i=["Aria templates test campaign completed<br>",t,"<br>","<h2>Error report</h2>",this.getErrorSummary(),"<ul>"].join("<br>"),r=0,s=e.length;s>r;r++){var a=e[r],n=this.getErrorReport(a);i+=n}return i+="</ul><br>"},getErrorSummary:function(){var e=this.testRunner.getErrors(),t="";return t=0===e.length?'<b><font color="green">No test failed !</font></b>':1===e.length?"<b>1 test failed :</b>":"<b>"+e.length+" tests failed :</b>"},getErrorReport:function(e){for(var t=e.messages,i='<li><a href="'+e.retryURL+'">'+e.testClass+"</a></li><li> Error"+(t.length>1?"s":"")+" : <ul>",r=0,s=t.length;s>r;r++){var a=t[r];i+="<li>"+a+"</li>"}return i+="</ul></li><br>"},getMailHeader:function(){var e='<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"><title>Aria Templates Tests</title><style>*{font-family: Tahoma,Arial,sans-serif;font-size:10pt;}h1{font-size:14pt;} h2{font-size:22pt;margin-bottom:0px;font-weight:lighter} ul{line-height:1.5em;list-style-type:none;margin:0.3em 0 0 1.5em;padding:0;}</style></head><body>';return e},getMailFooter:function(){return'<br><img src="http://ariatemplates.com/images/logo-page.png"/><br><b>Aria team</b></body></html>'}}});
//*******************
//LOGICAL-PATH:aria/jsunit/TestWrapper.js
//*******************
var e=require("../Aria"),t=require("../utils/FrameATLoader"),i=require("./Assert"),r=require("../core/Timer");module.exports=e.classDefinition({$classpath:"aria.jsunit.TestWrapper",$extends:i,$constructor:function(e){this.$Assert.constructor.call(this),this.$classpath=e},$destructor:function(){this._removeFrame(),this.$Assert.$destructor.call(this)},$prototype:{run:function(){this._startTest();var i=e.$window.document;this._frame=i.createElement("iframe"),this._frame.style.cssText="z-index:100000;position:absolute;left:0px;top:0px;width:1024px;height:768px;border:1px solid black;visibility:hidden;display:block;background-color:white;",i.body.appendChild(this._frame),this._subWindow=this._frame.contentWindow,t.loadAriaTemplatesInFrame(this._frame,{fn:this._atLoadedInFrame,scope:this})},_atLoadedInFrame:function(t){if(!t.success)return this.raiseFailure("An error occurred while loading the framework in the iframe."),void this._end();var i=this._subWindow,r=i.Aria,s=i.document,a=s.createElement("div");a.setAttribute("id","TESTAREA"),s.body.appendChild(a);var n=e.getClassRef(this.$classpath);n.prototype.needVisibleDocument&&(this._frame.style.visibility="visible"),r.load({classes:[this.$classpath],oncomplete:{fn:this._loadTestComplete,scope:this},onerror:{fn:this._loadTestError,scope:this}})},_loadTestError:function(){this.raiseFailure("An error occurred while loading the test class."),this._end()},_loadTestComplete:function(){var e=this._subWindow.Aria;this._testInstance=e.getClassInstance(this.$classpath),this._testInstance.$on({"*":this._testEvent,scope:this}),this.demoMode&&(this._testInstance.demoMode=!0),this._testInstance.run()},handleAsyncTestError:function(){this.raiseFailure("Test was interrupted."),this._end()},_testEvent:function(e){"error"==e.name?this.raiseError(e.exception,e.msg):"failure"==e.name?this.raiseFailure(e.description):"stateChange"==e.name?this._updateAssertInfo(e.testState):"start"==e.name||"end"==e.name&&(this._totalAssertCount=e.nbrOfAsserts,this._testsCount=this._testInstance._testsCount,r.addCallback({fn:this._end,scope:this,delay:100}))},_removeFrame:function(){if(this._frame){if(this._subWindow.Aria&&this._subWindow.Aria.eval){var t=this._subWindow.Aria.eval("(function () { try { if (this._testInstance) {this._testInstance.$dispose();} return Aria.dispose(); } catch (e) { return { error: e }; }}).call(arguments[2])",null,this);if(this._testInstance=null,t)if(t.error)this.raiseError(t.error,"An exception occurred while disposing the test or the framework.");else if(0!==t.nbNotDisposed){var i=t.notDisposed,r=["There were ",t.nbNotDisposed," undisposed objects ("],s=!0;for(var a in i)i.hasOwnProperty(a)&&(s?s=!1:r.push(", "),r.push(i[a].$classpath));r.push(")"),this.raiseFailure(r.join(""))}}var n=e.$window.document.body;n.removeChild(this._frame),this._subWindow=null,this._frame=null}},_end:function(){this._removeFrame(),this._endTest()}}});
//*******************
//LOGICAL-PATH:aria/jsunit/NewTestRunner.js
//*******************
var e=require("../Aria"),t=require("./TestEngine"),i=require("./TestReport"),r=require("../core/Log"),s=require("./TestWrapper"),a=require("../core/JsObject"),n=require("../core/DownloadMgr");module.exports=e.classDefinition({$classpath:"aria.jsunit.NewTestRunner",$events:{preloadBegin:"",preloadEnd:"",campaignBegin:"",campaignEnd:"",campaignChange:""},$constructor:function(){this._testEngine=null,this._reporter=new i({testRunner:this}),this.__overrideGetURLWithTimestamp(),this._rootClasspath="",this.runIsolated=!1},$destructor:function(){this._testEngine&&this._testEngine.$dispose(),this._reporter&&this._reporter.$dispose(),this._outputDiv=null},$prototype:{getReporter:function(){return this._reporter},preload:function(){this.$raiseEvent("preloadBegin");var t=e.getClassRef(this._rootClasspath);t.prototype.$TestSuite?(this._rootTest=new t,this._rootTest.$on({preloadEnd:{fn:this._onPreloadEnd,scope:this}}),this._rootTest.preload()):(this._rootTest=this.runIsolated?new s(this._rootClasspath):new t,this.$raiseEvent("preloadEnd"))},_onPreloadEnd:function(){this.$raiseEvent("preloadEnd")},setRootClasspath:function(e){this._rootClasspath=e},run:function(e,t){this.__overrideLogError(),this.$raiseEvent("campaignBegin");var i=this.getEngine();i.runTest(this._rootTest,t)},__overrideLogError:function(){var t=a.prototype.$logError;a.prototype.$logError=function(i,s,a){var n=r.prepareLoggedMessage(i,s),o=a?". Error : "+a.message:"";return e.__runtimeErrors||(e.__runtimeErrors=[]),e.__runtimeErrors.push(n+o),t.apply(this,arguments)}},__overrideGetURLWithTimestamp:function(){var e=n.getURLWithTimestamp;n.getURLWithTimestamp=function(t){return e.apply(n,[t,!0])}},_onChange:function(e){var t=e.changeType;("testStart"==t||"testEnd"==t)&&(this.$raiseEvent("campaignChange"),this._testEngine.isFinished()&&this.$raiseEvent("campaignEnd"))},getRootTest:function(){return this._rootTest},_getTestCases:function(e){var t=[];if(!e.$TestSuite)return[{classpath:e.$classpath,instance:e}];if(e.isSkipped()||-1===e.isSelected())return[];for(var i=e.getSubTests(),r=0,s=i.length;s>r;r++){var a=i[r];if(-1!=a.classpath.indexOf("TestSuite")){var n=this._getTestCases(a.instance);t=t.concat(n)}else t.push(a)}return t},getTestCases:function(){return this._getTestCases(this._rootTest)},getTestsCount:function(){var e=this._rootTest;return this._getTestCases(e).length},getFinishedTests:function(){for(var e=this.getTestCases(),t=[],i=0,r=e.length;r>i;i++){var s=e[i];s.instance&&s.instance._isFinished&&t.push(s)}return t},getFinishedTestsCount:function(){return this.getFinishedTests().length},getFailedTests:function(){for(var e=this.getTestCases(),t=[],i=0,r=e.length;r>i;i++){var s=e[i];s.instance&&s.instance.hasError()&&t.push(s)}return t},getReport:function(){return this.getReporter().getReport()},getEngineReport:function(){var e=this._testEngine;return e.testReport},getEngine:function(){return null==this._testEngine&&(this._testEngine=new t,this._testEngine.runIsolated=this.runIsolated,this._testEngine.$on({change:this._onChange,scope:this})),this._testEngine}}});
//*******************
//LOGICAL-PATH:aria/jsunit/Robot.js
//*******************
var e=require("../Aria"),t=require("./$RobotSelection").getRobotClasspath();module.exports=e.classDefinition({$classpath:"aria.jsunit.Robot",$singleton:!0,$statics:{ROBOT_UNAVAILABLE:"There is no usable implementation of the robot.",BUTTON1_MASK:16,BUTTON2_MASK:8,BUTTON3_MASK:4},$constructor:function(){this.robot=null},$prototype:{getRobotClasspath:function(){return t},isUsable:function(){return!!this.getRobotClasspath()},initRobot:function(i){if(this.robot)this.robot.initRobot(i);else{if(!t)return void this.$logError(this.ROBOT_UNAVAILABLE);e.load({classes:[t],oncomplete:{fn:this._robotLoaded,scope:this,args:{cb:i}}})}},_robotLoaded:function(i){this.robot||(this.robot=e.getClassRef(t).$interface("aria.jsunit.IRobot")),this.robot.initRobot(i.cb)}}});
//*******************
//LOGICAL-PATH:aria/jsunit/RobotJava.js
//*******************
var e=require("../Aria");module.exports=e.classDefinition({$classpath:"aria.jsunit.RobotJava",$statics:{KEYS:{VK_0:48,VK_1:49,VK_2:50,VK_3:51,VK_4:52,VK_5:53,VK_6:54,VK_7:55,VK_8:56,VK_9:57,VK_A:65,VK_ACCEPT:30,VK_ADD:107,VK_AGAIN:65481,VK_ALL_CANDIDATES:256,VK_ALPHANUMERIC:240,VK_ALT:18,VK_ALT_GRAPH:65406,VK_AMPERSAND:150,VK_ASTERISK:151,VK_AT:512,VK_B:66,VK_BACK_QUOTE:192,VK_BACK_SLASH:92,VK_BACK_SPACE:8,VK_BACKSPACE:8,VK_BEGIN:65368,VK_BRACELEFT:161,VK_BRACERIGHT:162,VK_C:67,VK_CANCEL:3,VK_CAPS_LOCK:20,VK_CIRCUMFLEX:514,VK_CLEAR:12,VK_CLOSE_BRACKET:93,VK_CODE_INPUT:258,VK_COLON:513,VK_COMMA:44,VK_COMPOSE:65312,VK_CONTEXT_MENU:525,VK_CONTROL:17,VK_CONVERT:28,VK_COPY:65485,VK_CUT:65489,VK_D:68,VK_DEAD_ABOVEDOT:134,VK_DEAD_ABOVERING:136,VK_DEAD_ACUTE:129,VK_DEAD_BREVE:133,VK_DEAD_CARON:138,VK_DEAD_CEDILLA:139,VK_DEAD_CIRCUMFLEX:130,VK_DEAD_DIAERESIS:135,VK_DEAD_DOUBLEACUTE:137,VK_DEAD_GRAVE:128,VK_DEAD_IOTA:141,VK_DEAD_MACRON:132,VK_DEAD_OGONEK:140,VK_DEAD_SEMIVOICED_SOUND:143,VK_DEAD_TILDE:131,VK_DEAD_VOICED_SOUND:142,VK_DECIMAL:110,VK_DELETE:127,VK_DIVIDE:111,VK_DOLLAR:515,VK_DOWN:40,VK_E:69,VK_END:35,VK_ENTER:10,VK_EQUALS:61,VK_ESCAPE:27,VK_EURO_SIGN:516,VK_EXCLAMATION_MARK:517,VK_F:70,VK_F1:112,VK_F10:121,VK_F11:122,VK_F12:123,VK_F13:61440,VK_F14:61441,VK_F15:61442,VK_F16:61443,VK_F17:61444,VK_F18:61445,VK_F19:61446,VK_F2:113,VK_F20:61447,VK_F21:61448,VK_F22:61449,VK_F23:61450,VK_F24:61451,VK_F3:114,VK_F4:115,VK_F5:116,VK_F6:117,VK_F7:118,VK_F8:119,VK_F9:120,VK_FINAL:24,VK_FIND:65488,VK_FULL_WIDTH:243,VK_G:71,VK_GREATER:160,VK_H:72,VK_HALF_WIDTH:244,VK_HELP:156,VK_HIRAGANA:242,VK_HOME:36,VK_I:73,VK_INPUT_METHOD_ON_OFF:263,VK_INSERT:155,VK_INVERTED_EXCLAMATION_MARK:518,VK_J:74,VK_JAPANESE_HIRAGANA:260,VK_JAPANESE_KATAKANA:259,VK_JAPANESE_ROMAN:261,VK_K:75,VK_KANA:21,VK_KANA_LOCK:262,VK_KANJI:25,VK_KATAKANA:241,VK_KP_DOWN:225,VK_KP_LEFT:226,VK_KP_RIGHT:227,VK_KP_UP:224,VK_L:76,VK_LEFT:37,VK_LEFT_PARENTHESIS:519,VK_LESS:153,VK_M:77,VK_META:157,VK_MINUS:45,VK_MODECHANGE:31,VK_MULTIPLY:106,VK_N:78,VK_NONCONVERT:29,VK_NUM_LOCK:144,VK_NUMBER_SIGN:520,VK_NUMPAD0:96,VK_NUMPAD1:97,VK_NUMPAD2:98,VK_NUMPAD3:99,VK_NUMPAD4:100,VK_NUMPAD5:101,VK_NUMPAD6:102,VK_NUMPAD7:103,VK_NUMPAD8:104,VK_NUMPAD9:105,VK_O:79,VK_OPEN_BRACKET:91,VK_P:80,VK_PAGE_DOWN:34,VK_PAGE_UP:33,VK_PASTE:65487,VK_PAUSE:19,VK_PERIOD:46,VK_PLUS:521,VK_PREVIOUS_CANDIDATE:257,VK_PRINTSCREEN:154,VK_PROPS:65482,VK_Q:81,VK_QUOTE:222,VK_QUOTEDBL:152,VK_R:82,VK_RIGHT:39,VK_RIGHT_PARENTHESIS:522,VK_ROMAN_CHARACTERS:245,VK_S:83,VK_SCROLL_LOCK:145,VK_SEMICOLON:59,VK_SEPARATOR:108,VK_SHIFT:16,VK_SLASH:47,VK_SPACE:32,VK_STOP:65480,VK_SUBTRACT:109,VK_T:84,VK_TAB:9,VK_U:85,VK_UNDEFINED:0,VK_UNDERSCORE:523,VK_UNDO:65483,VK_UP:38,VK_V:86,VK_W:87,VK_WINDOWS:524,VK_X:88,VK_Y:89,VK_Z:90}}});
//*******************
//LOGICAL-PATH:aria/jsunit/RobotJavaSelenium.js
//*******************
var e=require("../Aria"),t=require("../utils/Dom"),i=require("../core/Timer"),r=require("../core/Browser");module.exports=e.classDefinition({$classpath:"aria.jsunit.RobotJavaSelenium",$extends:require("./RobotJava"),$implements:[require("./IRobot")],$singleton:!0,$constructor:function(){this.$RobotJava.constructor.call(this),this._robotInitialized=!1,this.offsetX=0,this.offsetY=0,e.$frameworkWindow.top.attester&&(this.offsetY=32),this._offset={x:0/0,y:0/0}},$events:{robotInitialized:""},$statics:{ROBOT_ERROR:"An error occurred in the robot: %1"},$prototype:{isUsable:function(){return!!e.$frameworkWindow.top.SeleniumJavaRobot},initRobot:function(t){this._robot||(this._robot=e.$frameworkWindow.top.SeleniumJavaRobot,this._robot.getOffset({fn:this._offsetReceived,scope:this})),t&&(this._robotInitialized?this.$callback(t):this.$onOnce({robotInitialized:t}))},_getScreenPos:function(){var t=e.$frameworkWindow;return{x:null!=t.screenX?t.screenX:t.screenLeft,y:null!=t.screenY?t.screenY:t.screenTop}},_offsetReceived:function(e){if(e.success){var t=e.result,i=this._getScreenPos();this._offset.x=t.x-i.x,this._offset.y=t.y-i.y}else this.$logError(this.ROBOT_ERROR,[e.result]);this._robotInitialized||(this._robotInitialized=!0,this.$raiseEvent("robotInitialized"))},_callCallback:function(e,t){e.success||this.$logError(this.ROBOT_ERROR,[e.result]),this.$callback(t)},viewportToAbsolute:function(e){var t=this._getScreenPos(),i=this._offset;return{x:t.x+i.x+this.offsetX+e.x,y:t.y+i.y+this.offsetY+e.y}},absoluteMouseMove:function(e,t){this._robot.mouseMove(e.x,e.y,{scope:this,fn:this._callCallback,args:t})},absoluteSmoothMouseMove:function(e,t,i,r){this._robot.smoothMouseMove(e.x,e.y,t.x,t.y,i,{scope:this,fn:this._callCallback,args:r})},mouseMove:function(e,i){var r=t._getViewportSize();(e.x<0||e.y<0||e.x>r.width||e.y>r.height)&&this.$logWarn("MouseMove position outside of the viewport."),this.absoluteMouseMove(this.viewportToAbsolute(e),i)},smoothMouseMove:function(e,i,r,s){var a=t._getViewportSize();(e.x<0||e.y<0||e.x>a.width||e.y>a.height||i.x<0||i.y<0||i.x>a.width||i.y>a.height)&&this.$logWarn("smoothMouseMove from or to position outside of the viewport."),this.absoluteSmoothMouseMove(this.viewportToAbsolute(e),this.viewportToAbsolute(i),r,s)},mousePress:function(e,t){this._robot.mousePress(e,{scope:this,fn:this._callCallback,args:t})},mouseRelease:function(e,t){this._robot.mouseRelease(e,{scope:this,fn:this._callCallback,args:t})},mouseWheel:function(e,t){this._robot.mouseWheel(e,{scope:this,fn:this._callCallback,args:t})},keyPress:function(e,t){i.addCallback({fn:this._keyPress,scope:this,args:{keyCode:e,cb:t},delay:r.isIE?100:1})},_keyPress:function(e){this._robot.keyPress(e.keyCode,{scope:this,fn:this._callCallback,args:e.cb})},keyRelease:function(e,t){this._robot.keyRelease(e,{scope:this,fn:this._callCallback,args:t})}}});
//*******************
//LOGICAL-PATH:aria/jsunit/RobotPhantomJS.js
//*******************
var e=require("../Aria"),t=require("./IRobot"),i=require("../core/Timer");module.exports=e.classDefinition({$classpath:"aria.jsunit.RobotPhantomJS",$implements:[t],$singleton:!0,$constructor:function(){this.offsetX=0,this.offsetY=32;var t;if(e.$frameworkWindow&&(this._robot=t=e.$frameworkWindow.top.phantomJSRobot),t){this._sendEvent=this._robot.sendEvent,this._keyShift=!1,this._lastMousePosition={x:0,y:0};var i=this.KEYS,r=t.keys;for(var s in r)if(r.hasOwnProperty(s)){var a="VK_"+s.toUpperCase();i[a]||(i[a]=r[s])}i.VK_CTRL=r.Control}},$statics:{MOUSEWHEEL_NOT_IMPLEMENTED:"mouseWheel is not implemented",BUTTONS:{16:"left",8:"middle",4:"right"},KEYS:{VK_SPACE:" ",VK_BACK_SPACE:"\b",VK_MULTIPLY:"*",VK_PLUS:"+",VK_MINUS:"-",VK_PERIOD:".",VK_SLASH:"/",VK_SEMICOLON:";",VK_COLON:":",VK_EQUALS:"=",VK_COMMA:",",VK_BACK_QUOTE:"`",VK_BACK_SLASH:"\\",VK_QUOTE:"'",VK_QUOTEDBL:'"',VK_LEFT_PARENTHESIS:"(",VK_RIGHT_PARENTHESIS:")"}},$prototype:{$init:function(e){for(var t=e.KEYS,i="Z".charCodeAt(0),r="A".charCodeAt(0);i>=r;r++){var s=String.fromCharCode(r);t["VK_"+s.toUpperCase()]=s.toLowerCase()}for(var a=0;10>a;a++)t["VK_"+a]=""+a},isUsable:function(){return!!this._robot},initRobot:function(e){this.isUsable()&&this.$callback(e)},_translateCoordinates:function(e){return{x:e.x+this.offsetX,y:e.y+this.offsetY}},mouseMove:function(e,t){var i=this._translateCoordinates(e);this.absoluteMouseMove(i,t)},absoluteMouseMove:function(e,t){var i=this._lastMousePosition;i.x=e.x,i.y=e.y,this._sendEvent("mousemove",e.x,e.y),this._callCallback(t)},smoothMouseMove:function(e,t,i,r){var s=this._translateCoordinates(e),a=this._translateCoordinates(t);this.smoothAbsoluteMouseMove(s,a,i,r)},smoothAbsoluteMouseMove:function(e,t,i,r){this.absoluteMouseMove(e,{fn:this._stepSmoothAbsoluteMouseMove,scope:this,resIndex:-1,args:{from:e,to:t,duration:i,cb:r,endTime:(new Date).getTime()+i}})},_stepSmoothAbsoluteMouseMove:function(e){var t=(e.endTime-(new Date).getTime())/e.duration,i=e.to;if(0>t)return void this.absoluteMouseMove(i,e.cb);var r=e.from;this.absoluteMouseMove({x:t*r.x+(1-t)*i.x,y:t*r.y+(1-t)*i.y},{fn:this._stepSmoothAbsoluteMouseMove,scope:this,resIndex:-1,args:e})},mousePress:function(e,t){var i=this._lastMousePosition;this._sendEvent("mousedown",i.x,i.y,this.BUTTONS[e]),this._callCallback(t)},mouseRelease:function(e,t){var i=this._lastMousePosition;this._sendEvent("mouseup",i.x,i.y,this.BUTTONS[e]),this._callCallback(t)},mouseWheel:function(){this.$logError(this.MOUSEWHEEL_NOT_IMPLEMENTED)},keyPress:function(e,t){e==this.KEYS.VK_SHIFT&&(this._keyShift=!0),e==this.KEYS.VK_CTRL&&(this._keyCtrl=!0),"string"==typeof e&&this._keyShift&&(e=e.toUpperCase()),e==this.KEYS.VK_ALT&&(this._keyAlt=!0),this._sendEvent("keydown",e,null,null,this._getModifier()),this._callCallback(t)},keyRelease:function(e,t){"string"==typeof e&&this._keyShift&&(e=e.toUpperCase()),e==this.KEYS.VK_SHIFT&&(this._keyShift=!1),e==this.KEYS.VK_CTRL&&(this._keyCtrl=!1),e==this.KEYS.VK_ALT&&(this._keyAlt=!1),this._sendEvent("keyup",e,null,null,this._getModifier()),this._callCallback(t)},_getModifier:function(){var e=0;return this._keyCtrl&&(e|=67108864),this._keyShift&&(e|=33554432),this._keyAlt&&(e|=134217728),e},_callCallback:function(e){i.addCallback({fn:this.$callback,scope:this,args:e,delay:200})}}});
//*******************
//LOGICAL-PATH:aria/jsunit/SynEvents.js
//*******************
var e=require("../Aria"),t=require("./Robot"),i=require("../utils/Type"),r=require("../core/Timer");module.exports=e.classDefinition({$classpath:"aria.jsunit.SynEvents",$singleton:!0,$constructor:function(){this._robot=t},$destructor:function(){this._robot=null},$prototype:{_keys:{CTRL:"CONTROL","	":"TAB"," ":"SPACE","\b":"BACK_SPACE","\r":"ENTER","*":"MULTIPLY","+":"PLUS","-":"MINUS",".":"PERIOD","/":"SLASH",";":"SEMICOLON",":":"COLON","=":"EQUALS",",":"COMMA","`":"BACK_QUOTE","\\":"BACK_SLASH","'":"QUOTE",'"':"QUOTEDBL","(":"LEFT_PARENTHESIS",")":"RIGHT_PARENTHESIS"},_methods:{initRobot:0,mouseMove:1,smoothMouseMove:3,absoluteMouseMove:1,mousePress:1,mouseRelease:1,mouseWheel:1,keyPress:1,keyRelease:1,ensureVisible:1,focus:1,waitFocus:1,pause:1,click:1,type:2,move:2,drag:2,execute:1},execute:function(e,t){this._executeCb(0,{array:e,curIdx:0,cb:t})},_executeCb:function(e,t){var r=t.array,s=t.curIdx;if(t.curIdx>=r.length)this.$callback(t.cb);else{var a=r[s];if(t.curIdx++,!i.isArray(a))return void this.$logError("Not an array");var n=a.shift(),o=this._methods[n];if(null==o)return void this.$logError("Bad action");if(o!=a.length)return void this.$logError("Bad number of parameters");a[o]={fn:this._executeCb,scope:this,args:t};var l=this[n]?this:this._robot[n]?this._robot:this._robot.robot;l[n].apply(l,a)}},ensureVisible:function(e,t){e=this._resolveHTMLElement(e),aria.utils.Dom.scrollIntoView(e),this.$callback(t)},focus:function(e,t){e=this._resolveHTMLElement(e),e.focus(),this.waitFocus(e,t)},waitFocus:function(t,i){var r=this,s=(new Date).getTime()+5e3,a=function(){var n=e.$window.document.activeElement;n===t?(t=null,r.$callback(i)):(new Date).getTime()>s?r.$logError("Timeout while waiting for an element to be focused: %1",[t?t.tagName:t],t):setTimeout(a,100)};setTimeout(a,100)},pause:function(e,t){r.addCallback({fn:this.$callback,scope:this,args:t,delay:e})},click:function(e,t){e=this._resolvePosition(e),null!=e&&this.execute([["mouseMove",e],["mousePress",this._robot.BUTTON1_MASK],["pause",100],["mouseRelease",this._robot.BUTTON1_MASK]],t)},type:function(e,t,i){var r=[];e&&(e=this._resolveHTMLElement(e),r.push(["focus",e]));for(var s=t.match(/(\[[^\]]+\])|([^\[])/g),a=0,n=s.length;n>a;a++){var o=s[a],l=!1,c=!0,h=!0;o.length>1?(o=o.substr(1,o.length-2).toUpperCase(),/^<.*>$/.test(o)?h=!1:/^>.*<$/.test(o)&&(c=!1),c&&h||(o=o.substr(1,o.length-2)),o=o.replace(/-/g,"_")):(l=o!=o.toLowerCase(),o=o.toUpperCase());var u=this._keys[o];null!=u&&(o=u),o=this._robot.robot.KEYS["VK_"+o],null!=o?(l&&r.push(["keyPress",this._robot.robot.KEYS.VK_SHIFT]),c&&r.push(["keyPress",o]),h&&r.push(["keyRelease",o]),l&&r.push(["keyRelease",this._robot.robot.KEYS.VK_SHIFT])):this.$logError("Unknown key: %1",[s[a]])}this.execute(r,i)},move:function(e,t,i){var r=e.duration||2e3,s=e.to;s=this._resolvePosition(s),t=t?this._resolvePosition(t):s,null!=t&&null!=s&&this._robot.robot.smoothMouseMove(t,s,r,i)},drag:function(e,t,i){var r=e.to;if(r=this._resolvePosition(r),t=t?this._resolvePosition(t):r,null!=t&&null!=r){var s=[["mouseMove",t],["mousePress",this._robot.BUTTON1_MASK],["move",e,t],["mouseRelease",this._robot.BUTTON1_MASK]];this.execute(s,i)}},_resolvePosition:function(e){var t,r=aria.utils.Dom;if(i.isString(e)&&(e=this._resolveHTMLElement(e)),i.isHTMLElement(e)){var s=r.getGeometry(e);t={x:s.x+s.width/2,y:s.y+s.height/2}}else{if(!e.hasOwnProperty("x")||!e.hasOwnProperty("y"))return this.$logError("Invalid position."),null;t=e}return t},_resolveGeometry:function(e){var t,r=aria.utils.Dom;if(i.isString(e)&&(e=this._resolveHTMLElement(e)),i.isHTMLElement(e))t=r.getGeometry(e);else{if(!(e.hasOwnProperty("x")&&e.hasOwnProperty("y")&&e.hasOwnProperty("width")&&e.hasOwnProperty("height")))return this.$logError("Invalid position."),null;t=e}return t},_resolveHTMLElement:function(e){var t;if(i.isString(e)){if(t=aria.utils.Dom.getElementById(e),null==t)return this.$logError("HTML element was not found."),null}else{if(!i.isHTMLElement(e))return this.$logError("Invalid HTML element."),null;t=e}return t}}});
//*******************
//LOGICAL-PATH:aria/jsunit/RobotTestCase.js
//*******************
var e=require("../Aria"),t=require("./SynEvents"),i=require("./Robot"),r=require("./TemplateTestCase");module.exports=e.classDefinition({$classpath:"aria.jsunit.RobotTestCase",$extends:r,$constructor:function(){this.$TemplateTestCase.constructor.call(this),aria.core.Browser.isIE&&(this.defaultTestTimeout=6e4),this.synEvent=t},$destructor:function(){this.synEvent=null,this.$TemplateTestCase.$destructor.call(this)},$prototype:{run:function(){var e=i;if(this.skipTest||e.isUsable())this.$TemplateTestCase.run.call(this);else{this._startTest();var t=aria.core.Browser.isFirefox&&aria.core.Browser.majorVersion<4;t||(this._currentTestName="RobotTestCase:run",this.raiseFailure("The robot is not usable")),this._endTest()}},_loadTestTemplate:function(e){var t=i;t.initRobot({fn:this.$TemplateTestCase._loadTestTemplate,scope:this,resIndex:-1,args:e})},_iframeLoad:function(e){var t=e.iframe.contentWindow;t.Aria.load({classes:["aria.jsunit.SynEvents","aria.jsunit.Robot"],oncomplete:{scope:this,fn:function(){var i=t.aria.jsunit.Robot;i.initRobot({fn:this.$TemplateTestCase._iframeLoad,scope:this,resIndex:-1,args:e})}}})},_templateLoadCB:function(){return this.synEvent=this.testWindow.aria.jsunit.SynEvents,this.$TemplateTestCase._templateLoadCB.apply(this,arguments)}}});
//*******************
//LOGICAL-PATH:aria/jsunit/SonarReport.js
//*******************
var e=require("../Aria"),t=require("../core/Browser");module.exports=e.classDefinition({$classpath:"aria.jsunit.SonarReport",$statics:{REPORT_SEPARATOR:"###__REPORT__DELIMITER__###",LINE_SEPARATOR:"####",TAB_SEPARATOR:"#TT#"},$constructor:function(e){this.testRunner=e.testRunner;var i=t.name+" "+t.version;i=i.replace(/ /g,"_").replace(/\./g,"");var r=t.osName;this.__browserInfo=i+"_"+r+"."},$destructor:function(){this.testRunner=null},$prototype:{getReport:function(){for(var e="",t=[],i=this.testRunner.getTestCases(),r=0,s=i.length;s>r;r++){var a=i[r].instance;t.push(this.__getTestCaseReport(a))}return e=t.join(this.REPORT_SEPARATOR)},__getTestCaseReport:function(e){var t=this.__formatTestCaseReport(e);return t},__getTestSuiteName:function(e){return this.__browserInfo+e.$classpath},__formatTestCaseReport:function(e){var t=["<?xml version='1.0' encoding='UTF-8' ?>"],i=this.__getTestCaseSubTests(e);t.push(["<testsuite","name='"+this.__getTestSuiteName(e)+"'","errors='"+e.getExecutionErrors().length+"'","failures='"+e.getFailures().length+"'","tests='"+i.length+"'","skipped='0'","time='"+e.getExecutionTime()/1e3+"'",">"].join(" "));for(var r=0,s=i.length;s>r;r++){var a=i[r],n=this.__formatSubTestReport(a,e);t.push(n)}t.push("</testsuite>");var o=t.join(this.LINE_SEPARATOR);return o},__getTestCaseSubTests:function(e){var t=[],i=e.getErrors();for(var r in e)if(r.match(/^test/)&&"function"==typeof e[r]){for(var s={name:r,status:"success",time:0,errors:[]},a=0,n=i.length;n>a;a++){var o=i[a];s.name+"()"==o.testMethod&&(s.status="error",s.errors.push(o))}t.push(s)}return t},__formatSubTestReport:function(e,t){var i="",r=e.errors;if(r.length>0){i=this.TAB_SEPARATOR+"<testcase classname='"+this.__getTestSuiteName(t)+"' time='"+e.time+"' name='"+e.name+"'>";for(var s=0,a=r.length;a>s;s++){var n=r[s];i+=this.LINE_SEPARATOR+this.TAB_SEPARATOR+this.TAB_SEPARATOR,i+="failure"==n.state?"<failure>"+n.description+"</failure>":"<error>"+n.description+"</error>"}i+=this.LINE_SEPARATOR+this.TAB_SEPARATOR+"</testcase>"}else i=this.TAB_SEPARATOR+"<testcase classname='"+t.$classpath+"' time='"+e.time+"' name='"+e.name+"'/>";return i}}});
//*******************
//LOGICAL-PATH:aria/jsunit/TestCommunicator.js
//*******************
var e=require("../Aria");module.exports=e.classDefinition({$classpath:"aria.jsunit.TestCommunicator",$constructor:function(e){this.id=e.id,this.content="",this.init(e)},$destructor:function(){},$prototype:{init:function(t){var i=e.$window.document,r=i.createElement("div");r.style.cssText=["display:block","visibility:visible","height:1px","width:1px","overflow:hidden"].join(";"),r.id=this.id,i.body.appendChild(r);var s=t.content;this.content=s,r.appendChild(i.createTextNode(s))}}});
//*******************
//LOGICAL-PATH:aria/jsunit/TestRunner.js
//*******************
var e=require("../Aria"),t=require("./TestEngine"),i=require("./TestReport"),r=require("./SonarReport"),s=require("../utils/Dom"),a=require("../utils/Type");module.exports=e.classDefinition({$classpath:"aria.jsunit.TestRunner",$singleton:!0,$constructor:function(){this._testEngine=null,this._reporter=new i({testRunner:this}),this._sonarReporter=new r({testRunner:this}),this._outputDiv=null},$destructor:function(){this._testEngine&&this._testEngine.$dispose(),this._reporter&&this._reporter.$dispose(),this._sonarReporter&&this._sonarReporter.$dispose(),this._outputDiv=null},$prototype:{outputDivId:"_TestRunnerOutput_",getReporter:function(){return this._reporter},getSonarReporter:function(){return this._sonarReporter},run:function(t,i){var r=s.getElementById(this.outputDivId);if(null==r){var a=e.$window.document;r=a.createElement("div"),a.body.appendChild(r)}this._outputDiv=r;var n=this.getEngine();this._refreshDisplay(),this._rootTest=t,n.runTest(t,i)},_onChange:function(e){var t=e.changeType;("testStart"==t||"testEnd"==t)&&this._refreshDisplay()},_refreshDisplay:function(){var e=this._testEngine.testReport,t=['<div style="font-family:Arial;font-size:12px">','<span style="font-size:15px;font-weight:bold">Unit Test Report</span>',"<hr/>"];null==e?t.push("Test pending start..."):this._processOutput(e,t),t.push("</div>");var i=this._outputDiv;i.innerHTML="",i.innerHTML=t.join("")},_processOutput:function(e,t){var i="#000000",r="",s=e.instance;if("done"==e.state&&0===e.totalNbrOfFailures&&0===e.totalNbrOfErrors)i="green",r=" - OK";else if(e.totalNbrOfFailures>0||e.totalNbrOfErrors>0){i="red";var a=[];if(e.totalNbrOfFailures>0){var n=e.totalNbrOfFailures>1?" failures":" failure";a.push(e.totalNbrOfFailures+n)}if(e.totalNbrOfErrors>0){var n=e.totalNbrOfErrors>1?" errors":" error";a.push(e.totalNbrOfErrors+n)}r=" - KO: "+a.join(",")}var o="",l="";if("done"==e.state){o=" in "+s.getExecutionTime()+" ms";var n=e.totalNbrOfAsserts>1?"asserts":"assert";l=" ("+e.totalNbrOfAsserts+" "+n+")"}"skipped"==e.state&&(i="green",r=" - NOT TESTED");var c=['<div style="color:',i,'">',"<b>",e.testClass,"</b> ",r," - ","<i>",e.state,o,l,"</i>",'<a href="',e.retryURL,'" target="_blank" style="color:blue"> retry</a>',"<br/>"];if("processing"===e.state&&c.splice(-1,0,'<a href=javascript:interrupt("',e.testClass,'");> skip</a>'),t.push(c.join("")),this._processFailuresOrErrors(e,"failures",t),this._processFailuresOrErrors(e,"errors",t),e.subTests&&e.subTests.length>0){t.push('<div style="margin-left:20px">');for(var h=e.subTests.length,u=0;h>u;u++)this._processOutput(e.subTests[u],t);t.push("</div>")}c=["</div>"],t.push(c.join(""))},getFailures:function(){for(var e=[],t=aria.jsunit.TestRunner.getErrors(),i=0;i<t.length;i++)e.push(t[i].testClass);return e.join(",")},getErrors:function(){var e=[],t=this.getEngineReport();return function(t){var i=t.subTests;if(a.isArray(i))for(var r=0,s=i.length;s>r;r++){var n=i[r];arguments.callee(n)}var o=[];if(a.isArray(t.failures)&&(o=o.concat(t.failures)),a.isArray(t.errors)&&(o=o.concat(t.errors)),o.length>0){for(var l=[],r=0,s=o.length;s>r;r++){var c=o[r];l.push(c.testState+" : "+c.description)}e.push({retryURL:t.retryURL,messages:l,testClass:t.testClass})}}(t),e=e.sort(function(e,t){var i=e.testClass.toLowerCase(),r=t.testClass.toLowerCase();return i>r?1:i==r?0:-1})},getReport:function(){return this.getReporter().getReport()},getEngineReport:function(){var e=this._testEngine;return e.testReport},_processFailuresOrErrors:function(e,t,i){var r="failures"==t;if(e[t]&&e[t].length>0){i.push('<div style="margin-left:20px;color:#000000">');for(var s=e[t].length,a=0;s>a;a++){var n=e[t][a];i.push(r?"Failure #"+(a+1):"Error #"+(a+1)),i.push(": "),i.push(n.description?n.description:r?"Failure":"Error"),i.push(" in <i>"+n.testState+"</i>"),i.push("<br/>")}i.push("</div>")}},_getTestCases:function(e){var t=[];if(!e.$TestSuite)return[{classpath:e.$classpath,instance:e}];if(e.isSkipped()||-1==e.isSelected())return[];for(var i=e.getSubTests(),r=0,s=i.length;s>r;r++){var a=i[r];if(-1!=a.classpath.indexOf("TestSuite")){var n=this._getTestCases(a.instance);t=t.concat(n)}else t.push(a)}return t},getTestCases:function(){return this._getTestCases(this._rootTest)},interrupt:function(e){var t=this._testEngine.getCurrentTest();if(e===t.testClass&&"processing"===t.state){var i=new Error("Test interrupted by the user");return t.instance.handleAsyncTestError(i,!0),!1}},getEngine:function(){return null==this._testEngine&&(this._testEngine=new t,this._testEngine.$on({change:this._onChange,scope:this})),this._testEngine}}});
//*******************
//LOGICAL-PATH:aria/jsunit/TestSuite.js
//*******************
var e=require("../Aria"),t=require("../core/Sequencer"),i=require("./TestCase"),r=require("./TestWrapper"),s=require("../utils/Type"),a=require("./Test"),n=require("../core/Log");module.exports=e.classDefinition({$classpath:"aria.jsunit.TestSuite",$extends:a,$constructor:function(){this.$Test.constructor.call(this),this._tests=[],this._subTests=[],this._sequencer=null,this._preloadSequencer=null,this._assertCount=0,this._isSelected=1,this.skipTest=!1,this.runIsolated=!1,this._isPaused=!1,this._pauseCallback=null,this._pausedTask-null},$destructor:function(){this._sequencer&&this._sequencer.$dispose(),this._preloadSequencer&&this._preloadSequencer.$dispose(),this._disposeRunningTest(),this.$Test.$destructor.call(this)},$prototype:{refreshSubTests:function(){for(var e=this._tests,t=[],i=0,r=e.length;r>i;i++){var s=e[i];t.push({classpath:s,instance:null,lastInSuite:i===r-1})}this._subTests=t},getSubTests:function(){return 0===this._subTests.length&&this.refreshSubTests(),this._subTests},getSubTestSuites:function(){for(var e=[],t=this.getSubTests(),i=0,r=t.length;r>i;i++){var s=t[i],a=s.classpath;-1!=a.indexOf("TestSuite")&&e.push(s)}return e},getAllSubTestCases:function(){for(var e=[],t=this.getSubTests(),i=0,r=t.length;r>i;i++){var s=t[i];if(-1!=s.classpath.indexOf("TestSuite")){var a=s.instance.getAllSubTestCases();e=e.concat(a)}else e.push(s)}return e},getAllSubTestSuites:function(){for(var e=[],t=this.getSubTests(),i=0,r=t.length;r>i;i++){var s=t[i];if(-1!=s.classpath.indexOf("TestSuite")){e.push(s);var a=s.instance.getAllSubTestSuites();e=e.concat(a)}}return e},preload:function(){var e=this.getSubTestSuites();if(0===e.length)return this.$raiseEvent("preloadEnd");this._preloadSequencer=new t;for(var i=0,r=e.length;r>i;i++){var s=e[i];this._preloadSequencer.addTask({name:"preload_"+i,fn:this.__preloadSubSuiteTask,scope:this,args:{suite:s},asynchronous:!0})}this._preloadSequencer.$on({end:this.__onPreloadSequenceEnd,scope:this}),this._preloadSequencer.start()},__onPreloadSequenceEnd:function(){this.$raiseEvent("preloadEnd")},__preloadSubSuiteTask:function(t,i){var r=i.suite,s=r.classpath;e.load({classes:[s],oncomplete:{fn:this.__onLoadSubSuiteCompleted,scope:this,args:{task:t,suite:r}},onerror:{fn:this.__onDownloadTaskError,scope:this,args:{sequencer:this._preloadSequencer,task:t,test:r}}})},__onLoadSubSuiteCompleted:function(t){var i=t.task,r=t.suite;r.instance=e.getClassInstance(r.classpath),r.instance.setParentTest(this),r.instance.$on({preloadEnd:{fn:function(){this._preloadSequencer.notifyTaskEnd(i.id)},scope:this}}),r.instance.preload()},addTests:function(){for(var e=arguments,t=0,i=e.length;i>t;t++){var r=e[t];s.isString(r)&&this._tests.push(r)}},getFinishedTestsCount:function(){var e=this._suitesInstances,t=this._testPassed;for(var i in e)if(e.hasOwnProperty(i)){var r=e[i];t+=r.getFinishedTestsCount()}return t},run:function(){this._startTest(),this._sequencer=new t,this._assertCount=0;var e=this.getSubTests();if(!this.isSkipped()&&-1!==this.isSelected())for(var i=0,r=e.length;r>i;i++){var s=e[i];this._sequencer.addTask({name:"Test_"+i,fn:this.__runTestTask,scope:this,args:{test:s},asynchronous:!0})}this._sequencer.$on({end:this._onSequencerEnd,scope:this}),this.$raiseEvent({name:"start",testObject:this,testClass:this.$classpath}),this._sequencer.start()},isSkipped:function(){return this.skipTest===!0},__runTestTask:function(t,i){var r=i.test,s=r.classpath;e.load({classes:[s],oncomplete:{fn:this._execTestTask,scope:this,args:{task:t,test:r}},onerror:{fn:this.__onDownloadTaskError,scope:this,args:{sequencer:this._sequencer,task:t,test:r}}})},__onDownloadTaskError:function(e){var t=e.test,i="Loading of "+t.classpath+" failed",r=this.__getLastRuntimeError();r&&(i=r),this.$raiseEvent({name:"failure",testState:this.$classpath,description:i}),t.instance=this.__createFailedTest("$fileLoad",i,t.classpath),this._execTestTask(e)},_execTestTask:function(e){var t=e.task,i=e.test;i.instance||(i.instance=this._createTest(i.classpath)),this.__runningTest=i.instance,this.$raiseEvent({name:"testLoad",testLoader:this,testObject:i.instance}),i.instance.$on({end:{fn:this._onTestEnd,scope:this,args:{taskId:t.id,taskMgr:t.taskMgr}},stateChange:{fn:this._raiseStateChange,scope:this}}),i.instance.run()},_onTestEnd:function(e,t){if(e.nbrOfAsserts&&(this._assertCount+=e.nbrOfAsserts),this._raiseStateChange(),e.src.$unregisterListeners(this),this._disposeRunningTest(),this._isPaused){if(this._pausedTask=t,this._pauseCallback){var i=this._pauseCallback;this._pauseCallback=null,this.$callback(i)}}else t.taskMgr.notifyTaskEnd(t.taskId)},_createTest:function(t){var i;try{var a=e.getClassRef(t);i=this.runIsolated&&!s.isInstanceOf(a.prototype,"aria.jsunit.TestSuite")?new r(t):new a,i.setParentTest(this)}catch(n){var o="Uncaught exception while creating "+t+"\nMessage : "+n.message,l=this.__getLastRuntimeError();l&&(o=l),i=this.__createFailedTest("$constructor",o,t)}return i},__getLastRuntimeError:function(){var t="";if(e.__runtimeErrors){var i=e.__runtimeErrors[e.__runtimeErrors.length-1];t=i}return t},__createFailedTest:function(e,t,r){var s=new i;return s._errors=[{type:"failure",testMethod:e,description:t}],s._failedOnCreate=!0,s.$classpath=r,s},_disposeRunningTest:function(){try{this.__runningTest&&(this.__runningTest.$dispose(),this.__runningTest.$TestCase&&this.__runningTest.assertLogsEmpty())}catch(e){var t=this.__runningTest.$classpath;this.__runningTest._errors.push({type:"failure",testMethod:"$destructor",description:"Uncaught exception while destroying "+t+"\nMessage : "+e.message}),this.$raiseEvent({name:"failure",testState:t,description:"Uncaught exception while destroying "+t+"\nMessage : "+e.message})}n.clearAppenders(),n.resetLoggingLevels(),this.__runningTest=null},_raiseStateChange:function(){this.$raiseEvent({name:"stateChange"})},isSelected:function(){return this._isSelected},setSelected:function(e){if(1!==this._isSelected){this._isSelected=1;var t=this.getParentTest();t&&e!==!1&&t.checkSelected();for(var i=this.getSubTestSuites(),r=0,s=i.length;s>r;r++){var a=i[r];a.instance.setSelected(!1)}}},setUnselected:function(e){if(-1!==this._isSelected){this._isSelected=-1;var t=this.getParentTest();t&&e!==!1&&t.checkSelected();for(var i=this.getSubTestSuites(),r=0,s=i.length;s>r;r++){var a=i[r];a.instance.setUnselected(!1)}}},checkSelected:function(){for(var e=!1,t=!1,i=this.getSubTestSuites(),r=0,s=i.length;s>r;r++){var a=i[r];1==a.instance.isSelected()?e=!0:-1==a.instance.isSelected()?t=!0:(e=!0,t=!0)}if(e&&!t)this.setSelected();else if(!e&&t&&this.getSubTests().length==i.length)this.setUnselected();else{this._isSelected=0;var n=this.getParentTest();n&&n.checkSelected()}},_onSequencerEnd:function(){this._sequencer&&(this._sequencer.$dispose(),this._sequencer=null),this._endTest(),this._isFinished=!0,this.$raiseEvent({name:"end",testObject:this,testClass:this.$classpath,nbrOfAsserts:this._assertCount})},pause:function(e){this._isPaused=!0,this._pauseCallback=e},resume:function(e){if(this._isPaused=!1,this.$callback(e),this._pausedTask){var t=this._pausedTask;this._pausedTask=null,t.taskMgr.notifyTaskEnd(t.taskId)}}}});
//*******************
//LOGICAL-PATH:aria/jsunit/TestacularReport.js
//*******************
var e=require("../Aria"),t=require("../utils/Json");module.exports=e.classDefinition({$classpath:"aria.jsunit.TestacularReport",$singleton:!0,$constructor:function(){var t,i=e.$frameworkWindow;i.parent!==i&&(t=i.parent.testacular),this._testacular=t,null==t&&(this.attachTest=e.empty),this._testEngine=null},$dispose:function(){this._testEngine&&this.detachTestEngine(this._testEngine),this._testacular=null},$statics:{SEVERAL_TEST_ENGINES:"Attaching several test engines to the TestacularReport is not supported."},$prototype:{isTestacularEnabled:function(){return null!=this._testacular},_onChange:function(e){var t=e.changeType,i=this._testEngine,r=i.getCurrentTest(),s=null;"failure"==e.changeType?s=r.failures:"error"==e.changeType&&(s=r.errors),s&&this._testacular.error({type:t,testClass:r.testClass,details:s[s.length-1]});var a=i.isFinished();if(a){var n=this.createFinalReport(e.testReport);this._testacular.updateResult(n);var o=0===n.totalNbrOfErrors&&0===n.totalNbrOfFailures;this._testacular.complete(o)}else{var l=this.createStatusReport(e.testReport,r);this._testacular.updateStatus(l)}},attachTestEngine:function(e){if(this._testacular){if(e===this._testEngine)return;this._testEngine&&(this.$logError(this.SEVERAL_TEST_ENGINES),this.detachTestEngine(this._testEngine)),this._testEngine=e,e.$on({change:this._onChange,scope:this})}},detachTestEngine:function(e){this._testEngine==e&&(e.$unregisterListeners(this),this._testEngine=null)},createStatusReport:function(e,t){return{totalNbrOfAsserts:e.totalNbrOfAsserts,totalNbrOfErrors:e.totalNbrOfErrors,totalNbrOfFailures:e.totalNbrOfFailures,currentTest:{testClass:t.testClass,state:t.state,processingState:t.processingState}}},createFinalReport:function(e){var i=t.copy(e,!1);i.executionTime=i.instance.getExecutionTime(),delete i.instance,delete i.state,delete i.processingState,i.errors||delete i.errors,i.failures||delete i.failures,delete i.retryURL;var r=i.subTests;if(r){for(var s=[],a=0,n=r.length;n>a;a++)s[a]=this.createFinalReport(r[a]);i.subTests=s}else delete i.subTests;return i}}});
//*******************
//LOGICAL-PATH:aria/jsunit/helpers/OutObj.js
//*******************
var e=require("../../Aria"),t=require("../../utils/Dom");module.exports=e.classDefinition({$classpath:"aria.jsunit.helpers.OutObj",$singleton:!0,$constructor:function(){this.testArea=null,this.store=""},$destructor:function(){this.clean()},$prototype:{createPlayground:function(t){var i=e.$window.document,r=i.createElement("div");r.id="playground_"+(t||"unknown_test"),i.body.appendChild(r),this.testArea=r},clean:function(){this.testArea&&(this.testArea.parentNode.removeChild(this.testArea),this.testArea=null),this.store=""},tplCtxt:{$getId:function(e){return["testOutput",e].join("_")},evalCallback:function(){return aria.jsunit.helpers.OutObj.$callback.apply(this,arguments)}},write:function(e){this.store+=e},putInDOM:function(){t.insertAdjacentHTML(this.testArea,"beforeEnd",this.store),this.store=""},clearAll:function(){this.testArea.innerHTML="",this.store=""},callMacro:e.empty,beginSection:e.empty,endSection:e.empty}});
//*******************
//LOGICAL-PATH:aria/jsunit/WidgetTestCase.js
//*******************
var e=require("../Aria"),t=require("./helpers/OutObj"),i=require("./TestCase");module.exports=e.classDefinition({$classpath:"aria.jsunit.WidgetTestCase",$extends:i,$destructor:function(){this.outObj.clean(),this.outObj=null,this.$TestCase.$destructor.call(this)},$prototype:{run:function(){this.outObj=t,this.outObj.createPlayground(this.$class),this.$TestCase.run.apply(this,arguments)},createAndInit:function(t,i){var r=e.getClassRef(t),s=new r(i,this.outObj.tplCtxt);return s.writeMarkup(this.outObj),this.outObj.putInDOM(),s.initWidget(),s},createContainerAndInit:function(t,i,r){var s=e.getClassRef(t),a=new s(i,this.outObj.tplCtxt);return a.writeMarkupBegin(this.outObj),this.outObj.write(r||""),a.writeMarkupEnd(this.outObj),this.outObj.putInDOM(),a.initWidget(),a},clearAll:function(){this.outObj.clearAll()}}});