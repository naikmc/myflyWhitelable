/*
 * Copyright 2009-2015 Amadeus s.a.s.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
//***MULTI-PART
//*******************
//LOGICAL-PATH:aria/$resources.js
//*******************
var e=require("./core/ResMgr"),t=function(e,t){t||(t=e,e="");var i=t.split("/");!e||"."!=i[0]&&".."!=i[0]||(i=e.split("/").concat(i));for(var r=0,a=i.length;a>r;r++)"."==i[r]?(i.splice(r,1),r--):r>0&&".."==i[r]&&".."!=i[r-1]&&(r--,i.splice(r,2),r--);return i.join("/")},i=function(i,r,a){return e.loadResource(i,t(r,a))},r=function(i,r,a){var n=t(r,a),s=e.getResource(n);if(!s){var o=e.loadResource(i,n);if(!o.isFulfilled())throw new Error("Resource "+i+","+r+","+a+" is not yet loaded.");s=o.result()}return s};r.$preload=i;var a=function(e,t){return r(null,e,t)};a.$preload=function(e,t){return i(null,e,t)},module.exports={module:r,file:a};
//*******************
//LOGICAL-PATH:aria/$resourcesProviders.js
//*******************
var e=require("./Aria"),t=require("noder-js/promise"),i=require("noder-js/asyncRequire").create(module),r={},a=function(e){var t=[e.provider,e.caller];return e.onLoad&&t.push(e.onLoad),e.handler&&t.push(e.handler),e.resources&&t.push(e.resources.join("-")),t.join("-")},n=function(e,t){r[a(e)]=t},s=function(e){return r[a(e)]},o=function(e,t){e.getData=function(){return e.__getData(t)}},l=function(e,t){t||(t=e,e="");var i=t.split("/");!e||"."!=i[0]&&".."!=i[0]||(i=e.split("/").concat(i));for(var r=0,a=i.length;a>r;r++)"."==i[r]?(i.splice(r,1),r--):r>0&&".."==i[r]&&".."!=i[r-1]&&(r--,i.splice(r,2),r--);return i.join("/")},u=function(e){var t=e.length,i={provider:l(e[0],e[1]),caller:e[2]};if(t>3&&(i.onLoad=e[3]),t>4&&(i.handler=e[4]),t>5){for(var r=[],a=5;t>a;a++)r.push(e[a]);i.resources=r}return i},c=function(){var t=u(arguments);return t.onLoad&&i(t.provider).spreadSync(function(e){return h(e,t)}).then(function(){var i=e.getClassRef(t.caller).prototype;i[t.onLoad].call(i)}).done(),{provider:s(t)}},h=function(e,i){return new t(function(t){var r=new e;n(i,r),o(r,i.caller),i.hasOwnProperty("handler")&&r.setHandler(i.handler),i.hasOwnProperty("resources")&&r.setResources(i.resources),r.fetchData(t,i.caller)})};c.$preload=function(){var e=u(arguments),t=i(e.provider);return e.onLoad?t:t.spreadSync(function(t){return h(t,e)})},module.exports={fetch:c};
//*******************
//LOGICAL-PATH:aria/core/loaders/TplBasePreprocessor.js
//*******************
var e=require("noder-js/promise.js");module.exports=function(t){return function(i,r){return new e(function(e,a){t.parseTemplate(i,!1,function(t){if(t.classDef)e(t.classDef);else{var i,n=aria.core.Log;if(n&&t.errors&&t.errors.length>0){var s=t.errors;i=[];for(var o=0,l=s.length;l>o;o++){var u=s[o];i[o]=n.prepareLoggedMessage(u.msgId,u.msgArgs)}i=":\n - "+i.join("\n - ")}else i=".";var c=new Error("Template '"+r+"' could not be compiled to javascript"+i);a(c)}},{file_classpath:r},!1,!0)})}};
//*******************
//LOGICAL-PATH:aria/templates/Parser.js
//*******************
var e=require("../Aria"),t=require("../utils/String");module.exports=e.classDefinition({$classpath:"aria.templates.Parser",$singleton:!1,$constructor:function(){this.template=null,this.__lineNumbers=null,this.__currentLn=0,this._keepWhiteSpace=!1},$statics:{MISSING_CLOSINGBRACES:"line %1: Template parsing error: could not find corresponding '}'.",EXPECTING_OTHER_CLOSING_STATEMENT:"line %4: Template parsing error: found closing statement '%2', but '%1' (line %3) should be closed first.",INVALID_STATEMENT_NAME:"line %2: Template parsing error: invalid statement name: '%1'",STATEMENT_CLOSED_NOT_OPEN:"line %2: Template parsing error: could not find corresponding open statement for closing statement '%1'.",MISSING_CLOSING_STATEMENT:"line %2: Template parsing error: statement '%1' was open but never closed."},$prototype:{parseTemplate:function(){},_prepare:function(e,t){e=e.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e=e.replace(/\/\/.*\{(\/)?CDATA\}.*$/gm,"");var i,r=e.split("{CDATA}"),n=[];n.push(r[0]);for(var a=1,s=r.length;s>a;a++){if(i=r[a].split("{/CDATA}"),2!=i.length)return this.logOrThrowError(this.MISSING_CLOSING_STATEMENT,["CDATA"],this.context,t),void(this.template=e);n=n.concat(i)}for(var o,l,u=0,s=n.length;s>u;u++){if(o=n[u],u%2===0){for(var c=/\/\*(.|\n|\r)*?\*\//m;l=o.match(c);){l+="";for(var h="",d=-1;-1!=(d=l.indexOf("\n",d+1));)h+="\n";o=o.replace(c,h)}o=o.replace(/^\/\/.*$/gm,""),o=o.replace(/([\s\;\}\>\{\,\(])\/\/(?=(?:(?:[^"]*"){2})*[^"]*$).*$/gm,"$1"),this._keepWhiteSpace||(o=o.replace(/^[ \t]+/gm,""),o=o.replace(/[ \t]+$/gm,""))}else o="{CDATA}"+o+"{/CDATA}";n[u]=o}e=n.join(""),this.template=e},_computeLineNumbers:function(){var e=this.template;this.__lineNumbers=[0];for(var t=e.indexOf("\n");-1!=t;)this.__lineNumbers.push(t),t=e.indexOf("\n",t+1)},positionToLineNumber:function(e){var t,i=this.__lineNumbers,r=i.length;for(t=this.__currentLn;r>t;t++)if(e<i[t]){if(t>0&&i[t-1]>e)break;return this.__currentLn=t,t}for(t=0;t<this.__currentLn;t++)if(e<i[t])return this.__currentLn=t,t;return this.__lineNumbers.length},__findClosingBraces:function(e,i){var r=i,n=0,a=-1,s=-1,o=t;do r>a&&(a=o.indexOfNotEscaped(e,"{",r)),r>s&&(s=o.indexOfNotEscaped(e,"}",r)),a>-1&&s>a?(n++,r=a+1):s>-1&&(n--,r=s+1);while(n>=0&&s>-1);return this.$assert(163,-1==s||0>n&&(a>s||-1==a)),{indexClose:s,indexOpen:a}},__unescapeParam:function(e,t,i){var r=e.substring(t,i);return r=r.replace(/^[\r\n]+/,""),r=r.replace(/[\r\n]+$/,""),r=r.replace(/\\([\/\{\}\$\\*])/g,"$1")},__unescapeText:function(e,t,i){var r=e.substring(t,i);return/^[\r\n]*$/.test(r)?"":r=r.replace(/\\([\/\{\}\$\\*])/g,"$1")},logOrThrowError:function(e,t,i,r){if(r){var n=new Error;throw n.errors=[{msgId:e,msgArgs:t,errorContext:i}],n}return this.$logError(e,t,i),null},__logError:function(e,t,i,r){return i||(i=[]),i.push(this.positionToLineNumber(e)),this.logOrThrowError(t,i,this.context,r)},_buildTree:function(e){var i=t;this.__currentLn=0;for(var r,n=this.template,a=0,s=0,o=i.indexOfNotEscaped(n,"{"),l=!1,u=[],c={name:"#ROOT#",paramBlock:"",parent:null,content:u,lineNumber:0},h=[c];-1!=o;){l="$"==n.charAt(o-1)&&!i.isEscaped(n,o-1),s=l?o-1:o,s-a>0&&(r={name:"#TEXT#",parent:h[h.length-1],firstCharParamIndex:a,lastCharParamIndex:s,paramBlock:this.__unescapeText(n,a,s),lineNumber:this.positionToLineNumber(a)},r.paramBlock.length>0&&u.push(r)),a=o+1;var d=this.__findClosingBraces(n,a);if(s=d.indexClose,o=d.indexOpen,-1==s)return this.__logError(a,this.MISSING_CLOSINGBRACES,null,e);if(l)u.push({name:"#EXPRESSION#",parent:h[h.length-1],firstCharParamIndex:a,lastCharParamIndex:s,paramBlock:this.__unescapeParam(n,a,s),lineNumber:this.positionToLineNumber(a)}),a=s+1;else if("/"==n.charAt(a)){a++,r=h.pop();var p=n.substring(a,s);if(0===h.length)return this.__logError(a,this.STATEMENT_CLOSED_NOT_OPEN,[p],e);if(r.name!=p){for(var f=h.length-1;f>=1;f--)if(h[f].name==p)return this.__logError(a,this.EXPECTING_OTHER_CLOSING_STATEMENT,[r.name,p,r.lineNumber],e);return this.__logError(a,this.STATEMENT_CLOSED_NOT_OPEN,[p],e)}r.lastCharContentIndex=a-2,u=h[h.length-1].content,a=s+1,p=null}else{var m,g,_=s+1,v="/"==n.charAt(s-1)&&!i.isEscaped(n,s-1);if(v&&s--,r={parent:h[h.length-1],lastCharParamIndex:s},u.push(r),g=i.nextWhiteSpace(n,a,s,/[\s\{]/),-1==g?(g=s,m=n.substring(a,s)):(m=n.substring(a,g),"{"!=n.charAt(g)&&g++),r.firstCharParamIndex=g,r.lineNumber=this.positionToLineNumber(g),"CDATA"!=m){if(r.name=m,v||(r.content=[],r.firstCharContentIndex=_,h.push(r),u=r.content),!/^[_\w@:]+$/.test(r.name))return this.__logError(a,this.INVALID_STATEMENT_NAME,[r.name],e);r.paramBlock=this.__unescapeParam(n,g,s),a=_}else{r.name="#CDATA#";var y=n.indexOf("{/CDATA}");if(-1==y)return this.__logError(a,this.MISSING_CLOSING_STATEMENT,["CDATA"],e);r.paramBlock=n.substring(s+1,y);var d=this.__findClosingBraces(n,y+1);a=d.indexClose+1,o=d.indexOpen}}}return s=n.length,s-a>0&&(r={name:"#TEXT#",parent:h[h.length-1],firstCharParamIndex:a,lastCharParamIndex:s,paramBlock:this.__unescapeText(n,a,s),lineNumber:this.positionToLineNumber(a)},r.paramBlock.length>0&&u.push(r)),h.length>1?this.__logError(h[h.length-1].firstCharContentIndex,this.MISSING_CLOSING_STATEMENT,[h[h.length-1].name],e):(this.template=this.__lineNumbers=null,c)}}});
//*******************
//LOGICAL-PATH:aria/templates/CSSParser.js
//*******************
var e=require("../Aria"),t=require("../utils/String"),i=require("./Parser");module.exports=e.classDefinition({$classpath:"aria.templates.CSSParser",$extends:i,$singleton:!0,$statics:{MISSING_OPENINGBRACES:"line %1: Template parsing error: could not find corresponding '{'."},$prototype:{parseTemplate:function(e,t,i,r){return this.context=t,this._prepare(e,r),this.__preprocess(i,r)?(this._computeLineNumbers(),this._buildTree(r)):null},__preprocess:function(e,i){for(var r=this.template,n=t,a=0,s=-1,o=-1,l=[],u=/^\{[\s\/]*?([\w]+)\b/,c=0,h=r.length,d=-1,p=0,f=-1;h>c;)if(a>s&&(s=n.indexOfNotEscaped(r,"{",a)),a>o&&(o=n.indexOfNotEscaped(r,"}",a)),s>-1&&(o>s||-1==o)){if(0===p&&(f=s),p++,-1==d)if("$"==r.charAt(s-1))d=p;else{var m=r.substring(s,o),g=u.exec(m);g&&e[g[1]]?d=p:(l.push(r.substring(c,s)),l.push("\\{"),c=s+1)}a=s+1}else if(o>-1){if(0===p)return this._computeLineNumbers(),this.logOrThrowError(this.MISSING_OPENINGBRACES,[this.positionToLineNumber(o)],this.context,i),!1;d==p?d=-1:-1==d&&(l.push(r.substring(c,o)),l.push("\\}"),c=o+1),p--,a=o+1}else this.$assert(94,-1==s&&-1==o),a=h,l.push(r.substring(c,h)),c=h;return p>0?(this._computeLineNumbers(),this.logOrThrowError(this.MISSING_CLOSINGBRACES,[this.positionToLineNumber(f)],this.context,i),!1):(this.template=l.join(""),!0)}}});
//*******************
//LOGICAL-PATH:aria/templates/ClassWriter.js
//*******************
var e=require("../Aria"),t=require("../utils/String");module.exports=e.classDefinition({$classpath:"aria.templates.ClassWriter",$constructor:function(e,t){this._processStatement=e,this._processErrors=t,this._curindent="",this.indentUnit=" ",this._varNameNumber=0,this.errorContext=null,this.allDependencies=null,this.templateParam=null,this.parentClassType="JS",this.parentClassName=null,this.parentClasspath=null,this.scriptClassName=null,this.scriptClasspath=null,this.callback=null,this.wlibs={},this.macros={},this.views={},this._curblock=null,this._blocks={},this._stack=[],this._dependencies=[],this.errors=t?!1:null,this.debug=!1,this.tree=null},$prototype:{addDependencies:function(e){for(var t=e.length-1;t>=0;t--)this.addDependency(e[t])},addDependency:function(e){this._dependencies[e]=1},getDependencies:function(){var e=[];for(var t in this._dependencies)this._dependencies.hasOwnProperty(t)&&e.push(this.stringify(t));return e.length>0?["$dependencies: [",e.join(","),"],"].join(""):""},getMacro:function(e){var t=this.macros[e];return null==t&&(t={},this.macros[e]=t),t},getView:function(e){var t=this.views[e];return null==t&&(t={},this.views[e]=t),t},isOutputReady:function(){return null!=this._curblock},newBlock:function(e,t){var i={curindentnbr:t,out:[]};this._blocks[e]=i},enterBlock:function(e){this._stack.push(this._curblock),this._curblock=this._blocks[e],this.indentUnit&&this._curblock&&this._updateIndent()},leaveBlock:function(){this._curblock=this._stack.pop(),this.indentUnit&&this._curblock&&this._updateIndent()},getBlockContent:function(e){return this._blocks[e].out.join("")},stringify:function(e){return this.stringify=t.stringify,this.stringify(e)},newVarName:function(){return this._varNameNumber++,"__v_"+this._varNameNumber},processContent:function(e){for(var t=0;t<e.length;t++)this.processStatement(e[t])},processStatement:function(e){this._processStatement.fn.call(this._processStatement.scope,this,e)},_updateIndent:function(){this._curindent=new Array(1+this._curblock.curindentnbr).join(this.indentUnit)},logError:function(e,t,i){this._processErrors?(this.errors=!0,this._processErrors.fn.call(this._processErrors.scope,e,t,i,this.errorContext)):(i||(i=[]),this.errors||(this.errors=this.logErrors?!0:[]),i.push(e.lineNumber),this.errors.push({msgId:t,msgArgs:i,errorContext:this.errorContext}))},logWarn:function(e,t,i){null==i&&(i=[]),i.push(e.lineNumber),this.$logWarn(t,i,this.errorContext)},increaseIndent:function(){this.indentUnit&&(this._curblock.curindentnbr++,this._curindent+=this.indentUnit)},decreaseIndent:function(){this.indentUnit&&(this._curblock.curindentnbr--,this._updateIndent())},writeln:function(){var e=this._curblock.out;this._curindent&&e.push(this._curindent),e.push.apply(e,arguments),e.push("\n")},write:function(){var e=this._curblock.out;e.push.apply(e,arguments)},wrapExpression:function(e,t,i){var r=this.newVarName();return e=this.stringify(e),this.writeln("var "+r+" = null;"),this.writeln("try {"),this.increaseIndent(),e=e.substr(1,e.length-2),this.writeln('eval( "'+r+"=("+e+')" );'),this.decreaseIndent(),this.writeln("} catch (e) {"),this.increaseIndent(),this.writeln("this.$logError(",i,',["',e,'",__filename,',t.lineNumber,",",this.stringify(t.name),"], e);"),this.decreaseIndent(),this.writeln("}"),r},trackLine:function(t){this._curblock&&this.writeln("this['"+e.FRAMEWORK_PREFIX+"currentLineNumber'] = "+t+";")}}});
//*******************
//LOGICAL-PATH:aria/templates/TreeBeans.js
//*******************
var e=require("../Aria"),t=require("../core/JsonTypes");module.exports=e.beanDefinitions({$package:"aria.templates.TreeBeans",$namespaces:{json:t},$beans:{Root:{$type:"Statement",$mandatory:!0,$properties:{name:{$type:"Statement.name",$regExp:/^#ROOT#$/},content:{$type:"Statement.content",$mandatory:!0},parent:{$type:"Statement.parent",$mandatory:!1}}},Statement:{$type:"json:Object",$properties:{name:{$type:"json:String",$mandatory:!0},lineNumber:{$type:"json:Integer",$mandatory:!0},parent:{$type:"json:ObjectRef",$mandatory:!0},content:{$type:"json:Array",$mandatory:!1,$contentType:{$type:"Statement",$mandatory:!0}},firstCharContentIndex:{$type:"json:Integer",$minValue:0,$mandatory:!1},lastCharContentIndex:{$type:"json:Integer",$minValue:0,$mandatory:!1},paramBlock:{$type:"json:String",$mandatory:!0},firstCharParamIndex:{$type:"json:Integer",$minValue:0,$mandatory:!1},lastCharParamIndex:{$type:"json:Integer",$minValue:0,$mandatory:!1}}}}});
//*******************
//LOGICAL-PATH:aria/templates/CfgBeans.js
//*******************
var e=require("../Aria"),t=require("../core/JsonTypes"),i=require("../core/CfgBeans");module.exports=e.beanDefinitions({$package:"aria.templates.CfgBeans",$namespaces:{json:t,coreBeans:i},$beans:{BaseTemplateCfg:{$type:"json:Object",$properties:{$classpath:{$type:"json:PackageName",$mandatory:!0},$dependencies:{$type:"json:Array",$default:[],$contentType:{$type:"json:PackageName"}},$hasScript:{$type:"json:Boolean",$default:!1},$extends:{$type:"json:PackageName"},$texts:{$type:"json:Map",$contentType:{$type:"json:PackageName",$mandatory:!0}}}},TemplateCfg:{$type:"BaseTemplateCfg",$mandatory:!0,$properties:{$width:{$type:"ContainerSizeCfg",$default:null},$height:{$type:"ContainerSizeCfg",$default:null},$wlibs:{$type:"json:Map",$contentType:{$type:"json:PackageName",$sample:"aria.widgets.AriaLib",$mandatory:!0},$default:{}},$res:{$type:"json:Map",$contentType:{$type:"json:MultiTypes",$sample:"aria.widgets.WidgetsRes"}},$templates:{$type:"json:Array",$contentType:{$type:"json:PackageName"}},$css:{$type:"json:Array",$contentType:{$type:"json:PackageName"}},$macrolibs:{$type:"json:Map",$contentType:{$type:"json:PackageName",$mandatory:!0}}}},LibraryCfg:{$type:"BaseTemplateCfg",$mandatory:!0,$properties:{$wlibs:{$type:"json:Map",$contentType:{$type:"json:PackageName",$sample:"aria.widgets.AriaLib",$mandatory:!0},$default:{}},$templates:{$type:"json:Array",$default:[],$contentType:{$type:"json:PackageName"}},$macrolibs:{$type:"json:Map",$contentType:{$type:"json:PackageName",$mandatory:!0}},$res:{$type:"json:Map",$contentType:{$type:"json:PackageName",$sample:"aria.widgets.WidgetsRes"}}}},CSSTemplateCfg:{$type:"BaseTemplateCfg",$properties:{$csslibs:{$type:"json:Map",$contentType:{$type:"json:PackageName",$mandatory:!0}},$prefix:{$type:"json:Boolean"}}},CSSLibraryCfg:{$type:"BaseTemplateCfg",$mandatory:!0,$properties:{$csslibs:{$type:"json:Map",$contentType:{$type:"json:PackageName",$mandatory:!0}},$res:{$type:"json:Map",$contentType:{$type:"json:PackageName",$sample:"aria.widgets.WidgetsRes"}}}},TextTemplateCfg:{$type:"BaseTemplateCfg",$mandatory:!0,$properties:{$res:{$type:"json:Map",$contentType:{$type:"json:PackageName",$sample:"aria.widgets.WidgetsRes"}}}},ContainerSizeCfg:{$type:"json:Object",$properties:{min:{$type:"json:Integer"},max:{$type:"json:Integer"},value:{$type:"json:Integer"},scrollbar:{$type:"json:Boolean"}},$default:{}},RootDimCfg:{$type:"json:Object",$mandatory:!0,$properties:{width:{$type:"ContainerSizeCfg"},height:{$type:"ContainerSizeCfg"}}},ModuleCtrl:{$type:"json:MultiTypes",$contentTypes:[{$type:"json:ObjectRef",$mandatory:!0},{$type:"InitModuleCtrl"}]},InitModuleCtrl:{$type:"json:Object",$mandatory:!0,$properties:{classpath:{$type:"json:PackageName",$mandatory:!0},autoDispose:{$type:"json:Boolean",$default:!0},constructorArgs:{$type:"json:ObjectRef",$mandatory:!1},initArgs:{$type:"json:ObjectRef",$mandatory:!1}}},Div:{$type:"json:MultiTypes",$mandatory:!0,$contentTypes:[{$type:"json:ObjectRef"},{$type:"json:String"}]},TemplateSizeCfg:{$type:"json:MultiTypes",$contentTypes:[{$type:"json:Integer"},{$type:"RelativeTemplateSizeCfg"}]},RelativeTemplateSizeCfg:{$type:"json:Object",$properties:{min:{$type:"json:Integer",$mandatory:!0},incrementFactor:{$type:"json:Float",$default:1},max:{$type:"json:Integer",$default:null}}},PrintOptions:{$type:"json:Enum",$enumValues:["hidden","visible","adaptX","adaptY","adaptXY"],$default:"visible"},BaseLoadTemplateCfg:{$type:"json:Object",$properties:{classpath:{$type:"json:MultiTypes",$mandatory:!0},id:{$type:"json:String",$mandatory:!1},origClasspath:{$type:"json:MultiTypes",$mandatory:!1},printOptions:{$type:"PrintOptions",$default:"adaptXY"},width:{$type:"TemplateSizeCfg",$mandatory:!1},height:{$type:"TemplateSizeCfg",$mandatory:!1},data:{$type:"json:ObjectRef",$mandatory:!1},moduleCtrl:{$type:"ModuleCtrl",$mandatory:!1},args:{$type:"json:Array",$default:[],$contentType:{$type:"json:MultiTypes"}},rootDim:{$type:"RootDimCfg",$mandatory:!1},provideContext:{$type:"json:Boolean",$mandatory:!1,$default:!1},reload:{$type:"json:Boolean",$default:!1},reloadByPassCache:{$type:"json:Boolean",$default:!1}}},LoadTemplateCfg:{$type:"BaseLoadTemplateCfg",$properties:{div:{$type:"Div",$mandatory:!0}}},InitTemplateCfg:{$type:"BaseLoadTemplateCfg",$properties:{originalId:{$type:"json:String",$mandatory:!1},div:{$type:"Div",$mandatory:!1},tplDiv:{$type:"Div",$mandatory:!1},macro:{$type:"MacroCfg"},toDispose:{$type:"json:Array",$contentType:{$type:"json:ObjectRef",$mandatory:!0}},baseTabIndex:{$type:"json:Integer",$default:0},isRootTemplate:{$type:"json:Boolean",$default:!1},context:{$type:"json:ObjectRef",$mandatory:!1}}},InitCSSTemplateCfg:{$type:"json:Object",$mandatory:!0,$properties:{classpath:{$type:"json:PackageName",$mandatory:!0},isWidget:{$type:"json:Boolean",$mandatory:!1,$default:!1},widgetName:{$type:"json:String",$mandatory:!1,$default:""},isTemplate:{$type:"json:Boolean",$mandatory:!1,$default:!1}}},InitTxtTemplateCfg:{$type:"json:Object",$mandatory:!0,$properties:{classpath:{$type:"json:PackageName",$mandatory:!0},data:{$type:"json:ObjectRef",$mandatory:!1}}},MacroCfg:{$type:"json:MultiTypes",$contentTypes:[{$type:"json:String"},{$type:"json:Object",$properties:{name:{$type:"json:String"},args:{$type:"json:Array",$contentType:{$type:"json:MultiTypes"},$default:[]},scope:{$type:"json:ObjectRef"}}}]},HtmlAttribute:{$type:"json:Object",$properties:{name:{$type:"json:String"},title:{$type:"json:String"},classList:{$type:"json:Array",$contentType:{$type:"json:String"}},dataset:{$type:"json:ObjectRef"},style:{$type:"json:String"},dir:{$type:"json:String"},lang:{$type:"json:String"},abbr:{$type:"json:String"},height:{$type:"json:String"},width:{$type:"json:String"},size:{$type:"json:String"},cols:{$type:"json:String"},rows:{$type:"json:String"},rowspan:{$type:"json:String"},colspan:{$type:"json:String"},nowrap:{$type:"json:String"},valign:{$type:"json:String"},align:{$type:"json:String"},border:{$type:"json:String"},cellpadding:{$type:"json:String"},cellspacing:{$type:"json:String"},disabled:{$type:"json:String"},readonly:{$type:"json:String"},checked:{$type:"json:String"},selected:{$type:"json:String"},multiple:{$type:"json:String"},value:{$type:"json:String"},alt:{$type:"json:String"},maxlength:{$type:"json:String"},type:{$type:"json:String"},accesskey:{$type:"json:String"},tabindex:{$type:"json:Integer"},placeholder:{$type:"json:String"},autocomplete:{$type:"json:String"},autofocus:{$type:"json:String"},autocorrect:{$type:"json:String"},autocapitalize:{$type:"json:String"},spellcheck:{$type:"json:String"}}},SectionCfg:{$type:"json:Object",$properties:{id:{$type:"json:String"},type:{$type:"json:String",$default:"span"},bindRefreshTo:{$type:"json:Array",$default:[],$contentType:{$type:"BindingConfiguration",$sample:"{inside : ..., to : ...}"}},bindProcessingTo:{$type:"BindingConfiguration",$default:{inside:{},to:"processing",recursive:!1}},keyMap:{$type:"json:Array",$mandatory:!1,$contentType:{$type:"KeyMapCfg"}},tableNav:{$type:"TableNavConfiguration",$mandatory:!1},processingLabel:{$type:"json:String",$mandatory:!1,$default:""},macro:{$type:"MacroCfg"},cssClass:{$type:"json:String"},attributes:{$type:"HtmlAttribute"},on:{$type:"json:Object",$default:{},$restricted:!1},bind:{$type:"json:Object",$properties:{attributes:{$type:"BindingConfiguration"},animation:{$type:"BindingConfiguration"}}},animation:{$type:"json:Object",$properties:{animateIn:{$type:"json:String"},animateOut:{$type:"json:String"}}}}},RepeaterCfg:{$type:"SectionCfg",$mandatory:!0,$properties:{content:{$type:"json:ObjectRef",$mandatory:!0},loopType:{$type:"json:Enum",$enumValues:["array","pagedView","sortedView","filteredView","view","map"],$mandatory:!1},childSections:{$type:"json:Object",$restricted:!1,$properties:{id:{$type:"json:MultiTypes",$mandatory:!0},macro:{$type:"json:MultiTypes",$mandatory:!0}}},macro:{$type:"SectionCfg.macro"}}},BindingConfiguration:{$type:"json:Object",$properties:{to:{$type:"json:JsonProperty",$default:null},inside:{$type:"json:ObjectRef",$mandatory:!0},recursive:{$type:"json:Boolean",$default:!0},animate:{$type:"json:Boolean",$default:!0}}},TableNavConfiguration:{$type:"json:MultiTypes"},RefreshCfg:{$type:"json:Object",$default:{},$properties:{macro:{$type:"MacroCfg",$mandatory:!1},section:{$type:"json:String",$mandatory:!1},animate:{$type:"json:Boolean",$default:!0}}},GetRefreshedSectionCfg:{$type:"RefreshCfg",$properties:{writerCallback:{$type:"coreBeans:Callback"}}},InsertAdjacentSectionsCfg:{$type:"json:Object",$mandatory:!0,$properties:{sections:{$type:"json:Array",$mandatory:!0,$contentType:{$type:"json:MultiTypes",$mandatory:!0,$contentTypes:[{$type:"json:String"},{$type:"SectionCfg"}]}},refSection:{$type:"json:Object",$mandatory:!0,$properties:{object:{$type:"json:ObjectRef",$classpath:"aria.templates.Section",$mandatory:!0},domElt:{$type:"json:ObjectRef",$mandatory:!0}}},position:{$type:"json:Enum",$mandatory:!0,$enumValues:["beforeBegin","afterBegin","beforeEnd","afterEnd"]}}},SubModuleDefinition:{$type:"json:Object",$mandatory:!0,$properties:{refpath:{$type:"json:String",$regExp:/./,$mandatory:!0,$sample:"pkg1.module"},arrayIndex:{$type:"json:Integer",$mandatory:!1},classpath:{$type:"json:PackageName",$mandatory:!0},initArgs:{$type:"json:ObjectRef",$mandatory:!1}}},TplScriptDefinitionCfg:{$type:"json:Object",$properties:{$classpath:{$type:"json:PackageName",$mandatory:!0,$sample:"aria.jsunit.TestSuite"},$dependencies:{$type:"json:Array",$default:[],$contentType:{$type:"json:PackageName"}},$resources:{$type:"json:Map",$contentType:{$type:"json:MultiTypes",$sample:"aria.widgets.WidgetsRes",$contentTypes:[{$type:"json:Object"},{$type:"json:String"}]}},$texts:{$type:"json:Map",$contentType:{$type:"json:PackageName",$mandatory:!0}},$statics:{$type:"json:Map",$contentType:{$type:"json:MultiTypes"}},$prototype:{$type:"json:MultiTypes",$contentTypes:[{$type:"json:Map",$contentType:{$type:"json:MultiTypes"}},{$type:"json:FunctionRef"}]},$constructor:{$type:"json:FunctionRef"},$destructor:{$type:"json:FunctionRef"}}},KeyMapCfg:{$type:"json:Object",$properties:{key:{$type:"json:MultiTypes",$mandatory:!0,$contentTypes:[{$type:"json:Integer"},{$type:"json:String",$sample:"F4"}]},ctrl:{$type:"json:Boolean"},shift:{$type:"json:Boolean"},alt:{$type:"json:Boolean"},callback:{$type:"json:MultiTypes",$mandatory:!0,$contentTypes:[{$type:"json:FunctionRef"},{$type:"coreBeans:Callback"}]},event:{$type:"json:Enum",$enumValues:["keyup","keydown"]}}},GlobalKeyMapCfg:{$type:"KeyMapCfg",$properties:{modal:{$type:"json:Boolean",$default:!1}}}}});
//*******************
//LOGICAL-PATH:aria/templates/Modifiers.js
//*******************
var e=require("../Aria"),t=require("../utils/Type"),i=require("../utils/String"),r=require("../utils/Array");!function(){var n,a={eat:{fn:function(){return""}},escapeforhtml:{init:function(e){e.addDependencies(["aria.utils.String"])},fn:function(e,t){if(null==e)return e;var r={},n=i.escapeForHTML(e+"",t,r);return r.escaped?n:e}},capitalize:{fn:function(e){return String(e).toUpperCase()}},"default":{fn:function(e,t){return null!=e?e:t}},empty:{fn:function(e,t){return e&&!/^\s*$/.test(e)?e:t}},pad:{fn:function(e,t,i,r){e=""+e,r=r||"&nbsp;";var n=e.length;if(t>n){var a=i===!0,s=[],o=t-n;a||s.push(e);for(var l=0;o>l;l++)s.push(r);return a&&s.push(e),s.join("")}return e}},dateformat:{init:function(e){e.addDependencies(["aria.utils.Date","aria.utils.Type"])},fn:function(e,i){return t.isDate(e)?aria.utils.Date.format(e,i):void this.$logError(aria.templates.Modifiers.DATEFORMAT_MODIFIER_ENTRY,[e])}},timeformat:{init:function(e){e.addDependencies(["aria.utils.Date","aria.utils.Type"])},fn:function(e,i){return t.isDate(e)?aria.utils.Date.format(e,i):void this.$logError(aria.templates.Modifiers.DATEFORMAT_MODIFIER_ENTRY,[e])}},highlightfromnewword:{init:function(e){e.addDependencies(["aria.utils.String","aria.utils.Type"])},fn:function(e,t){var i=aria.utils,r=t.length;if(i.Type.isString(e)&&r){t=t.toLowerCase();var a,s=e.toLowerCase();if(0===s.indexOf(t))a=0;else{var o=t.replace(n,"\\$1"),l=new RegExp("\\s"+o,"i").exec(s);if(!l)return e;a=l.index+1}var u=a,c=a+r,h=e.substring(u,c),p=i.String.stripAccents(h).toLowerCase();if(p===t)return e.substring(0,u)+"<strong>"+h+"</strong>"+e.substring(c)}return e}},starthighlight:{init:function(e){e.addDependencies(["aria.utils.String","aria.utils.Type"])},fn:function(e,r){if(t.isString(e)&&r.length){var n=i.stripAccents(e.substring(0,r.length)).toLowerCase();if(r=r.toLowerCase(),n===r)return"<strong>"+e.substring(0,r.length)+"</strong>"+e.substring(r.length)}return e}},highlight:{init:function(e){e.addDependencies(["aria.utils.String","aria.utils.Type"])},fn:function(e,i){if(t.isString(e)&&t.isString(i)){var a=e.split(" "),s=i.split(" ").sort(function(e,t){var i=e.length,r=t.length;return i===r?0:r>i?1:-1});return r.forEach(a,function(e,t,i){for(var r=0,a=s.length;e&&a>=r;r+=1)if(null!=s[r]&&""!==s[r]){var o=s[r].replace(n,"\\$1"),l=new RegExp("\\b"+o,"gim");o.match(/\(/)&&(l=new RegExp("[\\b\\(]"+o.replace("\\(",""),"gim"));var u=l.exec(e);if(null!=u&&u.length>0){var c="<strong>"+u[0]+"</strong>";if(i[t]=e.replace(l,c),e.match(l))break}}}),a.join(" ")}return e}}};module.exports=e.classDefinition({$classpath:"aria.templates.Modifiers",$singleton:!0,$constructor:function(){n=new RegExp("(\\"+"/.*+?|()[]{}\\".split("").join("|\\")+")","g")},$statics:{UNKNOWN_MODIFIER:"Unknown modifier %1.",DATEFORMAT_MODIFIER_ENTRY:"Entry %1 is not a date."},$prototype:{callModifier:function(e,t){e=""+e;var i=a[e.toLowerCase()];return i?i.fn.apply(this,t):void this.$logError(aria.templates.Modifiers.UNKNOWN_MODIFIER,[e])},initModifier:function(e,t){var i=a[e];i&&i.init&&i.init(t)}}})}();
//*******************
//LOGICAL-PATH:aria/templates/Statements.js
//*******************
var e=require("../Aria"),t=require("../utils/String"),r=require("./Modifiers");require("../utils/Path");var i=require("../utils/Delegate"),n=require("../utils/Type"),a=require("../core/environment/Environment"),s=require("../core/AppEnvironment"),o=0,l="__$autoGenerated__",u=0,c=[],h="";module.exports=e.classDefinition({$classpath:"aria.templates.Statements",$singleton:!0,$statics:{SHOULD_BE_IN_MACRO:"line %2: Template error: statement '%1' cannot be used out of a macro.",TEMPLATE_STATEMENT_MISUSED:"Template error: the '%1' statement is misused, it should only be used as the root statement in a template.",ELSE_WITHOUT_IF:"line %1: Template error: 'else' or 'elseif' is used outside an 'if' structure.",ELSEIF_AFTER_ELSE:"line %1: Template error: 'elseif' is used after 'else' in the same 'if' structure.",ELSE_ALREADY_USED:"line %1: Template error: an 'else' statement has already been used in this 'if' structure.",INVALID_WIDGET_SYNTAX:"line %1: Template error: invalid syntax for the widget statement; expected syntax: @lib:widget",UNDECLARED_WIDGET_LIBRARY:"line %2: Template error: found widget library '%1', which is undeclared in the wlibs parameter of the 'Template' statement.",INVALID_MODIFIER_SYNTAX:"line %2: Template error: invalid modifier syntax '%1'.",UNKNOWN_WIDGET:"line %2: Template error: unknown widget '%1'.",MACRO_ALREADY_DEFINED:"line %3: Template error: macro '%1' is already defined line %2.",SEPARATOR_NOT_FIRST_IN_FOREACH:"line %1: Template error: the separator statement can only be used as the first statement inside a {foreach ...} ... {/foreach} loop.",INCOMPATIBLE_CREATEVIEW:"line %2: Template error: two createView statements with the same view base name must have the same depth (previous definition line %1).",INCORRECT_VARIABLE_NAME:"line %2: Template error: incorrect variable name '%1'.",INVALID_FOREACH_INKEYWORD:"line %2: Template error: invalid foreach syntax, expected one of 'in', 'inView', 'inFilteredView', 'inSortedView', 'inPagedView' but found: '%1'.",INVALID_WIDGET_LIBRARY:"line %3: Template error: %1 (%2) is not a valid widget library. A widget library must extend aria.widgetLibs.WidgetLib.",INVALID_EVENT_TYPE:"The event type: '%1' is an invalid event type.",SECTIONS_AS_CONTAINERS:"Sections as container statements ({section {...}}...{/section}) have been allowed through the application environment. Nevertheless, it is strongly advisable to use them as self-closing statements ({section {...}/})."},$constructor:function(){var p=t,d=r,f=this,m={inMacro:!1,container:!0,process:function(e,t){return e.logError(t,f.TEMPLATE_STATEMENT_MISUSED,[t.name])}};this.ALLSTATEMENTS={Template:m,Library:m,CSSTemplate:m,CSSLibrary:m,TextTemplate:m,"#TEXT#":{container:!1,process:function(e,t){if(e.isOutputReady()){var r=e.stringify(t.paramBlock);e.writeln("this.__$write(",r,",",t.lineNumber,");")}else""!==t.paramBlock.replace(/[ \t\r\n]+/gm,"")&&e.logError(t,f.SHOULD_BE_IN_MACRO,["#TEXT# - "+t.paramBlock])}},"#CDATA#":{inMacro:!0,container:!1,process:function(e,t){var r=e.stringify(t.paramBlock);e.writeln("this.__$write(",r,",",t.lineNumber,");")}},"#EXPRESSION#":{inMacro:!0,container:!1,process:function(e,t,r){for(var i=t.paramBlock,n=p.indexOfNotEscaped(i,"|"),s=[];-1!=n;)s.push(i.substr(0,n)),i=i.substr(n+1),n=p.indexOfNotEscaped(i,"|");if(s.push(i),a.hasEscapeHtmlByDefault()){var o=r.escapeModifier;null!=o&&(o=o.toLowerCase(),s[s.length-1].toLowerCase().indexOf(o)<0&&s.push(o))}for(var l,u=[],c=[],h=/^(\w+)(?::([\s\S]*))?$/,m=s.length-1;m>=1;m--){var g=s[m],_=h.exec(g);if(!_)return e.logError(t,f.INVALID_MODIFIER_SYNTAX,[g]);var y=_[1];d.initModifier(y,e),u.push("this.$modifier('"+y+"',["),l=_[2],c[m]=l?", "+l+"])":"])"}l=s[0],u.push(l),l=u.concat(c).join(""),e.debug&&(l=e.wrapExpression(l,t,"this.EXCEPTION_IN_EXPRESSION")),e.writeln("this.__$write(",l,",",t.lineNumber,");")}},separator:{inMacro:!0,container:!0,paramRegexp:/^$/,process:function(t,r){var i=r.parent,n=i.content[0]==r||i.content[1]==r&&"#TEXT#"==i.content[0].name;if("foreach"!=i.name||!n)return void t.logError(r,f.SEPARATOR_NOT_FIRST_IN_FOREACH);var a=i[e.FRAMEWORK_PREFIX+"foreachCounter"];t.writeln("if (",a,">1) {"),t.increaseIndent(),t.processContent(r.content),t.decreaseIndent(),t.writeln("}")}},id:{inMacro:!0,container:!1,paramRegexp:/^\s*(\S[\s\S]*)\s*$/,process:function(e,t,r){var i=r[0];e.writeln("this.__$writeId(",i,",",t.lineNumber,");")}},on:{inMacro:!0,container:!1,paramRegexp:/^(\w+)\s+([\s\S]+)$/,process:function(e,t,r){var n=r[1],a=r[2],s=i,o=s.delegatedGestures[n];o&&e.addDependency(o),s.supportedEvents[n]||e.logWarn(t,f.INVALID_EVENT_TYPE,[n]),e.writeln("this.__$statementOnEvent(",e.stringify(n),",this.$normCallback(",a,"),",t.lineNumber,");")}},"if":{inMacro:!0,container:!0,process:function(t,r){var i=r.paramBlock;t.writeln("if (",i,") {"),t.increaseIndent(),t.processContent(r.content),delete r[e.FRAMEWORK_PREFIX+"elsepresent"],t.decreaseIndent(),t.writeln("}")}},elseif:{inMacro:!0,container:!1,process:function(t,r){var i=r.paramBlock,n=r.parent;return"if"!=n.name?t.logError(r,f.ELSE_WITHOUT_IF):n[e.FRAMEWORK_PREFIX+"elsepresent"]?t.logError(r,f.ELSEIF_AFTER_ELSE):(t.decreaseIndent(),t.writeln("} else if (",i,") {"),void t.increaseIndent())}},"else":{inMacro:!0,container:!1,paramRegexp:/^$/,process:function(t,r){var i=r.parent;return"if"!=i.name?t.logError(r,f.ELSE_WITHOUT_IF):i[e.FRAMEWORK_PREFIX+"elsepresent"]?t.logError(r,f.ELSE_ALREADY_USED):(i[e.FRAMEWORK_PREFIX+"elsepresent"]=!0,t.decreaseIndent(),t.writeln("} else {"),void t.increaseIndent())}},createView:{inMacro:void 0,container:!1,paramRegexp:/^([_\w]+)(\[([^\[\]]+(\]\[[^\[\]])*)\])?\s+on\s+([\s\S]+)$/,process:function(t,r,i){var n=i[1];if(e.isJsReservedWord(n))return t.logError(r,f.INCORRECT_VARIABLE_NAME,[n]);var a=i[3],s=i[5],o=[],l=0;a?(o=a.split("]["),l=o.length,a=["[(",o.join("),("),")]"].join("")):a="[]";var u=t.getView(n);if(u.firstDefinition){if(u.nbParams!=l)return void t.logError(r,f.INCOMPATIBLE_CREATEVIEW,[u.firstDefinition.lineNumber])}else u.firstDefinition=r,u.nbParams=l;t.addDependency("aria.templates.View");var c=!t.isOutputReady();c&&t.enterBlock("globalVars"),t.writeln(c?"this.":"var ",n,"=this.__$createView(",t.stringify(n),",",a,",(",s,"));"),c&&t.leaveBlock()}},"for":{inMacro:!0,container:!0,process:function(e,t){e.writeln("for (",t.paramBlock,") {"),e.increaseIndent(),e.processContent(t.content),e.decreaseIndent(),e.writeln("}")}},foreach:{inMacro:!0,container:!0,paramRegexp:/^([_\w]+)\s+(\w+)\s+([\s\S]+)$/,process:function(t,r,i){var n=t.newVarName(),a=i[1];if(e.isJsReservedWord(a))return t.logError(r,f.INCORRECT_VARIABLE_NAME,[a]);var s=i[2];if("in"!=s&&"inArray"!=s&&"inView"!=s&&"inSortedView"!=s&&"inFilteredView"!=s&&"inPagedView"!=s)return t.logError(r,f.INVALID_FOREACH_INKEYWORD,[s]);var o="in"!=s&&"inArray"!=s;"inView"==s&&(s="inPagedView");var l=i[3],u=a+"_index";t.debug&&(l=t.wrapExpression(l,r,"this.ITERABLE_UNDEFINED")),t.writeln("var ",n,"=(",l,");"),t.writeln("if(",l,"==undefined){"),t.increaseIndent(),t.writeln("this.$logError(this.ITERABLE_UNDEFINED,[",t.stringify(r.name),",__filename, ",r.lineNumber,"]);"),t.decreaseIndent(),t.writeln("}");var c=a+"_ct";r[e.FRAMEWORK_PREFIX+"foreachCounter"]=c,t.writeln("var ",c,"=0;");var h;if(o){if(h=t.newVarName(),t.writeln(n,".refresh();"),"inPagedView"==s){var p=t.newVarName();t.writeln("var ",p,"=",n,".currentPageIndex;"),t.writeln("var ",h,"=",n,".pages[",p,"].lastItemIndex;"),t.writeln("for (var ",u,"=",n,".pages[",p,"].firstItemIndex;",u,"<=",h,";",u,"++) {")}else t.writeln("var ",h,"=",n,".items.length;"),t.writeln("for (var ",u,"=0;",u,"<",h,";",u,"++) {");t.increaseIndent(),t.writeln("var ",a,"_info=",n,".items[",u,"];"),"inPagedView"==s?t.writeln("if (",a,"_info.pageIndex==",p,") {"):"inFilteredView"==s&&t.writeln("if (",a,"_info.filteredIn) {"),t.increaseIndent(),t.writeln("var ",a,"=",a,"_info.value;")}else"inArray"==s?(h=t.newVarName(),t.writeln("var ",h,"=",n,".length;"),t.writeln("for (var ",u,"=0;",u,"<",h,";",u,"++) {"),t.increaseIndent(),t.writeln("var ",a,"=",n,"[",u,"];")):(t.writeln("for (var ",u," in ",n,") {"),t.increaseIndent(),t.writeln("if (",n,".hasOwnProperty(",u,") && !this.$json.isMetadata(",u,")) {"),t.increaseIndent(),t.writeln("var ",a,"=",n,"[",u,"];"));t.writeln(c,"++;"),t.processContent(r.content),"inSortedView"!=s&&"inArray"!=s&&(t.decreaseIndent(),t.writeln("}")),t.decreaseIndent(),t.writeln("}")}},repeater:{inMacro:!0,container:!1,process:function(e,t){var r=t.paramBlock;e.debug&&(r=e.wrapExpression(r,t,"this.EXCEPTION_IN_REPEATER_PARAMETER")),e.addDependency("aria.templates.Repeater"),e.writeln("this.__$statementRepeater(",t.lineNumber,",(",r,"));")}},macro:{inMacro:!1,container:!0,paramRegexp:/^([_\w]+)\s*(\(\s*([_\w]+\s*(,\s*[_\w]+\s*)*)?\))\s*$/,process:function(t,r,i){var n=i[1];h=n;var a=t.getMacro(n);return null!=a.definition?t.logError(r,f.MACRO_ALREADY_DEFINED,[n,a.definition.lineNumber]):(a.definition=r,t.enterBlock("prototype"),t.writeln("macro_",n,": function ",i[2],"{"),t.increaseIndent(),t.writeln("try {"),t.increaseIndent(),t.writeln("with (this) {"),t.increaseIndent(),t.processContent(r.content),t.decreaseIndent(),t.writeln("}"),t.decreaseIndent(),t.writeln("} catch (_ex) {"),t.increaseIndent(),t.writeln("this.$logError(this.EXCEPTION_IN_MACRO,[",t.stringify(n),",__filename, this['"+e.FRAMEWORK_PREFIX+"currentLineNumber']],_ex);"),t.decreaseIndent(),t.writeln("}"),c.length>0&&(t.writeln("var ",c.join(", "),";"),c=[]),t.decreaseIndent(),t.writeln("},"),void t.leaveBlock())}},memo:{inMacro:!0,container:!0,paramRegexp:/^[\S\s]*$/,process:function(e,t){e.processContent(t.content)}},call:{inMacro:!0,container:!1,paramRegexp:/^(\$?[_\w]+\.)?([_\w]+)\s*\(([\s\S]*)\)\s*$/,process:function(e,t,r){var i,n,a=r[1],s=r[2],o=r[3];if(a?(i="this."+a+"macro_"+s,n="$"==a.charAt(0)?i+".apply(this,["+o+"]);":i+"("+o+");"):(i="this.macro_"+s,n=i+"("+o+");"),e.debug){var l=a?a+s:s;e.writeln("if (",i," == null) {"),e.increaseIndent(),e.writeln("this.$logError(this.MACRO_NOT_FOUND,[__filename,",t.lineNumber,",",e.stringify(l),"]);"),e.decreaseIndent(),e.writeln("}")}e.writeln(n)}},section:{inMacro:!0,container:this.__allowSectionsAsContainers()?null:!1,process:function(t,r){var i=r.paramBlock,n=r.content||null;if(n){o++;var a=l+o;u++,t.writeln("this.macro_",a,"= function (){"),t.increaseIndent(),t.writeln("try {"),t.increaseIndent(),t.processContent(r.content),t.decreaseIndent(),t.writeln("} catch (_ex) {"),t.increaseIndent(),t.writeln("this.$logError(this.EXCEPTION_IN_MACRO,[",t.stringify(h),",__filename, this['"+e.FRAMEWORK_PREFIX+"currentLineNumber']],_ex);"),t.decreaseIndent(),t.writeln("}"),t.decreaseIndent(),t.writeln("};");var s='{name : "'+a+'", scope : this}';t.writeln("this.__$insertSection(",r.lineNumber,",",i,",",s,");"),u--}else t.writeln("this.__$insertSection(",r.lineNumber,",",i,");")}},"var":{inMacro:void 0,container:!1,paramRegexp:/^([_\w]+)\s*=([\s\S]*)$/,process:function(t,r,i){var n=i[1],a=i[2];if(e.isJsReservedWord(n))return t.logError(r,f.INCORRECT_VARIABLE_NAME,[n]);if(t.isOutputReady()){t.debug&&(a=t.wrapExpression(a,r,"this.EXCEPTION_IN_VAR_EXPRESSION"));var s="var ";u>0&&(s="",c.push(n)),t.writeln(s,n,"=(",a,");")}else t.enterBlock("globalVars"),t.debug&&(a=t.wrapExpression(a,r,"this.EXCEPTION_IN_VAR_EXPRESSION")),t.writeln("this.",n,"=(",a,");"),t.leaveBlock()}},set:{inMacro:!0,container:!1,paramRegexp:/^([_\w]+(?:\.[_\w]+)*)\s*([\+\-]?\=)([\s\S]*)$/,process:function(t,r,i){for(var n=i[1],a=i[2],s=i[3],o=n.split("."),l=0,u=o.length;u>l;l++)if(e.isJsReservedWord(o[l]))return t.logError(r,f.INCORRECT_VARIABLE_NAME,[n]);t.debug&&(s=t.wrapExpression(s,r,"this.EXCEPTION_IN_SET_EXPRESSION")),t.writeln(n,a,"(",s,");")}},checkDefault:{inMacro:!0,container:!1,paramRegexp:/^([_\w]+)\s*\=([\s\S]*)$/,process:function(t,r,i){var n=i[1],a=i[2];return e.isJsReservedWord(n)?t.logError(r,f.INCORRECT_VARIABLE_NAME,[n]):(t.debug&&(a=t.wrapExpression(a,r,"this.EXCEPTION_IN_CHECKDEFAULT_EXPRESSION")),t.writeln("if (",n,"===undefined) {"),t.increaseIndent(),t.writeln(n,"=(",a,");"),t.decreaseIndent(),void t.writeln("}"))}},"@":{inMacro:!0,container:null,process:function(t,r){var i=/^@(\w+):(\w+)$/.exec(r.name);if(!i||3!=i.length)return t.logError(r,f.INVALID_WIDGET_SYNTAX);var a=i[1],s=i[2],o=t.templateParam.$wlibs[a];if(void 0===o)return t.logError(r,f.UNDECLARED_WIDGET_LIBRARY,[a]);var l=t.wlibs[a];if(!l){if(l=e.getClassRef(o),!n.isInstanceOf(l,"aria.widgetLibs.WidgetLib"))return t.logError(r,f.INVALID_WIDGET_LIBRARY,[a,o]);t.wlibs[a]=l}var u=l.getWidgetDependencies(s,t.allDependencies);if(!u)return t.logError(r,f.UNKNOWN_WIDGET,[r.name]);t.addDependencies(u);var c=r.paramBlock;if(0===c.length)c="undefined";else{for(var h=[],p=/[\'\"](aria\.widgets\.transform\.(.+))[\'\"]/g,d=p.exec(c);d;)h.push(d[1]),d=p.exec(c);t.addDependencies(h)}t.debug&&"undefined"!=c&&(c=t.wrapExpression(c,r,"this.EXCEPTION_IN_CONTROL_PARAMETERS")),r.content?(t.writeln("if (this.__$beginContainerWidget(",t.stringify(o),",",t.stringify(s),",(",c,"),",r.lineNumber,")) {"),t.increaseIndent(),t.processContent(r.content),t.writeln("this.__$endContainerWidget();"),t.decreaseIndent(),t.writeln("}")):t.writeln("this.__$processWidgetMarkup(",t.stringify(o),",",t.stringify(s),",(",c,"),",r.lineNumber,");")}}},s.$on({environmentChanged:this.__onEnvironmentChanged,scope:this})},$destructor:function(){s.$unregisterListeners(this)},$prototype:{__allowSectionsAsContainers:function(){var e=a.checkApplicationSettings("templateSettings").allowSectionsAsContainers;return e&&this.$logWarn(this.SECTIONS_AS_CONTAINERS),e},__onEnvironmentChanged:function(){this.ALLSTATEMENTS.section.container=this.__allowSectionsAsContainers()?null:!1}}});
//*******************
//LOGICAL-PATH:aria/templates/ClassGenerator.js
//*******************
var Aria=require("../Aria"),ariaTemplatesClassWriter=require("./ClassWriter");require("./TreeBeans"),require("./CfgBeans");var ariaTemplatesStatements=require("./Statements");require("./Modifiers");var ariaUtilsArray=require("../utils/Array"),ariaUtilsJson=require("../utils/Json"),ariaCoreJsonValidator=require("../core/JsonValidator"),ariaCoreEnvironmentEnvironment=require("../core/environment/Environment");module.exports=Aria.classDefinition({$classpath:"aria.templates.ClassGenerator",$singleton:!1,$constructor:function(){this._parser=null,this._superClass=null,this._classType=null,this._rootStatement=null,this._templateParamBean=null,this.STATEMENTS={},this.ALLSTATEMENTS=ariaTemplatesStatements.ALLSTATEMENTS,this._loadStatements(["#ROOT#","#TEXT#","#CDATA#","#EXPRESSION#","if","elseif","else","for","foreach","separator","var","set","checkDefault","macro","call","memo"]),this._isDebug=ariaCoreEnvironmentEnvironment.isDebug(),ariaCoreEnvironmentEnvironment.$on({debugChanged:function(){this._isDebug=ariaCoreEnvironmentEnvironment.isDebug()},scope:this})},$statics:{TEMPLATE_STATEMENT_EXPECTED:"Template error: please check that the whole template is enclosed in a '%1' statement.",ERROR_IN_TEMPLATE_PARAMETER:"Template error, while evaluating the parameter of the '%1' statement.",CHECK_ERROR_IN_TEMPLATE_PARAMETER:"Template error: the parameter of the '%1' statement does not respect the bean definition.",UNKNOWN_STATEMENT:"line %2: Template error: unknown statement '%1'.",EXPECTED_CONTAINER:"line %2: Template error: statement '%1' must be used as a container.",UNEXPECTED_CONTAINER:"line %2: Template error: statement '%1' cannot be used as a container.",SHOULD_BE_OUT_OF_MACRO:"line %2: Template error: statement '%1' cannot be used in a macro.",INVALID_STATEMENT_SYNTAX:"line %3: Template error: invalid parameter for statement '%1'; it should respect the regular expression %2."},$prototype:{parseTemplate:function(e,t,r,i,n,a){var s,o;try{s=this._parser.parseTemplate(e,i,this.STATEMENTS,a)}catch(l){o=l.errors||l}return null==s?void this.$callback(r,{classDef:null,errors:o||!0}):void this.__buildClass(s,t,r,i,n,a)},parseTemplateFromTree:function(e,t,r,i,n,a){this.__buildClass(e,t,r,i,n,a)},_loadStatements:function(e){for(var t=0,r=e.length;r>t;t+=1){var i=e[t];this.STATEMENTS[i]=this.ALLSTATEMENTS[i]}},getStatements:function(){return this.STATEMENTS},__buildClass:function(e,t,r,i,n,a){ariaCoreJsonValidator.check(e,"aria.templates.TreeBeans.Root");var s=new ariaTemplatesClassWriter({fn:this.__processStatement,scope:this},a?null:{fn:this.__logError,scope:this});s.errorContext=i,s.allDependencies=t,s.callback=r,s.tree=e,s.debug=n===!0,this._processRootStatement(s,e),s.errors&&(s.$dispose(),this.$callback(r,{errors:s.errors,classDef:null}))},_processRootStatement:function(out,tree){var rootStatement=tree.content[0];if(1!=tree.content.length||rootStatement.name!=this._rootStatement)return out.logError(tree,this.TEMPLATE_STATEMENT_EXPECTED,[this._rootStatement]);if(null==rootStatement.content)return out.logError(rootStatement,this.EXPECTED_CONTAINER,[this._rootStatement]);var param;try{param=eval("("+rootStatement.paramBlock+")")}catch(e){return out.logError(rootStatement,this.ERROR_IN_TEMPLATE_PARAMETER,[this._rootStatement],e)}return ariaCoreJsonValidator.normalize({json:param,beanName:this._templateParamBean})?(out.templateParam=param,void this._processTemplateContent({out:out,statement:rootStatement})):out.logError(rootStatement,this.CHECK_ERROR_IN_TEMPLATE_PARAMETER,[this._rootStatement])},__processStatement:function(e,t){var r=t.name;"@"==r.charAt(0)&&(r="@");var i=this.STATEMENTS[r];if(null==i)e.logError(t,this.UNKNOWN_STATEMENT,[r]);else if(i.container===!0&&void 0===t.content)e.logError(t,this.EXPECTED_CONTAINER,[r]);else if(i.container===!1&&void 0!==t.content)e.logError(t,this.UNEXPECTED_CONTAINER,[r]);else if(void 0!==i.inMacro&&e.isOutputReady()!==i.inMacro)i.inMacro?e.logError(t,ariaTemplatesStatements.SHOULD_BE_IN_MACRO,[r]):e.logError(t,this.SHOULD_BE_OUT_OF_MACRO,[r]);else if(i.paramRegexp){var n=i.paramRegexp.exec(t.paramBlock);null==n?e.logError(t,this.INVALID_STATEMENT_SYNTAX,[r,i.paramRegexp]):(this._isDebug&&e.trackLine(t.lineNumber),i.process(e,t,n))}else this._isDebug&&e.trackLine(t.lineNumber),i.process(e,t,this)},__logError:function(e,t,r,i){null==r&&(r=[]),r.push(e.lineNumber),this.$logError(t,r,i)},_createBlocks:function(e){e.newBlock("classDefinition",0),e.newBlock("prototype",2),e.newBlock("globalVars",5),e.newBlock("initTemplate",3),e.newBlock("classInit",3)},_writeClassDefHeaders:function(e){var t=e.templateParam;e.writeln("Aria.classDefinition({"),e.increaseIndent(),e.writeln("$classpath: ",e.stringify(t.$classpath),","),e.parentClasspath&&e.writeln("$extends: ",e.stringify(e.parentClasspath),","),"JS"!=e.parentClassType&&e.writeln("$extendsType: ",e.stringify(e.parentClassType),",")},_getClassName:function(e){var t=e.split(".");return t[t.length-1]},_processInheritance:function(e){var t=e.templateParam;t.$extends?(e.parentClasspath=t.$extends,e.parentClassType=this._classType):e.parentClasspath=this._superClass,e.parentClasspath&&(e.parentClassName=this._getClassName(e.parentClasspath))},_processScript:function(e){var t=e.templateParam;t.$hasScript&&(e.scriptClasspath=t.$classpath+"Script",e.scriptClassName=this._getClassName(e.scriptClasspath),e.addDependency(e.scriptClasspath))},_writeConstructor:function(e){e.writeln("$constructor: function() { "),e.increaseIndent();var t=e.parentClassName;t&&e.writeln("this.$",t,".constructor.call(this);");var r=e.scriptClassName;r&&e.writeln("this.$",r,".constructor.call(this);"),e.decreaseIndent(),e.writeln("},")},_writeDestructor:function(e){e.writeln("$destructor: function() {"),e.increaseIndent();var t=e.scriptClassName;t&&e.writeln("this.$",t,".$destructor.call(this);");var r=e.parentClassName;r&&e.writeln("this.$",r,".$destructor.call(this);"),e.decreaseIndent(),e.writeln("},")},_writeDependencies:function(e){var t=e.templateParam,r=ariaUtilsJson;if(e.writeln(e.getDependencies()),t.$res&&e.writeln("$resources: ",r.convertToJsonString(t.$res),","),t.$templates&&e.writeln("$templates: ",r.convertToJsonString(t.$templates),","),t.$css&&e.writeln("$css: ",r.convertToJsonString(t.$css),","),t.$macrolibs){var i=ariaUtilsArray.extractValuesFromMap(t.$macrolibs);i.length>0&&e.writeln("$macrolibs: ",r.convertToJsonString(i),",")}if(t.$csslibs){var n=ariaUtilsArray.extractValuesFromMap(t.$csslibs);n.length>0&&e.writeln("$csslibs: ",r.convertToJsonString(n),",")}t.$texts&&e.writeln("$texts: ",r.convertToJsonString(t.$texts),",")},_writeMapInheritance:function(e,t,r,i){if(e.parentClassType==this._classType){if(r){var n=e.newVarName();e.writeln("var ",n," = {};"),e.writeln("Aria.copyObject(proto.",t,",",n,");"),e.writeln("Aria.copyObject(",ariaUtilsJson.convertToJsonString(r),",",n,");"),e.writeln("proto.",t," = ",n,";")}}else{var a=r?ariaUtilsJson.convertToJsonString(r):i;e.writeln("proto.",t," = ",a,";")}},_writeValueInheritance:function(e,t,r,i){if(e.parentClassType==this._classType)null!=r&&e.writeln("proto.",t," = ",ariaUtilsJson.convertToJsonString(r),";");else{var n=null!=r?ariaUtilsJson.convertToJsonString(r):i;e.writeln("proto.",t," = ",n,";")}},_writeClassInit:function(e){var t=e.scriptClasspath;t&&(e.enterBlock("classInit"),e.addDependencies(["aria.core.TplClassLoader"]),e.writeln("aria.core.TplClassLoader._importScriptPrototype("+t+",proto);"),e.leaveBlock());var r=e.getBlockContent("classInit");r.length>0&&(e.writeln("$init: function(proto) {"),e.increaseIndent(),e.write(r),e.decreaseIndent(),e.writeln("},"))},_writeInitTemplate:function(e){e.writeln("__$initTemplate: function() {"),e.increaseIndent(),e.parentClassType==this._classType&&e.writeln("if (! this.$",e.parentClassName,".__$initTemplate.call(this)) { return false; }"),e.write(e.getBlockContent("initTemplate"));var t=e.getBlockContent("globalVars");t.length>0&&(e.writeln("try {"),e.increaseIndent(),e.writeln("with (this) {"),e.increaseIndent(),e.write(t),e.decreaseIndent(),e.writeln("}"),e.decreaseIndent(),e.writeln("} catch (_ex) {"),e.increaseIndent(),e.writeln("this.$logError(this.EXCEPTION_IN_VARINIT,[this.$classpath],_ex);"),e.writeln("return false;"),e.decreaseIndent(),e.writeln("}")),e.writeln("return true;"),e.decreaseIndent(),e.writeln("}")},_writeClassDefEnd:function(e){e.writeln("$prototype: {"),e.increaseIndent(),e.write(e.getBlockContent("prototype")),e.decreaseIndent(),e.writeln("}"),e.decreaseIndent(),e.writeln("});"),e.writeln("var __filename = ",e.stringify(Aria.getLogicalPath(e.templateParam.$classpath,Aria.ACCEPTED_TYPES[this._classType])),";"),e.leaveBlock()},_processTemplateContent:function(e){var t=e.out,r=t.templateParam,i=e.statement;if(t.addDependencies(r.$dependencies),this._createBlocks(t),this._processInheritance(t),this._processScript(t),t.enterBlock("classDefinition"),this._writeClassDefHeaders(t),this._writeConstructor(t),this._writeDestructor(t),t.leaveBlock(),t.processContent(i.content),t.errors)return t.$dispose(),this.$callback(t.callback,{classDef:null,errors:t.errors}),void(t.errors=!1);t.enterBlock("prototype"),this._writeClassInit(t),this._writeInitTemplate(t),t.leaveBlock(),t.enterBlock("classDefinition"),this._writeDependencies(t),this._writeClassDefEnd(t),t.leaveBlock();var n=null;n=t.getBlockContent("classDefinition"),t.$dispose(),this.$callback(t.callback,{classDef:n,tree:t.tree,debug:t.debug})}}});
//*******************
//LOGICAL-PATH:aria/templates/CSSClassGenerator.js
//*******************
var e=require("../Aria"),t=require("./CSSParser"),r=require("./ClassGenerator");module.exports=e.classDefinition({$classpath:"aria.templates.CSSClassGenerator",$extends:r,$singleton:!0,$constructor:function(){this.$ClassGenerator.constructor.call(this),this._loadStatements(["CSSTemplate"]),this._parser=t,this._superClass="aria.templates.CSSTemplate",this._classType="CSS",this._rootStatement="CSSTemplate",this._templateParamBean="aria.templates.CfgBeans.CSSTemplateCfg"},$prototype:{_writeClassInit:function(e){e.enterBlock("classInit"),this._writeMapInheritance(e,"__$csslibs",e.templateParam.$csslibs,"{}"),this._writeValueInheritance(e,"__$prefix",e.templateParam.$prefix,"true"),e.leaveBlock(),this.$ClassGenerator._writeClassInit.call(this,e)}}});
//*******************
//LOGICAL-PATH:aria/core/loaders/CSSPreprocessor.js
//*******************
var e=require("./TplBasePreprocessor");module.exports=e(require("../../templates/CSSClassGenerator.js"));
//*******************
//LOGICAL-PATH:aria/templates/CmlClassGenerator.js
//*******************
var e=require("../Aria"),t=require("./CSSParser"),r=require("./CSSClassGenerator"),i=require("./ClassGenerator");module.exports=e.classDefinition({$classpath:"aria.templates.CmlClassGenerator",$extends:i,$singleton:!0,$constructor:function(){this.$ClassGenerator.constructor.call(this),this._loadStatements(["CSSLibrary"]),this._parser=t,this._superClass="aria.templates.CSSTemplate",this._classType="CML",this._rootStatement="CSSLibrary",this._templateParamBean="aria.templates.CfgBeans.CSSLibraryCfg"},$prototype:{_writeClassInit:function(e){r._writeClassInit.call(this,e)}}});
//*******************
//LOGICAL-PATH:aria/core/loaders/CmlPreprocessor.js
//*******************
var e=require("./TplBasePreprocessor");module.exports=e(require("../../templates/CmlClassGenerator.js"));
//*******************
//LOGICAL-PATH:aria/core/loaders/GeneralTplPreprocessor.js
//*******************
var e=require("noder-js/asyncRequire").create(module),t=/^\s*\/\*[\s\S]*?\*\//,r=/^\s*(?:var\s+|Aria\.classDefinition\()/,i=function(e){var t=e.replace(/^(.*\/)?([^/]*)$/,"$2"),r=t.indexOf(".");return r>-1?t.substr(r):""},n=function(e){return e=e.replace(t,""),r.test(e)},a={".tpl":"./TplPreprocessor",".tpl.css":"./CSSPreprocessor",".tpl.txt":"./TxtPreprocessor",".cml":"./CmlPreprocessor",".tml":"./TmlPreprocessor"};module.exports=function(t,r){var s=i(r),o=a[s];return!o||n(t)?t:e(o).spreadSync(function(e){return e(t,r)})};
//*******************
//LOGICAL-PATH:aria/templates/TplParser.js
//*******************
var e=require("../Aria"),t=require("./Parser");module.exports=e.classDefinition({$classpath:"aria.templates.TplParser",$extends:t,$singleton:!0,$prototype:{parseTemplate:function(e,t,r,i){return this.context=t,this._prepare(e,i),this._computeLineNumbers(),this._buildTree(i)}}});
//*******************
//LOGICAL-PATH:aria/widgetLibs/environment/WidgetLibsSettingsCfgBeans.js
//*******************
var e=require("../../Aria"),t=require("../../core/JsonTypes");module.exports=e.beanDefinitions({$package:"aria.widgetLibs.environment.WidgetLibsSettingsCfgBeans",$namespaces:{json:t},$beans:{AppCfg:{$type:"json:Object",$restricted:!1,$properties:{defaultWidgetLibs:{$type:"json:Map",$contentType:{$type:"json:PackageName"},$default:{aria:"aria.widgets.AriaLib"}}}}}});
//*******************
//LOGICAL-PATH:aria/widgetLibs/environment/WidgetLibsSettings.js
//*******************
var e=require("../../Aria");require("./WidgetLibsSettingsCfgBeans");var t=require("../../core/environment/EnvironmentBase");module.exports=e.classDefinition({$classpath:"aria.widgetLibs.environment.WidgetLibsSettings",$extends:t,$singleton:!0,$prototype:{_cfgPackage:"aria.widgetLibs.environment.WidgetLibsSettingsCfgBeans.AppCfg",getWidgetLibs:function(){var e=this.checkApplicationSettings("defaultWidgetLibs");return e}}});
//*******************
//LOGICAL-PATH:aria/templates/TplClassGenerator.js
//*******************
var e=require("../Aria"),t=require("./TplParser"),r=require("../widgetLibs/environment/WidgetLibsSettings"),i=require("./ClassGenerator");module.exports=e.classDefinition({$classpath:"aria.templates.TplClassGenerator",$extends:i,$singleton:!0,$constructor:function(){this.$ClassGenerator.constructor.call(this),this._loadStatements(["Template","id","on","createView","section","@","repeater"]),this._parser=t,this._superClass="aria.templates.Template",this._classType="TPL",this._rootStatement="Template",this._templateParamBean="aria.templates.CfgBeans.TemplateCfg",this.escapeModifier="escapeForHTML"},$prototype:{_writeClassInit:function(e){var t=e.templateParam;e.enterBlock("classInit"),this._writeMapInheritance(e,"__$macrolibs",e.templateParam.$macrolibs,"{}"),this._writeValueInheritance(e,"__$width",t.$width,"{}"),this._writeValueInheritance(e,"__$height",t.$height,"{}"),e.leaveBlock(),this.$ClassGenerator._writeClassInit.call(this,e)},_processTemplateContent:function(t){var i=t.out,n=i.templateParam,a=n.$wlibs,s=[],o=r.getWidgetLibs();for(var l in o)o.hasOwnProperty(l)&&null==a[l]&&(a[l]=o[l]);for(var l in a)a.hasOwnProperty(l)&&(i.allDependencies&&i.addDependency(a[l]),s.push(a[l]));e.load({classes:s,oncomplete:{fn:this.$ClassGenerator._processTemplateContent,scope:this,args:t}})}}});
//*******************
//LOGICAL-PATH:aria/templates/TmlClassGenerator.js
//*******************
var e=require("../Aria"),t=require("./TplParser"),r=require("./TplClassGenerator"),i=require("./ClassGenerator");module.exports=e.classDefinition({$classpath:"aria.templates.TmlClassGenerator",$extends:i,$singleton:!0,$constructor:function(){this.$ClassGenerator.constructor.call(this),this._loadStatements(["Library","id","on","createView","section","@","repeater"]),this._parser=t,this._superClass="aria.templates.Template",this._classType="TML",this._rootStatement="Library",this._templateParamBean="aria.templates.CfgBeans.LibraryCfg",this.escapeModifier="escapeForHTML"},$prototype:{$init:function(e){var t=r;e._processTemplateContent=t._processTemplateContent},_writeClassInit:function(e){e.enterBlock("classInit"),this._writeMapInheritance(e,"__$macrolibs",e.templateParam.$macrolibs,"{}"),e.leaveBlock(),this.$ClassGenerator._writeClassInit.call(this,e)}}});
//*******************
//LOGICAL-PATH:aria/core/loaders/TmlPreprocessor.js
//*******************
var e=require("./TplBasePreprocessor");module.exports=e(require("../../templates/TmlClassGenerator.js"));
//*******************
//LOGICAL-PATH:aria/core/loaders/TplPreprocessor.js
//*******************
var e=require("./TplBasePreprocessor");module.exports=e(require("../../templates/TplClassGenerator.js"));
//*******************
//LOGICAL-PATH:aria/core/environment/CustomizationsCfgBeans.js
//*******************
var e=require("../../Aria"),t=require("../JsonTypes");module.exports=e.beanDefinitions({$package:"aria.core.environment.CustomizationsCfgBeans",$namespaces:{json:t},$beans:{AppCfg:{$type:"json:Object",$restricted:!1,$properties:{customization:{$type:"CustomizationCfg",$default:{}}}},CustomizationCfg:{$type:"json:Object",$properties:{descriptor:{$type:"json:MultiTypes",$default:"",$contentTypes:[{$type:"json:ObjectRef"},{$type:"json:String"}]}}},DescriptorCfg:{$type:"json:Object",$properties:{templates:{$type:"json:Map",$default:{},$keyType:{$type:"json:PackageName"},$contentType:{$type:"json:PackageName"}},modules:{$type:"json:Map",$default:{},$keyType:{$type:"json:PackageName"},$contentType:{$type:"json:Array",$contentType:{$type:"CustomModuleCfg"}}},flows:{$type:"json:Map",$default:{},$keyType:{$type:"json:PackageName"},$contentType:{$type:"json:PackageName"}}}},CustomModuleCfg:{$type:"json:MultiTypes",$contentTypes:[{$type:"json:String"},{$type:"json:Object",$properties:{classpath:{$type:"json:PackageName"},refpath:{$type:"json:String",$regExp:/^custom:/},initArgs:{$type:"json:ObjectRef"}}}]}}});
//*******************
//LOGICAL-PATH:aria/core/environment/Customizations.js
//*******************
var e=require("../../Aria");require("./CustomizationsCfgBeans");var t=require("./EnvironmentBase"),r=require("../../utils/Type"),i=require("../../utils/Json"),n=require("../IO"),a=require("../JsonValidator");module.exports=e.classDefinition({$classpath:"aria.core.environment.Customizations",$extends:t,$singleton:!0,$statics:{DESCRIPTOR_NOT_LOADED:"A customization descriptor was specified but could not be loaded (url: '%1')",INVALID_DESCRIPTOR:"The Customization descriptor at '%1' is invalid"},$events:{descriptorLoaded:""},$constructor:function(){this._isCustomized=!1,this._descriptorLoaded=!1,this._customizationDescriptor=null,this._customizations={templates:{},modules:{}},this.$EnvironmentBase.constructor.call(this)},$prototype:{_cfgPackage:"aria.core.environment.CustomizationsCfgBeans.AppCfg",_applyEnvironment:function(e){var t=this.checkApplicationSettings("customization");t&&(t.descriptor!==this._customizationDescriptor||r.isObject(t.descriptor))&&(this._customizationDescriptor=t.descriptor,this.reloadCustomizationDescriptor()),this.$callback(e)},_onDescriptorReceive:function(e){var t="200"!=e.status;if(t)this.$logError(this.DESCRIPTOR_NOT_LOADED,this._customizationDescriptor);else{var r=i.load(e.responseText);if(null==r)return this.$logError(this.INVALID_DESCRIPTOR,this._customizationDescriptor),void this.$raiseEvent("descriptorLoaded");this._setCustomizationDescriptor(r)}this._descriptorLoaded=!0,this.$raiseEvent("descriptorLoaded")},_setCustomizationDescriptor:function(e){var t=a.normalize({json:e,beanName:"aria.core.environment.CustomizationsCfgBeans.DescriptorCfg"});t?this._customizations=e:this.$logError(this.INVALID_DESCRIPTOR,this._customizationDescriptor)},reloadCustomizationDescriptor:function(){this._isCustomized=this._customizationDescriptor?!0:!1,this._isCustomized&&(this._descriptorLoaded=!1,r.isString(this._customizationDescriptor)?n.asyncRequest({url:this._customizationDescriptor,callback:{fn:this._onDescriptorReceive,onerror:this._onDescriptorReceive,scope:this}}):(this._setCustomizationDescriptor(this._customizationDescriptor),this._descriptorLoaded=!0,this.$raiseEvent("descriptorLoaded")))},isCustomized:function(){return this._isCustomized},descriptorLoaded:function(){return this._descriptorLoaded},getFlowCP:function(e){var t=e;return this._isCustomized&&null!=this._customizations.flows[e]&&(t=this._customizations.flows[e]),t},getCustomModules:function(e){if(this._isCustomized){var t=this._customizations.modules[e];if(t)return t}return[]},getCustomizations:function(){return i.copy(this._customizations)},getTemplateCP:function(e){var t=e;return this._isCustomized&&null!=this._customizations.templates[e]&&(t=this._customizations.templates[e]),t},setCustomizations:function(e){var t=this.checkApplicationSettings("customization");t.descriptor=e,this._customizationDescriptor=e,this.reloadCustomizationDescriptor()}}});
//*******************
//LOGICAL-PATH:aria/templates/$Template.js
//*******************
var e=require("../core/AppEnvironment"),t=require("noder-js/asyncRequire").create(module),r=e.applicationSettings.contextualMenu,i=r&&r.enabled,n=function(){};n.$preload=function(){return i?t("../tools/contextual/ContextualMenu"):void 0},module.exports={load:n};
//*******************
//LOGICAL-PATH:aria/templates/BaseCtxt.js
//*******************
var e=require("../Aria");module.exports=e.classDefinition({$classpath:"aria.templates.BaseCtxt",$singleton:!1,$constructor:function(){this._cfg=null,this._out=null,this._tpl=null,this._macrolibs=[],this._csslibs=[]},$destructor:function(){(this._macrolibs||this._csslibs)&&(this.__disposeLibs(this._macrolibs),this.__disposeLibs(this._csslibs),this._macrolibs=null,this._csslibs=null)},$statics:{TEMPLATE_CONSTR_ERROR:"Error while creating a new instance of template '%1' - please check script constructor.",TEMPLATE_DESTR_ERROR:"Error while destroying an instance of template '%1' - please check script destructor.",MACRO_NOT_FOUND:"Missing macro '%1' in template '%2'.",MACRO_CALL_ERROR:"Error while calling macro '%1' in template '%2'.",LIBRARY_HANDLE_CONFLICT:"Template error: can't load shared macro library '%1'. A macro, text template, variable or another library has already been declared with the same name.",LIBRARY_ALREADY_LOADED:"Template error: library at classpath '%1' has already been loaded."},$prototype:{checkMacro:function(e){return null==e?this._cfg.macro:("string"==typeof e?e={name:e,args:[],scope:this._tpl}:(null==e.args&&(e.args=[]),null==e.scope&&(e.scope=this._tpl)),e)},_callMacro:function(e,t){this.$assert(62,null!=this._out),t=this.checkMacro(t);var r=t.scope,i=r["macro_"+t.name];null==i&&this.$logError(this.MACRO_NOT_FOUND,[t.name,r.$classpath]);try{i.apply(r,t.args)}catch(n){this.$logError(this.MACRO_CALL_ERROR,[t.name,r.$classpath],n)}},__loadLibs:function(t,r){if(this.$assert(134,"macrolibs"==r||"csslibs"==r),"macrolibs"==r)var i=this._macrolibs,n="__$macrolibs",a=aria.templates.TemplateCtxt,s=aria.templates.ITemplate;else if("csslibs"==r)var i=this._csslibs,n="__$csslibs",a=aria.templates.CSSCtxt,s=aria.templates.ICSS;var o={},l=0;for(var c in t)if(t.hasOwnProperty(c)){if(void 0!==this._tpl[c]){delete t[c],this.$logError(this.LIBRARY_HANDLE_CONFLICT,[c]);continue}if(o[t[c]]){this.$logWarn(this.LIBRARY_ALREADY_LOADED,[c]);continue}o[t[c]]=!0,l++}if(0!==l)for(var c in t)if(t.hasOwnProperty(c)){this._tpl[c]=e.getClassInstance(t[c]),this._tpl[c].__$write=this._tpl.__$write;var u=new a;u._tpl=this._tpl[c],i.push(u),s.call(this._tpl[c],u),u._tpl.__$initTemplate(),u.__loadLibs(u._tpl[n],r)}},__disposeLibs:function(e){for(var t=0;t<e.length;t++){var r=e[t];aria.templates.ITemplate&&aria.templates.ITemplate.prototype.$destructor.call(r._tpl),r.$dispose()}}}});
//*******************
//LOGICAL-PATH:aria/templates/IBaseTemplate.js
//*******************
var e=require("../Aria");module.exports=e.interfaceDefinition({$classpath:"aria.templates.IBaseTemplate",$events:{},$interface:{__$write:function(){}}});
//*******************
//LOGICAL-PATH:aria/templates/BaseTemplate.js
//*******************
var e=require("../Aria"),t=require("./Modifiers"),r=require("./IBaseTemplate"),i=require("../utils/Json");module.exports=e.classDefinition({$classpath:"aria.templates.BaseTemplate",$destructor:function(){},$statics:{EXCEPTION_IN_MACRO:"file %2, line %3: Uncaught exception in macro '%1'",EXCEPTION_IN_VARINIT:"Uncaught exception when initializing global variables in template '%0'.",ITERABLE_UNDEFINED:"file %2, line %3: Template error: cannot iterate over a null or undefined variable.",EXCEPTION_IN_EXPRESSION:"file %2, line %3: Uncaught runtime exception in expression '%1'",EXCEPTION_IN_VAR_EXPRESSION:"file %2, line %3: Uncaught runtime exception in var expression '%1'",EXCEPTION_IN_SET_EXPRESSION:"file %2, line %3: Uncaught runtime exception in set expression '%1'",EXCEPTION_IN_CHECKDEFAULT_EXPRESSION:"file %2, line %3: Uncaught runtime exception in checkdefault expression '%1'",MACRO_NOT_FOUND:"file %1, line %2: Template error: macro '%3' is not defined."},$prototype:{$json:i,$init:function(e){var i=r.prototype;for(var n in i)i.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=i[n]);e.$modifier=t.callModifier}}});
//*******************
//LOGICAL-PATH:aria/templates/ICSS.js
//*******************
var e=require("../Aria"),t=require("./IBaseTemplate");module.exports=e.interfaceDefinition({$classpath:"aria.templates.ICSS",$extends:t,$events:{},$interface:{prefix:"Object"}});
//*******************
//LOGICAL-PATH:aria/templates/CSSCtxt.js
//*******************
var e=require("../Aria");require("./CfgBeans");var t=require("../utils/String"),r=require("../utils/Function"),i=require("./ICSS"),n=require("./BaseCtxt"),a=require("../core/JsonValidator"),s=require("../core/AppEnvironment");module.exports=e.classDefinition({$classpath:"aria.templates.CSSCtxt",$implements:[i],$extends:n,$constructor:function(){this.$BaseCtxt.constructor.apply(this,arguments),this.tplClasspath=null,this.__cachedOutput=null,this.__prefix="",this.__prefixedText="",this.__numSelectors=0/0},$destructor:function(){if(this._tpl){try{this._tpl.$dispose()}catch(e){this.$logError(this.TEMPLATE_DESTR_ERROR,[this.tplClasspath],e)}i.prototype.$destructor.call(this._tpl),this._tpl=null}this.data=null,this.moduleRes=null,this.moduleCtrl=null,this.moduleCtrlPrivate=null,this.$BaseCtxt.$destructor.call(this)},$statics:{MEDIA_RULE:/@media\b/},$prototype:{initTemplate:function(t){if(!a.normalize({json:t,beanName:"aria.templates.CfgBeans.InitCSSTemplateCfg"}))return!1;this._cfg=t;var r=e.getClassInstance(t.classpath);if(!r)return this.$logError(this.TEMPLATE_CONSTR_ERROR,[t.classpath]),!1;this._tpl=r,t.macro=this.checkMacro({name:"main",args:t.args}),this.tplClasspath=t.classpath,i.call(r,this);var n=this;return r.__$write=function(){return n.__$write.apply(n,arguments)},r.__$initTemplate()?(this.__loadLibs(r.__$csslibs,"csslibs"),!0):!1},doPrefixing:function(){return this._tpl.__$prefix?!this._cfg.isWidget:void 0},isWidget:function(){return this._cfg.isWidget},isTemplate:function(){return this._cfg.isTemplate},_getOutput:function(){if(this.__cachedOutput)return this.__cachedOutput;this.$assert(156,null==this._out),this._out=[],this._callMacro(null,"main");var e=this._out.join("");return s.applicationSettings.hasOwnProperty("imgUrlMapping")&&null!==s.applicationSettings.imgUrlMapping&&(e=this._prefixCSSImgUrl(e)),this._out=null,this.__cachedOutput=e,e},prefixText:function(e){var t=this._getOutput(),r="."+e+" ",i=this.__prefixingAlgorithm(t,r);this.__prefixedText=i.text,this.__numSelectors=i.selectors},_prefixCSSImgUrl:function(e){return e=e.replace(/\burl\s*\(\s*["']?([^"'\r\n,]+|[^'\r\n,]+|[^"\r\n,]+)["']?\s*\)/gi,r.bind(function(e,t){var r=s.applicationSettings.imgUrlMapping(t,this.tplClasspath);return this._parseImgUrl(r)},this))},_parseImgUrl:function(e){return'url ("'+e+'")'},_cleanUrl:function(e){var t=e.replace(/\burl\s*/gi,"");return t="("===t.charAt(0)?t.substring(1,t.length-1):t,t="'"===t.charAt(0)||'"'===t.charAt(0)?t.substring(1,t.length-1):t},__prefixingAlgorithm:function(e,r){var i=e.split("}"),n=i.length;if(2>n)return{text:e,selectors:0};for(var a,s,o,l=t.trim,c=this.MEDIA_RULE,u=0,h=0;n>h;h+=1)if(a=i[h].split("{"),s=l(a[0])){var p=c.test(s);if(!p||(a[0]=s,s=l(a[1]))){s=s.split(","),o=[];for(var d=0,m=s.length;m>d;d+=1)o.push(r+l(s[d])),u+=1;p?(o[0]="\n"+o[0],a[1]=o.join(", ")):a[0]=o.join(", "),i[h]=a.join(" {")}}return{text:i.join("}\n"),selectors:u}},getText:function(){return this.doPrefixing()?this.__prefixedText:this._getOutput()},getNumLines:function(){return this.__numSelectors},__$write:function(e){this._out=this._out.concat(e)}}});
//*******************
//LOGICAL-PATH:aria/templates/CSSCtxtManager.js
//*******************
var e=require("../Aria");module.exports=e.classDefinition({$classpath:"aria.templates.CSSCtxtManager",$singleton:!0,$constructor:function(){this._contexts={}},$destructor:function(){this.reset()},$prototype:{getContext:function(e,t){var r=this._contexts[e];return r||(r=new(require("./CSSCtxt")),t||(t={}),t.classpath=e,r.initTemplate(t),this._contexts[e]=r),r},disposeContext:function(e){var t=this._contexts[e];t&&(t.$dispose(),delete this._contexts[e])},reset:function(){var e=[],t=this._contexts;for(var r in t)t.hasOwnProperty(r)&&(e.push(r),t[r].$dispose());return this._contexts={},e}}});
//*******************
//LOGICAL-PATH:aria/templates/CSSMgr.js
//*******************
var e=require("../Aria"),t=require("./CSSCtxtManager"),r=require("../utils/Array"),i=require("../utils/Object"),n=require("../utils/AriaWindow"),a=require("../core/ClassMgr"),s=require("../utils/Dom");module.exports=e.classDefinition({$classpath:"aria.templates.CSSMgr",$singleton:!0,$statics:{__NEXT_PREFIX_INDEX:0,__PREFIX:"CSS",__NEXT_TAG_INDEX:1,__TAG_PREFX:"xCss",CSSTEMPLATE_MAX_SELECTORS_REACHED:"More than 4000 CSS selectors are loaded at the same time. Please check your CSS Templates",DEPRECATED_METHOD:"%1 is deprecated."},$events:{dependenciesLoaded:"",dependenciesUnloaded:"",styleChange:""},$constructor:function(){this.__cssUsage={},this.__globalUsage={},this.__prefixes={},this.__pathsLoaded=[],this.__textLoaded={},this.__styleTagAssociation={},this.__styleTagPool={},this.__cssDependencies={},this.__invalidClasspaths={},this.__invalidStack=[],this.__isStopped=!1,this.__queuedChanges=[],this.__attachedToWindow=!1,n.$on({unloadWindow:this.reset,scope:this})},$destructor:function(){this.reset(),this.__styleTagPool=null,n.$unregisterListeners(this)},$prototype:{__checkAttachedToWindow:function(){this.__attachedToWindow||(this.__attachedToWindow=!0,n.attachWindow())},loadDependencies:function(e){this.$assert(133,e.$TemplateCtxt);var t=e.getCSSDependencies(),r=e.tplClasspath,i=this.loadClassPathDependencies(r,t,{isTemplate:!0});return i.changes&&this.$raiseEvent({name:"styleChange",templateClasspath:r}),this.$raiseEvent({name:"dependenciesLoaded",templateClasspath:r}),i.classes},loadWidgetDependencies:function(t,r){if(this.__cssDependencies[t])r=this.__cssDependencies[t];else{var n=e.getClassRef(t),a={};if(r)for(var s=0,o=r.length;o>s;s++)a[e.getClasspath(r[s])]=!0;for(n=n.superclass;n;){var l=n.$css;if(l)for(var s=0,o=l.length;o>s;s++)a[e.getClasspath(l[s])]=!0;n=n.constructor.superclass}r=i.keys(a),this.__cssDependencies[t]=r}var c={isWidget:!0};this.loadClassPathDependencies(t,r,c)},loadClassPathDependencies:function(t,r,i){if(r){for(var n=[],a=[],s=0,o=r.length;o>s;s+=1){var l=e.getClasspath(r[s]),c={};for(var u in i)i.hasOwnProperty(u)&&(c[u]=i[u]);n=this.__load(t,l,c).concat(n),this.__prefixes[l]&&a.push(this.__prefixes[l])}return n.length&&this.__textToDOM(n),{classes:a,changes:!!n.length}}},__load:function(e,r,i){this.$assert(195,e&&r);var n=this.__cssUsage[r];if(n&&n.length){if(n.push(e),this.__pathsLoaded.push(r),!this.__invalidClasspaths[r])return[]}else this.__cssUsage[r]=[e];delete this.__invalidClasspaths[r];var a=t.getContext(r,i);if(("aria.templates.GlobalStyle"==r||"aria.templates.LegacyGeneralStyle"==r||"aria.widgets.GlobalStyle"==r)&&this.__getPrefix(r),a.doPrefixing()){var s=this.__getPrefix(r);a.prefixText(s)}this.__textLoaded[r]={text:a.getText(),lines:a.getNumLines()};var o=this.__getStyleTag(a);return this.__styleTagAssociation[r]=o,this.__pathsLoaded.push(r),[o]},__getStyleTag:function(e){var t=e.tplClasspath,r=this.__styleTagAssociation[t];return r?r:(e.isTemplate()?r="tpl":e.isWidget()?r="wgt":(r="pool"+this.__NEXT_TAG_INDEX,this.__NEXT_TAG_INDEX+=1),r)},unloadWidgetDependencies:function(e,t){this.__cssDependencies[e]&&(t=this.__cssDependencies[e]),this.unloadClassPathDependencies(e,t)},unloadClassPathDependencies:function(t,r){if(r)for(var i=0,n=r.length;n>i;i+=1){var a=e.getClasspath(r[i]);this.__unload(t,a)}},unloadDependencies:function(e){this.$assert(169,e.$TemplateCtxt);var t=e.getCSSDependencies(),r=e.tplClasspath;this.unloadClassPathDependencies(r,t),this.$raiseEvent({name:"dependenciesUnloaded",templateClasspath:r})},__getPrefix:function(e){var t=this.__prefixes[e];return t||(t=this.__PREFIX+this.__NEXT_PREFIX_INDEX,this.__NEXT_PREFIX_INDEX+=1,this.__prefixes[e]=t),t},__unload:function(e,t){this.$assert(230,e&&t);var i=r.remove,n=this.__cssUsage[t];n&&n.length&&(i(n,e),i(this.__pathsLoaded,t),n.length||(delete this.__cssUsage[t],delete this.__textLoaded[t]))},__textToDOM:function(e){if(this.__isStopped)return void(this.__queuedChanges=e.concat(this.__queuedChanges));for(var t=this.__sortPaths(),i=0,n={},a=r,s=0,o=t.length;o>s;s+=1){var l=t[s],c=this.__styleTagAssociation[l];a.contains(e,c)&&(n[c]||(n[c]=[]),n[c].push("/**",l,"**/",this.__textLoaded[l].text),i+=this.__textLoaded[l].lines||0)}return i>4e3&&this.$logWarn(this.CSSTEMPLATE_MAX_SELECTORS_REACHED),this.__reloadStyleTags(n)},__sortPaths:function(){var e=i.keys(this.__textLoaded),t=this.__prefixes,r=this.__PREFIX.length,n=function(e,i){var n=t[e]?parseInt(t[e].substring(r),10):Number.MAX_VALUE,a=t[i]?parseInt(t[i].substring(r),10):Number.MAX_VALUE;return n===a?0:n>a?1:-1},a=e.sort(n);return t=null,r=null,a},__reloadStyleTags:function(t){for(var r in t)if(t.hasOwnProperty(r)){var i=this.__buildStyleIfMissing(r),n=t[r].join("\n");if(i.styleSheet)i.styleSheet.cssText!=n&&(i.styleSheet.cssText=n);else{var a;i.firstChild?i.firstChild.nodeValue!=n&&(a=e.$window.document.createTextNode(n),i.replaceChild(a,i.firstChild)):(a=e.$window.document.createTextNode(n),i.appendChild(a))}i=null}},__buildStyleIfMissing:function(t){var r=this.__styleTagPool[t];if(!r){var i=this.__TAG_PREFX+t;if(r=s.getElementById(i),!r){var n=e.$window.document,a=n.getElementsByTagName("head")[0];r=n.createElement("style"),r.id=i,r.type="text/css",r.media="all",a.appendChild(r),r=a.lastChild}this.__styleTagPool[t]=r}return r},reset:function(){for(var e in this.__styleTagPool)this.__styleTagPool.hasOwnProperty(e)&&this.__styleTagPool[e].parentNode.removeChild(this.__styleTagPool[e]);this.__attachedToWindow&&(n.detachWindow(),this.__attachedToWindow=!1),this.__styleTagPool={},this.__textLoaded={},this.__pathsLoaded=[],this.__prefixes={},this.__cssUsage={},this.__styleTagAssociation={},this.__invalidClasspaths={},this.__cssDependencies={},this.__PREFIX=this.classDefinition.$statics.__PREFIX,this.__NEXT_PREFIX_INDEX=this.classDefinition.$statics.__NEXT_PREFIX_INDEX,this.__NEXT_TAG_INDEX=this.classDefinition.$statics.__NEXT_TAG_INDEX,this.__TAG_PREFX=this.classDefinition.$statics.__TAG_PREFX},invalidate:function(e,r){t.disposeContext(e),!this.__invalidClasspaths[e]&&r&&(this.__invalidClasspaths[e]=!0,this.__invalidStack.push(e))},stop:function(){this.__isStopped=!0},resume:function(){this.__isStopped=!1;var e=this.__queuedChanges;return this.__queuedChanges=[],e.length>0?this.__textToDOM(e):void 0},registerDependencies:function(t,r){for(var i=0,n=r.length;n>i;i++){var a=e.getClasspath(r[i]);this.__globalUsage[a]||(this.__globalUsage[a]=[]),this.__globalUsage[a].push(t)}},unregisterDependencies:function(t,i,n,s){for(var o=r,l=a,c=0,u=i.length;u>c;c++){var h=e.getClasspath(i[c]),p=this.__globalUsage[h];o.remove(p,t),n&&(l.unloadClass(h,s),this.invalidate(h,p.length>0))}},getInvalidClasspaths:function(e){var t=this.__invalidStack;return e&&(this.__invalidStack=[]),t}}});
//*******************
//LOGICAL-PATH:aria/templates/CSSTemplate.js
//*******************
var e=require("../Aria"),t=require("../core/DownloadMgr");require("./CSSMgr"),module.exports=e.classDefinition({$classpath:"aria.templates.CSSTemplate",$extends:require("./BaseTemplate"),$constructor:function(){this.$BaseTemplate.constructor.call(this);var e=this.$classpath.replace(/\./g,"/");this.cssPath="/"+e;var r=t.resolveURL(e+".tpl.css",!0);this.cssFolderPath=r.substring(0,r.lastIndexOf("/"))},$prototype:{$init:function(e,t){e.$BaseTemplate.constructor.classDefinition.$prototype.$init(e,t);var r=require("./ICSS").prototype;for(var i in r)r.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(e[i]=r[i])}}});
//*******************
//LOGICAL-PATH:aria/templates/DomElementWrapper.js
//*******************
var e=require("../Aria"),t=require("../utils/Dom"),r=require("../utils/DomOverlay"),i=require("../utils/ClassList"),a=require("../utils/sandbox/DOMProperties");module.exports=e.classDefinition({$classpath:"aria.templates.DomElementWrapper",$constructor:function(n,s){if(n&&n.nodeType)for(;1!=n.nodeType;)n=n.parentNode;var o=n.tagName;this.tagName=o,this.getChild=function(e){var r=t.getDomElementChild(n,e);return r?new aria.templates.DomElementWrapper(r):null},this.getAttribute=function(e){if(!this.attributesWhiteList.test(e))return this.$logError(this.INVALID_ATTRIBUTE_NAME,[e]),null;var t=n.attributes[e];return t?t.value:null},this.setAttribute=function(e,t){var r=!this.attributesWhiteList.test(e)||"type"==e&&"INPUT"==n.tagName;r?this.$logError(this.ATTRIBUTE_WRITE_DENIED,[e]):n.setAttribute(e,t)},this.getData=function(e,t){if(!this.expandoNameRegex.test(e)||"_"==e.charAt(0))return this.$logError(this.INVALID_EXPANDO_NAME,[e]),null;var r="data-"+e,i=n.attributes[r];if(!i&&t)for(var a=n.parentNode;!i&&null!=a&&null!=a.attributes;)i=a.attributes[r],a=a.parentNode;return i?i.value:null},this.getParentWithData=function(e){if(!this.expandoNameRegex.test(e)||"_"==e.charAt(0))return this.$logError(this.INVALID_EXPANDO_NAME,[e]),null;for(var t="data-"+e,r=n,i=r.attributes[t];!i&&null!=r.parentNode;)r=r.parentNode,r.attributes&&(i=r.attributes[t]);return i?new aria.templates.DomElementWrapper(r):null},this.classList=new i(n),this.focus=function(){try{return n.focus()}catch(e){this.$logDebug(this.FOCUS_FAILURE,n)}},this.setStyle=function(e){n.style.cssText=e},this.getProperty=function(e){return a.isReadSafe(o,e)?n[e]:void this.$logError(this.READ_ACCESS_DENIED,[e,o])},this.setProperty=function(e,t){a.isWriteSafe(o,e)?n[e]=t:this.$logError(this.WRITE_ACCESS_DENIED,[e,o])},this.getParentWithName=function(t){if(!t||!n)return null;var r=e.$window.document.body;t=t.toUpperCase();for(var i=n.parentNode;i&&i!=r;){if(i.nodeName==t)return new aria.templates.DomElementWrapper(i);i=i.parentNode}return null},this.setProcessingIndicator=function(e,t){var i,a=!0;e?i=r.create(n,t):(i=r.detachFrom(n,t),i||(a=!1)),s&&a&&s.registerProcessingIndicator(e,i)},this.scrollIntoView=function(e){t.scrollIntoView(n,e)},this.getScroll=function(){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}},this.setScroll=function(e){e&&(e.hasOwnProperty("scrollLeft")&&null!=e.scrollLeft&&(n.scrollLeft=e.scrollLeft),e.hasOwnProperty("scrollTop")&&null!=e.scrollTop&&(n.scrollTop=e.scrollTop))},this._dispose=function(){this.setProcessingIndicator(!1),n=null,s=null,this.getChild=null,this.classList.$dispose(),this.getData=null,this.getAttribute=null,this.getProperty=null,this.setProperty=null,this.focus=null,this.setStyle=null,this.getParentWithName=null,this.getParentWithData=null,this.setProcessingIndicator=null}},$destructor:function(){this._dispose&&(this._dispose(),this._dispose=null)},$statics:{attributesWhiteList:/^(data\-\w+(?:\-\w+)*|aria\-[a-z]+|name|title|style|dir|lang|abbr|height|width|size|cols|rows|rowspan|colspan|nowrap|valign|align|border|cellpadding|cellspacing|disabled|readonly|checked|selected|multiple|value|alt|maxlength|type|accesskey|tabindex|placeholder|autocomplete|autofocus|autocorrect|autocapitalize|spellcheck)$/,expandoNameRegex:/^\w+(?:\-\w+)*$/,INVALID_EXPANDO_NAME:"Invalid expando name: '%1'.",INVALID_ATTRIBUTE_NAME:"Invalid attribute name: '%1'.",ATTRIBUTE_WRITE_DENIED:"Write access to attribute '%1' is not allowed.",FOCUS_FAILURE:"Could not focus element",READ_ACCESS_DENIED:"Access to property %1 of tag %2 is not allowed.",WRITE_ACCESS_DENIED:"Write access to property %1 of tag %2 is not allowed."},$prototype:{getChild:function(){},getAttribute:function(){},setAttribute:function(){},getData:function(){},getParentWithData:function(){},focus:function(){},setStyle:function(){},getValue:function(){return this.getProperty("value")},setValue:function(e){this.setProperty("value",e)},_dispose:function(){},getParentWithName:function(){},setProcessingIndicator:function(){},scrollIntoView:function(){},getScroll:function(){},setScroll:function(){}}});
//*******************
//LOGICAL-PATH:aria/templates/DomEventWrapper.js
//*******************
var e=require("../Aria"),t=require("./DomElementWrapper"),r=require("../DomEvent");module.exports=e.classDefinition({$classpath:"aria.templates.DomEventWrapper",$extends:r,$constructor:function(e){var r=t;this.$DomEvent.constructor.call(this,e),this.target=this.target?new r(this.target):null,this.relatedTarget=this.relatedTarget?new r(this.relatedTarget):null},$destructor:function(){this.target&&(this.target.$dispose(),this.target=null),this.relatedTarget&&(this.relatedTarget.$dispose(),this.relatedTarget=null),this.$DomEvent.$destructor.call(this)},$prototype:{setTarget:function(e){this.target&&this.target.$dispose(),this.target=e?new t(e):null}}});
//*******************
//LOGICAL-PATH:aria/templates/IFlowCtrl.js
//*******************
var e=require("../Aria");module.exports=e.interfaceDefinition({$classpath:"aria.templates.IFlowCtrl",$interface:{}});
//*******************
//LOGICAL-PATH:aria/templates/PublicWrapper.js
//*******************
var e=require("../Aria");module.exports=e.classDefinition({$classpath:"aria.templates.PublicWrapper",$prototype:{$publicInterfaceName:null,$publicInterface:function(){return this.$interface(this.$publicInterfaceName)}}});
//*******************
//LOGICAL-PATH:aria/templates/FlowCtrl.js
//*******************
var e=require("../Aria"),t=require("./IFlowCtrl");require("../utils/String");var r=require("./PublicWrapper");module.exports=e.classDefinition({$classpath:"aria.templates.FlowCtrl",$extends:r,$implements:[t],$constructor:function(){this.$PublicWrapper.constructor.call(this)},$destructor:function(){this.moduleCtrl=null,this.data=null,this.$PublicWrapper.$destructor.call(this)},$prototype:{$publicInterfaceName:"aria.templates.IFlowCtrl",setModuleCtrl:function(e){this.moduleCtrl=e},oninitCallback:function(){this.data=this.moduleCtrl.getData()}}});
//*******************
//LOGICAL-PATH:aria/templates/GlobalStyle.tpl.css
//*******************
Aria.classDefinition({$classpath:"aria.templates.GlobalStyle",$extends:"aria.templates.CSSTemplate",$constructor:function(){this.$CSSTemplate.constructor.call(this)},$destructor:function(){this.$CSSTemplate.$destructor.call(this)},$prototype:{macro_main:function(){try{with(this)this.__$write("\n\n.xLDI-text {\nposition: relative;\ntop: 50%;\ndisplay:block;\ntext-align:center;\npadding-top: 20px;\n}\n\n.xLDI {\n\nbackground-color: #fff;\n",22),this.macro_opacity(80),this.__$write("\nwidth: 100%;\nheight: 100%;\noverflow: hidden;\n}\n\n.xOverlay {\n\nbackground-color: #ddd;\nborder: 1px solid black;\n",35),this.macro_opacity(40),this.__$write("\n}\n\n.xModalMask-default {\nwidth:100%;\nheight:100%;\nbackground-color: black;\n",45),this.macro_opacity(40),this.__$write("\n}\n\n.xOverflowAuto {\noverflow: auto;\n}\n\n.xOverflowHidden {\noverflow: hidden;\n}\n\n.xOverflowXAuto {\noverflow-x: auto;\n}\n\n.xOverflowYAuto {\noverflow-y: auto;\n}\n\n.xOverflowXScroll {\noverflow-x: scroll;\n}\n\n.xOverflowYScroll {\noverflow-y: scroll;\n}\n\n.xOverflowXHidden {\noverflow-x: hidden;\n}\n\n.xOverflowYHidden {\noverflow-y: hidden;\n}\n\n\n.xTplContent {\n}\n\n",52)}catch(_ex){this.$logError(this.EXCEPTION_IN_MACRO,["main",__filename,this["aria:currentLineNumber"]],_ex)}},macro_opacity:function(percent){try{with(this)this.__$write("\nfilter: alpha(opacity=",93),this.__$write(percent,93),this.__$write(");\n-moz-opacity: ",93),this.__$write(percent/100,94),this.__$write(";\nopacity: ",94),this.__$write(percent/100,95),this.__$write(";\n",95)}catch(_ex){this.$logError(this.EXCEPTION_IN_MACRO,["opacity",__filename,this["aria:currentLineNumber"]],_ex)}},$init:function(e){e.__$csslibs={},e.__$prefix=!0},__$initTemplate:function(){return!0}}});var __filename="ariatemplates/templates/GlobalStyle.tpl.css";
//*******************
//LOGICAL-PATH:aria/templates/IModuleCtrl.js
//*******************
var e=require("../Aria");module.exports=e.interfaceDefinition({$classpath:"aria.templates.IModuleCtrl",$events:{methodCallBegin:"",methodCallEnd:"",methodCallback:"",beforeDispose:""},$interface:{init:{$type:"Function",$callbackParam:1},getData:function(){},setData:function(){},getResourceSet:function(){},getSubModuleCtrl:function(){},registerListener:function(){},unregisterListeners:function(){},setSession:function(){}}});
//*******************
//LOGICAL-PATH:aria/templates/IObjectLoading.js
//*******************
var e=require("../Aria");module.exports=e.interfaceDefinition({$classpath:"aria.templates.IObjectLoading",$events:{objectLoaded:""},$interface:{}});
//*******************
//LOGICAL-PATH:aria/templates/ITemplate.js
//*******************
var e=require("../Aria"),t=require("./IBaseTemplate");module.exports=e.interfaceDefinition({$classpath:"aria.templates.ITemplate",$extends:t,$events:{SectionRefreshed:""},$interface:{data:"Object",moduleCtrl:"Object",flowCtrl:"Object",moduleRes:"Object",$refresh:function(){},$getChild:function(){},$getElementById:function(){},$focus:function(){},$getFocusedWidget:function(){},$setFocusedWidget:function(){},$hdim:function(){},$vdim:function(){},$getId:function(){},getContainerScroll:function(){},setContainerScroll:function(){},__$writeId:function(){},__$processWidgetMarkup:function(){},__$beginContainerWidget:function(){},__$endContainerWidget:function(){},__$statementOnEvent:function(){},__$statementRepeater:function(){},__$createView:function(){},__$insertSection:function(){}}});
//*******************
//LOGICAL-PATH:aria/templates/ITemplateCtxt.js
//*******************
var e=require("../Aria");module.exports=e.interfaceDefinition({$classpath:"aria.templates.ITemplateCtxt",$interface:{tplClasspath:"Object",moduleCtrl:"Object",moduleCtrlPrivate:"Object",moduleRes:"Object",flowCtrl:"Object",flowCtrlPrivate:"Object",data:"Object",$reload:"Function"}});
//*******************
//LOGICAL-PATH:aria/templates/TemplateCtxtManager.js
//*******************
var e=require("../Aria"),t=require("../utils/Array"),r=require("../utils/AriaWindow"),i=require("../utils/Store");module.exports=e.classDefinition({$classpath:"aria.templates.TemplateCtxtManager",$extends:i,$singleton:!0,$constructor:function(){this.$Store.constructor.call(this),this._rootTemplateContexts=[],e.rootTemplates=this._rootTemplateContexts,r.$on({unloadWindow:this._unloadWindow,scope:this})},$destructor:function(){e.rootTemplates=this._templateContexts=null,r.$unregisterListeners(this),this.$Store.$destructor.call(this)},$prototype:{_unloadWindow:function(){for(var t=e.rootTemplates,r=t.length-1;r>=0;r--)t[r].$dispose()},add:function(e){e._cfg&&e._cfg.isRootTemplate&&(this._rootTemplateContexts.push(e),r.attachWindow()),this.$Store.add.call(this,e)},remove:function(e){return e._cfg&&e._cfg.isRootTemplate&&t.remove(this._rootTemplateContexts,e)&&r.detachWindow(),this.$Store.remove.call(this,e)},getFromDom:function(e){var t=function(t){return e==t.getContainerDiv()};return this.getMatch(t)},disposeFromDom:function(e){var t=function(t){return e==t.getContainerDiv()},r=this.removeMatch(t);return r?(r.$dispose(),!0):!1},getRootCtxts:function(){return this._rootTemplateContexts}}});
//*******************
//LOGICAL-PATH:aria/templates/Layout.js
//*******************
var e=require("../Aria");require("./CfgBeans");var t=require("./TemplateCtxtManager"),r=require("../utils/Event"),i=require("../core/Browser"),n=require("../utils/Dom"),a=require("../utils/AriaWindow"),s=require("../core/Timer"),o=require("../core/JsonValidator");!function(){var l,c,u,h,p,d={width:{},height:{}},m=null,f=function(){null==m&&(m=[],a.attachWindow(),u.addListener(e.$window,"resize",{fn:v}),$())},_=function(){h&&(c.cancelCallback(h),h=null),null!=m&&(u.removeListener(e.$window,"resize",{fn:v}),a.detachWindow(),m=null)},g=function(){null==m&&l._listeners&&l._listeners.viewportResized?f():null==m||0!==m.length||null!=l._listeners&&null!=l._listeners.viewportResized||_()},y=function(t){var r;(null!=t.min||null!=t.max)&&(r=e.minSizeMode&&null!=t.min?t.min:t.viewport,null!=r?(t.scrollbar&&(r-=l.getScrollbarsWidth()),null!=t.min&&r<t.min&&(r=t.min),null!=t.max&&r>t.max&&(r=t.max)):t.min==t.max&&(r=t.min)),t.value=r},v=function(){h&&(c.cancelCallback(h),h=null),h=c.addCallback({fn:E,scope:l,delay:50})},$=function(){var e=l.viewportSize,t=n._getViewportSize();return t.width!=e.width||t.height!=e.height?(l.viewportSize=t,l.setSOViewport(d.width,t.width),l.setSOViewport(d.height,t.height),!0):!1},E=function(){if(h=null,$()){for(var e=m.length,r=0;e>r;r++){var i=m[r];l.setDivSize(i.domElt,i.width,i.height);var a=t.getFromDom(i.domElt);if(a){var s=!1;a.$setViewportWidth(w(i.width,"width"))&&(s=!0),a.$setViewportHeight(w(i.height,"height"))&&(s=!0),s&&a.$refresh()}n.refreshScrollbars(i.domElt)}$(),l.$raiseEvent({name:"viewportResized",viewportNewSize:l.viewportSize})}},w=function(e,t){return"object"==typeof e&&(e=l.getSODim(d[t],e.min,e.incrementFactor,e.max)),e};module.exports=e.classDefinition({$classpath:"aria.templates.Layout",$singleton:!0,$events:{viewportResized:""},$constructor:function(){l=this,c=s,$(),u=r},$destructor:function(){_(),l=null,c=null,u=null},$statics:{LAYOUT_INCOHERENT_MIN_MAX:"Error while setting size configuration: min (%1) > max (%2).",MINSIZE_UNDEFINED:"vdim or hdim cannot be used if container has no minimum size."},$prototype:{viewportSize:{width:null,height:null},$on:function(){this.$JsObject.$on.apply(this,arguments),g()},$unregisterListeners:function(){this.$JsObject.$unregisterListeners.apply(this,arguments),g()},$addListeners:function(){this.$JsObject.$addListeners.apply(this,arguments),g()},$removeListeners:function(){this.$JsObject.$removeListeners.apply(this,arguments),g()},registerAutoresize:function(e,t,r){null==m&&f(),m.push({domElt:e,width:t,height:r})},unregisterAutoresize:function(e){if(null!=m){for(var t=m.length,r=[],i=0;t>i;i++){var n=m[i];n.domElt!=e&&r.push(n)}m=r,0===r.length&&g()}},setRootDim:function(e){o.check(e,"aria.templates.CfgBeans.RootDimCfg"),this.setSOSizeCfg(d.width,e.width),this.setSOSizeCfg(d.height,e.height)},realWidth:function(e){return w(e,"width")},realHeight:function(e){return w(e,"height")},setDivSize:function(e,t,r,i){null==i&&(i="auto"),t=w(t,"width"),r=w(r,"height");var n=e.style;t&&(n.width=t+"px"),r&&(n.height=r+"px");var a="";(null!=t||null!=r)&&("auto"==i?a=" xOverflowAuto":"hidden"==i&&(a=" xOverflowHidden"));var s=e.className;s?(s=s.replace(/\s*xOverflow\w+/g,""),s+=a):s=a,e.className=s},setSOSizeCfg:function(e,t){null!=t.value&&(t.min=t.value,t.max=t.value),e.min=t.min,e.max=t.max,e.scrollbar=t.scrollbar,null!=e.min&&null!=e.max&&e.min>e.max&&(this.$logError(this.LAYOUT_INCOHERENT_MIN_MAX,[e.min,e.max]),e.max=void 0),y(e)},setSOViewport:function(e,t){e.viewport=t,y(e)},getSODim:function(e,t,r,i){var n=e.min;if(null==n)return this.$logError(this.MINSIZE_UNDEFINED),t;var a=e.value;null==r&&(r=1);var s=parseInt(t+(a-n)*r,10);return null!=i&&s>i&&(s=i),s},getScrollbarsMeasuredWidth:function(){if(null!=p)return p;var t=e.$window.document,r=t.createElement("div"),n=t.createElement("div");return r.style.overflow="",r.style.position="absolute",r.style.left="-10000px",r.style.top="-10000px",r.style.width="500px",r.style.height="500px",i.isIE7||(n.style.width="100%"),n.style.height="100%",t.body.appendChild(r),r.appendChild(n),p=n.offsetWidth,r.style.overflow="scroll",p-=n.offsetWidth,t.body.removeChild(r),p},getScrollbarsWidth:function(){var e=this.getScrollbarsMeasuredWidth();return e>0?e:17}}})}();
//*******************
//LOGICAL-PATH:aria/templates/LegacyGeneralStyle.tpl.css
//*******************
Aria.classDefinition({$classpath:"aria.templates.LegacyGeneralStyle",$extends:"aria.templates.CSSTemplate",$constructor:function(){this.$CSSTemplate.constructor.call(this)},$destructor:function(){this.$CSSTemplate.$destructor.call(this)},$dependencies:["aria.widgets.AriaSkinInterface"],$csslibs:["aria.widgets.TextStyle"],$prototype:{macro_main:function(){try{with(this){var general=aria.widgets.AriaSkinInterface.getGeneral();this.macro_writeGeneralStyle(general)}}catch(_ex){this.$logError(this.EXCEPTION_IN_MACRO,["main",__filename,this["aria:currentLineNumber"]],_ex)}},macro_writeGeneralStyle:function(general){try{with(this)general.font&&(this.__$write("\nbody, textarea, select, input, button, table {\n",32),this.text.macro_writeFontStyleInner(general.font),this.__$write("\n}\n",34)),general.anchor&&general.anchor.states&&this.text.macro_writeAnchorsStyle(general.anchor.states),general.disable&&general.disable.ul.list.style||this.__$write("\nul, li {list-style-type:none;}\n",43)}catch(_ex){this.$logError(this.EXCEPTION_IN_MACRO,["writeGeneralStyle",__filename,this["aria:currentLineNumber"]],_ex)}},$init:function(e){e.__$csslibs={text:"aria.widgets.TextStyle"},e.__$prefix=!0},__$initTemplate:function(){return!0}}});var __filename="ariatemplates/templates/LegacyGeneralStyle.tpl.css";
//*******************
//LOGICAL-PATH:aria/templates/NavigationManager.js
//*******************
var e=require("../Aria"),t=require("../utils/Type");require("./CfgBeans");var r=require("../core/JsonValidator");module.exports=e.classDefinition({$classpath:"aria.templates.NavigationManager",$singleton:!0,$constructor:function(){this._tableNavMarker=e.FRAMEWORK_PREFIX+"tableNavDone",this._keyMapMarker=e.FRAMEWORK_PREFIX+"keyMapDone",this.globalKeyMap=[],this._hasModalBehaviour=!1},$statics:{INVALID_GLOBAL_KEYMAP_CFG:"Invalid global keymap configuration."},$prototype:{addGlobalKeyMap:function(e){var t={json:e,beanName:"aria.templates.CfgBeans.GlobalKeyMapCfg"};r.normalize(t)?(e=t.json,this.globalKeyMap.unshift(e)):this.$logError(this.INVALID_GLOBAL_KEYMAP_CFG)},removeGlobalKeyMap:function(e){for(var t,r=0,i=this.globalKeyMap.length;i>r;r++)if(t=this.globalKeyMap[r],t.key==e.key&&!!e.modal==!!t.modal&&!!e.alt==!!t.alt&&!!e.shift==!!t.shift&&!!e.ctrl==!!t.ctrl)return this.globalKeyMap.splice(r,1),!0;return!1},handleNavigation:function(e,t,r){("keyup"==r.type||"keydown"==r.type)&&(r[this._tableNavMarker]||"keydown"!=r.type||(r[this._tableNavMarker]=this._handleTableNavigation(t,r)),r[this._keyMapMarker]||(r[this._keyMapMarker]=this._handleKeyMap(e,r)))},handleGlobalNavigation:function(e){("keyup"==e.type||"keydown"==e.type)&&(e[this._keyMapMarker]||(e[this._keyMapMarker]=this._handleKeyMap(this.globalKeyMap,e,!0)))},focusFirst:function(e,t){var r;if(e&&1==e.nodeType){for(var i,a=e.childNodes,n=a.length,s=t?n-1:0;s>-1&&n>s;t?s--:s++){if(i=a[s],r={fn:function(){this._focusNext(i,t)},scope:this},this._doFocus(i,r))return!0;if(this.focusFirst(i,t))return!0}return!1}return!1},setModalBehaviour:function(e){this._hasModalBehaviour=e},_focusNext:function(t,r){for(var i,a=e.$window.document.body;!i;)if(i=r?t.previousSibling:t.nextSibling,!i&&(t=t.parentNode,!t||t==a))return!1;return this._doFocus(i)||this.focusFirst(i,r)?!0:this._focusNext(i,r)},_doFocus:function(e,t){if(1!=e.nodeType)return!1;if(e.__widget){if(e.__widget.focus){var r=e.__widget.focus(null,t);return!!r}return!1}var i=e.nodeName,a=e.getAttributeNode("tabindex");if(("INPUT"==i||"TEXTAREA"==i||"A"==i||"BUTTON"==i||a&&a.specified&&-1!=a.nodeValue)&&!e.disabled)try{return e.focus(),!0}catch(n){return!1}return!1},_handleTableNavigation:function(e,t){var r=t.keyCode,i=!1;if(e===!1||r>40||37>r)return!0;if(!e)return!1;e===!0&&(e={});var a=this._validateModifiers(e,t);if(a){var n=t.target,s=this._getContainingTD(n);if(s){var o=s.parentNode.parentNode,l=this._getTableMap(o,s);i=this._navigateMap(o,l,t)}else r==t.KC_ARROW_DOWN?i=this._focusNext(n):r==t.KC_ARROW_UP&&(i=this._focusNext(n,!0));return i&&t.preventDefault(),!0}},_validateModifiers:function(e,t){return t.altKey==!!e.alt&&t.shiftKey==!!e.shift&&t.ctrlKey==!!e.ctrl},_navigateMap:function(e,t,r){var i=r.keyCode,a=t.map,n=t.pos,s=0,o=0;i==r.KC_ARROW_UP?s=-1:i==r.KC_ARROW_DOWN?s=1:o=i==r.KC_ARROW_LEFT?-1:1;var l,c,u,h,p=!1,d=n,m=n.rowIndex,f=n.mapCellIndex;do{if(0!==o?f+=o:m+=s,0>m||m>=a.length)return this._focusNext(e,0>m);if(l=a[m],h=!1,0>f||f>=l.length){if(0===s)return!1;1==o?(o=-1,f=n.mapCellIndex):(o=1,f=n.mapCellIndex-1,m+=s),h=!0}if(!h&&(u=a[m][f],u!=d&&(0!==s&&0!==o&&(-1==s&&u.rowIndex+u.rowSpan-1!=m?h=!0:1==s&&u.rowIndex!=m&&(h=!0)),!h))){if(c=e.rows[u.rowIndex].cells[u.cellIndex],d=u,!c)return!1;p=this.focusFirst(c),p||0===s||0!==o||(o=1)}}while(!p);return!0},_getContainingTD:function(t){for(var r=e.$window.document.body,i=t;i&&i!=r;){if("TD"==i.nodeName&&!i.parentNode.parentNode.attributes.isFrame)return i;i=i.parentNode}},_getTableMap:function(e,t){for(var r,i=[],a=e.rows,n=0,s=a.length;s>n;n++){var o=a[n].cells,l=i[n];l||(l=[],i[n]=l);for(var c=0,u=0,h=o.length;h>u;u++){for(var p=o[u],d=p.rowSpan,m=p.colSpan,f=l[c];f;)f=l[++c];var _={rowIndex:n,cellIndex:u,rowSpan:d,mapCellIndex:c};p==t&&(r=_);for(var g=0;d>g;g++){var y=i[n+g];y||(y=[],i[n+g]=y);for(var v=0;m>v;v++)y[c+v]=_}c+=m}}return{map:i,pos:r}},_handleKeyMap:function(e,r,i){var a,n,s=r.keyCode,o=!1,l=!1;if(!e||!s)return!1;for(var c,u=0;c=e[u];u++)if(this._validateModifiers(c,r)){if(n=c&&"event"in c?c.event:"keydown",!c.key||n!=r.type)return!1;if(i===!0&&this._hasModalBehaviour&&!c.modal)continue;if(t.isNumber(c.key)){if(c.key==s){o=this.$callback(c.callback),l=!0;break}}else if("*"!==c.key){if(r["KC_"+c.key.toUpperCase()]==s){o=this.$callback(c.callback),l=!0;break}}else a=c.callback}return l?o?!1:(r.preventDefault(),!0):a?!this.$callback(a):!1}}});
//*******************
//LOGICAL-PATH:aria/templates/SectionWrapper.js
//*******************
var e=require("../Aria"),t=require("../utils/Dom"),r=require("./DomElementWrapper");module.exports=e.classDefinition({$classpath:"aria.templates.SectionWrapper",$extends:r,$constructor:function(r,i){if(r)for(;1!=r.nodeType;)r=r.parentNode;this.$DomElementWrapper.constructor.call(this,r,i.tplCtxt),this.insertAdjacentSection=function(e,a){return"beforeBegin"!=e&&"afterBegin"!=e&&"beforeEnd"!=e&&"afterEnd"!=e?void this.$logError(t.INSERT_ADJACENT_INVALID_POSITION,[e]):void i.tplCtxt.insertAdjacentSections({position:e,refSection:{domElt:r,object:i},sections:[a]})},this.remove=function(){i.$dispose();var e=r.parentNode;t.removeElement(r),t.refreshDomElt(e),this.$dispose()},this.setProcessingIndicator=function(e,t){i.setProcessingIndicator(e,t)};var a=this.classList.setClassName;this.classList.setClassName=function(e){a.call(this,e),i.updateClassList(e)};var n=this._dispose;this._dispose=function(){this.setProcessingIndicator=e.empty,n.call(this),i=null,n=null}},$prototype:{}});
//*******************
//LOGICAL-PATH:aria/templates/Section.js
//*******************
var e=require("../Aria"),t=require("../utils/Array"),i=require("../utils/Json"),r=require("../utils/Delegate"),a=require("./NavigationManager");require("./CfgBeans");var n=require("../utils/Dom");require("../utils/String");var s=require("./DomElementWrapper"),o=require("../utils/Html"),l=require("./DomEventWrapper"),c=require("../utils/IdManager"),u=require("./SectionWrapper"),h=require("../utils/css/Animations"),p=require("../utils/Type"),d=require("../core/JsonValidator"),m=require("../utils/DomOverlay");!function(){var f=null,_=0,g=1,y=/^[\w\-:\.]+\+?$/;module.exports=e.classDefinition({$classpath:"aria.templates.Section",$onload:function(){f=new c("s")},$onunload:function(){f.$dispose(),f=null},$constructor:function(t,i,a){var n,s,o,l;if(this._content=[],this.parent=null,this._initWidgetsDone=!1,this.html=null,this._bindings=[],this._processing=null,this._overlayId=null,this.delegateIds=[],this.cfgOk=!0,this.tplCtxt=t,this.delegateCallbacks=[],this.isRoot=a&&a.isRoot===!0,this.idMap=a&&a.ownIdMap?{}:null,this._cfg=i,this._normalizeCallbacks(),this.delegateId=r.add({fn:this._onDomEvent,scope:this}),!this.isRoot&&(this.cfgOk=d.validateCfg("aria.templates.CfgBeans."+this.$class+"Cfg",i,{msg:this.INVALID_CONFIGURATION,params:[this.tplCtxt.tplClasspath,i.id]}),this.cfgOk)){l=i.type,s=i.bindRefreshTo,o=i.id;var c;if(o){if(!y.test(o))return this.$logError(this.INVALID_SECTION_ID,[this.tplCtxt.tplClasspath,o]),void(this.cfgOk=!1);o.indexOf("+")>-1&&(e.testMode&&(c=this.tplCtxt.$getAutoId(o)),delete i.id,o=null)}this.domType=l,this._domId=c||(o?this.tplCtxt.$getId(o):this._createDynamicId()),this.id=o||"_gen_"+this._domId,this.keyMap=i.keyMap,this.tableNav=i.tableNav,this.processingLabel=i.processingLabel,this.__skipProcessingChange=!1,this.macro=i.macro?t.checkMacro(i.macro):null,this.wrapper=null;for(var u=0;n=s[u];u++)this.registerBinding(n,this._notifyDataChange);this.registerProcessing(i.bindProcessingTo),this._refreshMgrInfo=null,this.attributes=i.attributes,this._attributesBinding=null,this._attributesChangeListener=null;var h=i.bind&&i.bind.attributes?i.bind.attributes:null;this._attributesBinding=h,h&&(this.attributes=this.__json.copy(h.inside[h.to]),this._attributesChangeListener=this.registerBinding(h,this._notifyAttributeChange));var p=i.bind&&i.bind.animation?i.bind.animation:null;p&&(i.animation=p.inside[p.to],this._animationChangeListener=this.registerBinding(p,this._notifyAnimationChange))}},$destructor:function(){this.disposeProcessingIndicator(),this.removeDelegateIdsAndCallbacks(),this._releaseAllDynamicIds(),this.delegateId&&(r.remove(this.delegateId),this.delegateId=null),this._content&&(this.removeContent(),this.id&&this.idMap&&(this.idMap[this.id]=null,delete this.idMap[this.id]),this._content=null,this.idMap=null);var e=this.parent;e&&(this.parent=null,e.removeSubSection(this)),this._listenersStopped!==!0&&this.stopListeners(),this._processing=null,this.setDom(null),this.html=null,this._refreshMgrInfo=null,this.tplCtxt=null,this._cfg=null,this._attributesBinding=null,this._attributesChangeListener=null},$events:{beforeRemoveContent:"",afterRemoveContent:""},$statics:{MISSING_TO_BINDING:"Invalid Binding Configuration: 'to' is mandatory",INVALID_TO_BINDING:"Invalid Binding Configuration: 'to' must be a Boolean value or null",WIDGETCALL_ERROR:"Error in '%2' for widget '%1'.",INVALID_SECTION_ID:"Error in template '%1': invalid section id '%2'.",SECTION_ALREADY_EXISTS:"Error in template '%1': section uses already used id '%2'.",SECTION_BINDING_ERROR:"Section binding failed. Inside: %1, to: %2. Section id: %3, template: %4.",INVALID_CONFIGURATION:"Error in template '%1': invalid configuration for section id '%2'.",WIDGET_ID_NOT_UNIQUE:"The %1 widget with id %2 does not have a unique id",SECTION_CALLBACK_ERROR:"The callback function raised an exception. Template: '%1'\nSection: '%2'\nEvent: '%3' "},$prototype:{$init:function(e){e.__navigationManager=a,e.__json=i},_type:_,initWidgets:function(){var e=[];if(this._initWidgetsDone)return e;this._initWidgetsDone=!0,this.html=null;for(var t=this._content,i=t.length,r=0;i>r;r++){var a=t[r];if(a._type==g){var n=a.behavior;if(n.initWidget)try{n.initWidget(),n.isDiffered&&e.push(n)}catch(s){this.$logError(this.WIDGETCALL_ERROR,[n.$classpath,"initWidget"],s)}}else e=e.concat(a.initWidgets())}return this.refreshProcessingIndicator(),e},removeContent:function(){this.$raiseEvent("beforeRemoveContent"),this._removingContent=!0;for(var e=this._content,t=e.length,i=0;t>i;i++){var r=e[i];if(r._type==g){var a=r.behavior;r.id&&this.idMap&&(this.idMap[r.id]=null,delete this.idMap[r.id]),a.$dispose()}else r.$dispose()}this._content=[],this._initWidgetsDone=!1,this._removingContent=!1,this.$raiseEvent("afterRemoveContent")},removeDelegateIdsAndCallbacks:function(){if(this.delegateIds){for(var e=0,t=this.delegateIds.length;t>e;e++)r.remove(this.delegateIds[e]);this.delegateIds=[]}for(var e=0,t=this.delegateCallbacks.length;t>e;e++)this.delegateCallbacks[e].$dispose();this.delegateCallbacks=[]},addBehavior:function(e){var t=e.getId?e.getId():null,i={_type:g,behavior:e,section:this,id:t};t&&this.idMap&&(this.idMap[t]?(this.$logError(this.WIDGET_ID_NOT_UNIQUE,[this.tplCtxt.tplClasspath,t,e.$class]),i.id=null):this.idMap[t]=i),this._content.push(i)},getBehaviorById:function(e){var t=this.idMap?this.idMap[e]:null;return t&&t._type==g?t.behavior:null},getSectionById:function(e){var t=this.idMap?this.idMap[e]:null;return t&&t._type==_?t:null},addSubSection:function(e){this.$assert(141,!e.parent),this.$assert(142,e._type==_),this.$assert(143,e.tplCtxt==this.tplCtxt),e.parent=this,e.__updateIdMap(this.idMap),this._content.push(e)},__updateIdMap:function(e){if(this.idMap!=e){this.idMap=e;var t=this.id;t&&e&&(e[t]?this.$logError(this.SECTION_ALREADY_EXISTS,[this.tplCtxt.tplClasspath,t]):e[t]=this);for(var i=this._content,r=i.length,a=0;r>a;a++){var n=i[a];n._type==_?n.__updateIdMap(e):(t=n.id,t&&e&&(e[t]?this.$logError(this.WIDGET_ID_NOT_UNIQUE,[this.tplCtxt.tplClasspath,t,n.behavior.$class]):e[t]=n))}}},removeSubSection:function(e){this._removingContent||t.remove(this._content,e)},registerBinding:function(e,t){var i=null;if(e){i={fn:t||this._notifyDataChange,scope:this,args:{tplCtxt:this.tplCtxt,animate:e.animate}};try{e.recursive=e.recursive!==!1,this.__json.addListener(e.inside,e.to,i,!0,e.recursive),this._bindings.push({inside:e.inside,callback:i,to:e.to,recursive:e.recursive})}catch(r){this.$logError(this.SECTION_BINDING_ERROR,[e.inside,e.to,this.id,this.tplCtxt.tplClasspath]),i=null}return i}},__isValidProcessingBind:function(e){if(null==e.to)return this.$logError(this.MISSING_TO_BINDING),!1;var t=e.inside[e.to];return null==t||p.isBoolean(t)?!0:(this.$logError(this.INVALID_TO_BINDING),!1)},registerProcessing:function(e){this.__isValidProcessingBind(e)&&(this.registerBinding(e,this._notifyProcessingChange),this._processing={inside:e.inside,to:e.to})},setProcessingIndicator:function(e,t){e=!!e;var i=!!this._overlayId;if(e!==i){e?this._overlayId=m.create(this.getDom(),t):this.disposeProcessingIndicator();var r=this._processing;r&&(this.__skipProcessingChange=!0,this.__json.setValue(r.inside,r.to,e),this.__skipProcessingChange=!1)}else e&&m.overlays[this._overlayId].refresh()},refreshProcessingIndicator:function(e){if(e)for(var t=this._content,i=0,r=t.length;r>i;i++)t[i].refreshProcessingIndicator?t[i].refreshProcessingIndicator(!0):t[i].behavior&&t[i].behavior.subTplCtxt&&t[i].behavior.subTplCtxt.refreshProcessingIndicator();var a=this._processing,n=!!a;n&&a.inside[a.to]&&this.setProcessingIndicator(!0,this.processingLabel)},disposeProcessingIndicator:function(){this._overlayId&&(m.disposeOverlays([this._overlayId]),this._overlayId=null)},_notifyDataChange:function(e,t){this._initWidgetsDone&&t.tplCtxt._cfg&&t.tplCtxt._cfg.tplDiv&&t.tplCtxt.$refresh({section:this.id,macro:this.macro,animate:t.animate})},_notifyAttributeChange:function(){var e=this._attributesBinding,t=e.inside[e.to];this._applyNewAttributes(t)},_notifyAnimationChange:function(){var e=this._cfg,t=e.bind.animation;e.animation=t.inside[t.to]},updateAttributes:function(e){var t=this._attributesBinding;t?this.__json.setValue(t.inside,t.to,e):this._applyNewAttributes(e)},_applyNewAttributes:function(e){var t,i,r=this.getDom(),a=s.attributesWhiteList,n=this.attributes;for(t in n)n.hasOwnProperty(t)&&("dataset"==t?o.removeDataset(r,n[t]):e[t]||("classList"==t?this.getWrapper().classList.setClassName(""):r.removeAttribute(t)));for(t in e)i=e[t],e.hasOwnProperty(t)&&!this.__json.isMetadata(t)&&null!=i&&("classList"==t?this.getWrapper().classList.setClassName(i.join(" ")):"dataset"==t?o.setDataset(r,i):a.test(t)&&i!==n[t]&&r.setAttribute(t,i));this.attributes=this.__json.copy(e)},updateClassList:function(e){if(this.attributes&&this.attributes.classList){this.attributes.classList=e.split(" ");var t=this._attributesBinding;t&&this.__json.setValue(t.inside[t.to],"classList",e.split(" "),this._attributesChangeListener)}},_notifyProcessingChange:function(e){this.__skipProcessingChange||this.setProcessingIndicator(e.newValue,this.processingLabel)},getWrapper:function(){var e=this.wrapper;return e||(this.wrapper=e=new u(this.getDom(),this)),e},writeBegin:function(e){if(this.domType){var t=this.attributes?o.buildAttributeList(this.attributes):"",i=["<",this.domType,t,' id="',this._domId,'" ',r.getMarkup(this.delegateId),">"];e.write(i.join(""))}},writeEnd:function(e){this.domType&&e.write("</"+this.domType+">")},_onDomEvent:function(e){if(this.__navigationManager.handleNavigation(this.keyMap,this.tableNav,e),this._cfg&&this._cfg.on){var t=this._cfg.on[e.type];if(t){var i,r=new l(e);try{i=t.fn.call(t.scope,r,t.args)}catch(a){this.$logError(this.SECTION_CALLBACK_ERROR,[this.tplCtxt.tplClasspath,this._cfg.id,e.type],a)}return r.$dispose(),i}}},_normalizeCallbacks:function(){var e=this._cfg?this._cfg.on:null;if(e)for(var t in e)e.hasOwnProperty(t)&&(e[t]=this.$normCallback(e[t]))},copyConfigurationTo:function(e){this.$assert(708,null==e.idMap),e.id=this.id,e.domType=this.domType,e.tableNav=this.tableNav,e.keyMap=this.keyMap,e.macro=this.macro},notifyRefreshPlanned:function(e){var t=this._registerInRefreshMgr();t.queue=null,t.refreshArgs&&t.refreshArgs.animate&&(e.animate=!0),t.refreshArgs=e},_registerInRefreshMgr:function(){var e=this._refreshMgrInfo;return e||(e={refreshArgs:null,queue:[]},this._refreshMgrInfo=e,aria.templates.RefreshManager.queue({fn:this._refreshManagerCallback,scope:this},this)),e},_refreshManagerCallback:function(){var e=this._refreshMgrInfo;if(e){this._refreshMgrInfo=null;var t=e.queue;t||this.tplCtxt.$refresh(e.refreshArgs)}},beforeRefresh:function(e){var t=this.macro;if(t)if(e.macro){var i=e.macro;p.isObject(i)&&!i.name&&(i.name=t.name,i.scope=t.scope,i.args||(i.args=t.args))}else e.macro=t;this._domElt=null},getDom:function(){return this._domElt||(this._domElt=n.getElementById(this._domId)),this._domElt},setDom:function(e){this._domElt=e,this.wrapper&&(this.wrapper.$dispose(),this.wrapper=null)},_createDynamicId:function(){var e=f.getId();return this._dynamicIds?this._dynamicIds.push(e):this._dynamicIds=[e],e},_releaseAllDynamicIds:function(){var e=this._dynamicIds;if(e){for(var t=e.length-1;t>=0;t--)f.releaseId(e[t]);this._dynamicIds=null}},moveContentTo:function(e){var t=this._content;this.$assert(805,null==this.idMap),this.$assert(806,t);for(var i=e._content,r=i.length,a=0,n=t.length;n>a;a++){var s=t[a];i[r+a]=s,s._type==_&&(s.parent=e)}this.__updateIdMap(e.idMap),e.delegateIds=e.delegateIds.concat(this.delegateIds),e.delegateCallbacks=e.delegateCallbacks.concat(this.delegateCallbacks),this.delegateIds=[],this.delegateCallbacks=[];var o=null;return e._initWidgetsDone&&(o=this.initWidgets()),this.idMap=null,this._content=[],o},stopListeners:function(){this.$assert(838,this._listenersStopped!==!0),this._listenersStopped=!0;var e=this._bindings;if(e)for(var t,i=0;t=e[i];i++)this.__json.removeListener(t.inside,t.to,t.callback,t.recursive)},resumeListeners:function(){this.$assert(859,this._listenersStopped===!0),this._listenersStopped=!1;var e=this._bindings;if(e)for(var t,i=0;t=e[i];i++)this.__json.addListener(t.inside,t.to,t.callback,!0,t.recursive)},writeContent:function(e){this.macro&&e.callMacro(this.macro)},_getAnimation:function(){var e=this._cfg.animation.animateIn.split(" "),t=this._cfg.animation.animateOut.split(" ");return{animIn:{type:e[0],reverse:"right"==e[1]},animOut:{type:t[0],reverse:"right"==t[1]}}},_animateRefresh:function(e,t){var i=this._getAnimation();this._animating=!0;var r=this._domElt.cloneNode(!1);e.id=null,r.className+=" not-visible",r=n.replaceHTML(r,this.html);var a=e,s=r;n.insertAdjacentElement(a,"afterEnd",r),this.setDom(r);var o=!1,l={to:s,type:3,reverse:i.animIn.reverse,hiddenClass:"not-visible"},c={from:a,type:3,reverse:i.animOut.reverse,hiddenClass:"not-visible"},u=new h,p=new h,d={animationend:function(){o?(n.removeElement(a),this._animating=!1,this.tplCtxt.onRefreshAnimationEnd(t)):o=!0},scope:this};u.$on(d),p.$on(d),u.start(i.animIn.type,l),p.start(i.animOut.type,c)},insertHTML:function(e,t){this._cfg&&this._cfg.animation&&t&&t.animate&&!this._animating?this._animateRefresh(e,t):(e=n.replaceHTML(e,this.html),this.setDom(e))}}})}();
//*******************
//LOGICAL-PATH:aria/templates/MarkupWriter.js
//*******************
var e=require("../Aria"),t=require("./Section"),i=require("../utils/Delegate"),r=require("./DomEventWrapper");require("../utils/Type"),function(){module.exports=e.classDefinition({$classpath:"aria.templates.MarkupWriter",$constructor:function(e,i){this._out=[],this._ctrlStack=[],this.tplCtxt=e,this._topSection=new t(this.tplCtxt,null,{isRoot:!0,ownIdMap:i&&i.ownIdMap}),this._currentSection=this._topSection,this._delegateMap=null},$destructor:function(){this._currentSection=null,this._delegateMap=null,this._topSection&&(this._topSection.$dispose(),this._topSection=null)},$prototype:{skipContent:!1,_beginSectionOrRepeater:function(e,i){var r=new i(this.tplCtxt,e);r.cfgOk||(r.$dispose(),r=new t(this.tplCtxt,{})),this._currentSection&&this._currentSection.addSubSection(r),r.writeBegin(this),this._currentSection=r,r.writeContent(this)},repeater:function(e){this._beginSectionOrRepeater(e,aria.templates.Repeater),this.endSection()},beginSection:function(e){this._beginSectionOrRepeater(e,t)},endSection:function(){var e=this._currentSection;e.writeEnd(this),this._currentSection=e.parent,this.$assert(99,!!this._currentSection)},addToCtrlStack:function(e){this._ctrlStack.push(e)},removeFromCtrlStack:function(){return this._ctrlStack.pop()},write:function(e){if(this._delegateMap&&(e||0===e)){e=""+e;var t=e.indexOf(">");if(-1!=t){var a=this._delegateMap;this._delegateMap=null;var n=function(e){var t=new r(e),i=!0,n=a[e.type];return n&&("safetap"==e.type&&aria.touch.ClickBuster.registerTap(e),i=n.call(t)),t.$dispose(),i},s=i.add(n);return this._currentSection.delegateIds.push(s),this._out.push(e.substring(0,t)),this._out.push(" "+i.getMarkup(s)),void this._out.push(e.substring(t))}}this._out.push(e)},pushDelegate:function(e,t){if(this._currentSection){var r=i;if(!r.isDelegated(e)){var a=r.add(t);return this._currentSection.delegateIds.push(a),void this.write(r.getFallbackMarkup(e,a,!0))}t=new aria.utils.Callback(t),this._currentSection.delegateCallbacks.push(t),this._delegateMap||(this._delegateMap={}),this._delegateMap[e]=t}},registerBehavior:function(e){this._currentSection&&this._currentSection.addBehavior(e)},callMacro:function(e){this.tplCtxt._callMacro(this,e)},getSection:function(){var e=this._topSection;return e.html=this._out.join(""),this._delegate=null,this._out=null,this._topSection=null,e}}})}();
//*******************
//LOGICAL-PATH:aria/templates/ObjectLoading.js
//*******************
var e=require("../Aria"),t=require("./IObjectLoading"),i=require("./PublicWrapper");module.exports=e.classDefinition({$classpath:"aria.templates.ObjectLoading",$extends:i,$implements:[t],$constructor:function(){this.$PublicWrapper.constructor.call(this)},$prototype:{$publicInterfaceName:"aria.templates.IObjectLoading",notifyObjectLoaded:function(e){this.$raiseEvent({name:"objectLoaded",object:e})}}});
//*******************
//LOGICAL-PATH:aria/templates/ModuleCtrlFactory.js
//*******************
var e=require("../Aria");require("./CfgBeans");var t=require("./ObjectLoading"),i=require("../core/environment/Customizations"),r=require("../utils/Type"),a=require("../utils/Array"),n=require("../core/ClassMgr"),s=require("../core/Interfaces"),o=require("../core/JsonValidator");!function(){var l,c,u,h,p,d,f,m,_,g,y,v,$,E="__$moduleCtrlId",A={},w=s.generateKey,C=function(e,t){t&&this.$logError(this.EXCEPTION_CREATING_MODULECTRL,[e.desc.classpath],t),this.$callback(e.cb,{error:!0})},T=function(e){var t=new Function;return t.prototype=e,new t};l=function(t){var i=e.getClassRef(t.desc.classpath);i?(t.moduleCtrlConstr=i,c.call(this,t)):e.load({classes:[t.desc.classpath],oncomplete:{args:t,scope:this,fn:c},onerror:{args:t,scope:this,fn:C}})},c=function(t){try{var a=t.desc.classpath,n=t.moduleCtrlConstr;if(n||(n=e.getClassRef(a),t.moduleCtrlConstr=n),!n||!r.isInstanceOf(n.prototype,"aria.templates.ModuleCtrl"))return this.$logError(this.INVALID_MODULE_CTRL,[a]),C.call(this,t);var s=new t.moduleCtrlConstr(t.desc.constructorArgs);if(t.moduleCtrlPrivate=s,s.$hasFlowCtrl){var o,l=s.$hasFlowCtrl;l===!0&&(l=a+"Flow"),l=i.getFlowCP(l),t.flowCtrlClasspath=l,o=e.getClassRef(l),o?(t.flowCtrlConstr=o,u.call(this,t)):e.load({classes:[l],oncomplete:{args:t,scope:this,fn:u},onerror:{args:t,scope:this,fn:C}})}else u.call(this,t)}catch(c){return C.call(this,t,c)}},u=function(t){try{var a,n,s=t.moduleCtrlPrivate,o=s.$publicInterface();if(t.flowCtrlClasspath){if(t.flowCtrlConstr||(t.flowCtrlConstr=e.getClassRef(t.flowCtrlClasspath)),!t.flowCtrlConstr||!r.isInstanceOf(t.flowCtrlConstr.prototype,"aria.templates.FlowCtrl"))return this.$logError(this.INVALID_FLOW_CTRL,[t.flowCtrlClasspath]),C.call(this,t);a=new t.flowCtrlConstr,a.setModuleCtrl(o),s.$addInterceptor(s.$publicInterfaceName,a),n=a.$publicInterface()}var l=w(A),c={moduleCtrlPrivate:s,moduleCtrl:o,flowCtrlPrivate:a,flowCtrl:n,subModuleInfos:t.subModuleInfos};A[l]=c,o[E]=l,s[E]=l,t.res={error:!1,moduleCtrlPrivate:s,moduleCtrl:o};var u=i.getCustomModules(t.desc.classpath);if(u.length>0){var p=t.recursionCheck;p=p?T(p):{},p[t.desc.classpath]=1,v.call(this,c,u,{fn:h,scope:this,args:t},!0,p)}else h.call(this,null,t)}catch(d){return C.call(this,t,d)}},h=function(e,t){try{var i=t.registerListeners;if(i&&t.res.moduleCtrl.$on(i),t.session&&t.res.moduleCtrl.setSession(t.session),t.skipInit)this.$callback(t.cb,t.res);else{var r=t.desc.initArgs;r||(r={}),t.res.moduleCtrl.init(r,{fn:p,args:t,scope:this})}}catch(a){return C.call(this,t,a)}},p=function(e,t){this.$callback(t.cb,t.res)},d=function(e){var t=e[E],i=A[t];return i?i:(aria.templates.ModuleCtrlFactory.$logError(aria.templates.ModuleCtrlFactory.MODULECTRL_BYPASSED_FACTORY,[e.$classpath]),null)},f=d,m=function(e,t){var i=d(e);return i?i.moduleCtrlPrivate!=e?(aria.templates.ModuleCtrlFactory.$logError(aria.templates.ModuleCtrlFactory.EXPECTING_MODULECTRL_PRIVATE,[t,e.$classpath]),null):i:null},_=function(e,t,i,r){for(var a,n=i.length,s=0;n-1>s;s++)a=i[s],null==e[a]&&(e[a]={}),e=e[a];a=i[n-1];var o=!1;return null!=r?(null==e[a]&&(e[a]=[]),e=e[a],e[r]&&(o=!0),e[r]=t):(e[a]&&(o=!0),e[a]=t),o},g=function(e,t,i,r){var a,n=t.refpath,s=e.moduleCtrlPrivate,o=e.moduleCtrl.getData(),l=e.moduleCtrl,c=i?i.getData():null;r?(a=[n],s=null):(a=n.split("."),"_"==n.charAt(0)&&(o=null,l=null));var u=!1;s&&(u=_(s,i,a,t.arrayIndex)||u),o&&(u=_(o,c,a,t.arrayIndex)||u),l&&(u=_(l,i,a,t.arrayIndex)||u),null!=i&&u&&this.$logError(this.SUBMODULE_REFPATH_ALREADY_USED,[n,t.classpath,e.moduleCtrlPrivate.$classpath])},y=function(e,t){var i=t.common,r=t.subModuleDesc,a=e.moduleCtrl;if(i.res.subModules[t.subModuleIdx]=a,i.alreadyLoaded++,a){var n=i.parentModule,s=n.subModules;g.call(this,n,r,a,i.customModules),s?s.push(e.moduleCtrlPrivate):n.subModules=[e.moduleCtrlPrivate]}else{var o=t.error||this.SM_CREATION_FAILED;i.res.errors++,this.$logError(o,[r.refpath,r.classpath,i.parentModule.moduleCtrlPrivate.$classpath])}i.alreadyLoaded>=i.toBeLoaded&&this.$callback(i.cb,i.res)},v=function(e,t,i,a,n){var s=t.length;if(0===s)return void this.$callback(i,{subModules:[],errors:0});for(var c=e.moduleCtrlPrivate,u={cb:i,res:{subModules:[],errors:0},parentModule:e,alreadyLoaded:0,toBeLoaded:s,customModules:a},h=r,p=0;s>p;p++){var d=t[p],f=!1;a&&h.isString(d)&&(d={classpath:d,refpath:"custom:"+d});var m=d.classpath;o.check(d,"aria.templates.CfgBeans.SubModuleDefinition")?a&&"custom:"!=d.refpath.substring(0,7)?f=this.INVALID_CUSTOM_MODULE_REFPATH:n&&n[m]&&(f=this.CUSTOM_MODULES_INFINITE_RECURSION):f=this.INVALID_SM_DEF,f?y.call(this,{},{error:f,subModuleIdx:p,subModuleDesc:d,common:u}):l.call(this,{recursionCheck:n,subModuleInfos:{parentModule:e,customModule:a,subModuleDesc:d},registerListeners:a?null:{"*":{fn:c.onSubModuleEvent,scope:c,args:{smRef:d.refpath}},beforeDispose:{fn:c._onSubModuleBeforeDisposeEvent,scope:c,args:{smRef:d.refpath}}},desc:{classpath:m,initArgs:d.initArgs,constructorArgs:d.constructorArgs},session:e.moduleCtrlPrivate._session,cb:{fn:y,scope:this,args:{subModuleIdx:p,subModuleDesc:d,common:u}}})}},$=function(e,t){var i=t.objectLoading,r=e.subModules[0];if(r){var a=s;if(a.linkItfWrappers(t.oldModuleCtrl,r),t.oldFlowCtrl){var n=d(r),o=n.flowCtrl;o&&a.linkItfWrappers(t.oldFlowCtrl,o)}}i.notifyObjectLoaded(r),i.$dispose(),this.$callback(t.callback)},module.exports=e.classDefinition({$classpath:"aria.templates.ModuleCtrlFactory",$singleton:!0,$statics:{INVALID_SM_DEF:"Sub-module load failure: invalid module definition:\nreference: %1,\nclasspath: %2,\nparent class: %3",INVALID_CUSTOM_MODULE_REFPATH:"Error : invalid custom module refpath.\nrefpath: %1\nmodule class: %2\nparent class: %3",CUSTOM_MODULES_INFINITE_RECURSION:"Error: custom modules infinite recursion detected.\nrefpath: %1\nmodule class: %2\nparent class: %3",SM_CREATION_FAILED:"Sub-module creation failed:\nmodule name: %1,\nmodule class: %2\nparent class: %3",MODULECTRL_BYPASSED_FACTORY:"Error : module controller is already disposed or was not created using the module controller factory.\nmodule class: %1.",INVALID_MODULE_CTRL:"Error: %1 is not a module controller.",INVALID_FLOW_CTRL:"Error: %1 is not a flow controller.",EXPECTING_MODULECTRL_PRIVATE:"Error: %1 expected the whole module controller and only an interface was provided.\nmodule class: %2",EXCEPTION_CREATING_MODULECTRL:"Error: an exception occurred during the process of module controller creation.\nmodule class: %1",SUBMODULE_REFPATH_ALREADY_USED:"Sub-module refpath is already used (the existing path was replaced).\nrefpath: %1\nmodule class: %2\nparent class: %3",EXCEPTION_SUBMODULE_DISPOSE:"An exception occurred while disposing a sub-module.\nparent module class: %1\nchild module class: %2",RELOAD_ONLY_FOR_SUBMODULES:"The module reload feature is only available for sub-modules, and not for root modules.\nmodule class: %1",DISPOSE_NOT_SUBMODULE:"Error: disposeSubModule was called with a parameter which is not a sub-module of the current module.\nparent module class: %1\nclass of the parameter: %2"},$prototype:{createModuleCtrl:function(e,t,i){var r={desc:e,cb:t,skipInit:i};l.call(this,r)},__disposeSubModule:function(e,t){var i=d(t);if(i){var r=i.subModuleInfos;return r&&r.parentModule.moduleCtrlPrivate==e?void i.moduleCtrlPrivate.$dispose():void this.$logError(this.DISPOSE_NOT_SUBMODULE,[e.$classpath,i.moduleCtrlPrivate.$classpath])}},__loadSubModules:function(e,t,i){var r=m(e,"loadSubModules");return r?void v.call(this,r,t,i,!1):this.$callback(i,{error:!0})},__getModulePrivateInfoMethod:function(){var e=f;return f=null,e},isModuleCtrlReloadable:function(e){if(null==e)return!1;var t=e[E],i=A[t];if(!i)return!1;if(i.moduleCtrlPrivate!=e)return!1;var r=i.subModuleInfos;return null!=r},reloadModuleCtrl:function(e,i){var r=m(e,"reloadModuleCtrl");if(r){var a=r.subModuleInfos;if(null==a)return void this.$logError(this.RELOAD_ONLY_FOR_SUBMODULES,[e.$classpath]);var s=a.parentModule;this.$assert(668,null!=s);var o=r.moduleCtrl,l=r.flowCtrl,c=n,u=[e.$classpath,e.$publicInterfaceName],h=r.flowCtrlPrivate;h&&(u[2]=h.$classpath,u[3]=h.$publicInterfaceName);var p=new t;e.__$reloadingObject=p,e.$dispose();for(var d=0,f=u.length;f>d;d++)c.unloadClass(u[d],!0);v.call(this,s,[a.subModuleDesc],{fn:$,scope:this,args:{objectLoading:p,oldModuleCtrl:o,oldFlowCtrl:l,callback:i}},a.customModule)}},__notifyModuleCtrlDisposed:function(e){var t=e[E],i=m(e,"notifyModuleCtrlDisposed");if(i){i.isDisposing=!0;var r=i.subModuleInfos,n=r?r.parentModule:null;n&&!n.isDisposing&&(a.remove(n.subModules,e),g.call(this,n,r.subModuleDesc,null,r.customModule));var s=i.subModules;if(s){for(var o=s.length-1;o>=0;o--)try{s[o].$dispose()}catch(l){this.$logError(this.EXCEPTION_SUBMODULE_DISPOSE,[e.$classpath,s[o].$classpath],l)}i.subModules=null}A[t]=null,delete A[t],i.flowCtrlPrivate&&(i.flowCtrlPrivate.$dispose(),i.flowCtrlPrivate=null,i.flowCtrl=null),i.moduleCtrl=null,i.moduleCtrlPrivate=null,i.subModuleInfos=null}}}})}();
//*******************
//LOGICAL-PATH:aria/templates/RefreshManager.js
//*******************
var e=require("../Aria");module.exports=e.classDefinition({$classpath:"aria.templates.RefreshManager",$singleton:!0,$constructor:function(){this._stops=0,this._queue=[],this._hierarchies=[],this._updatedNodes=[],this._nodesToRefresh=[],this._isResuming=!1},$destructor:function(){this._queue=null,this._hierarchies=null,this._updatedNodes=null,this._nodesToRefresh=null},$statics:{PARENT_PROP:e.FRAMEWORK_PREFIX+"containedIn"},$prototype:{queue:function(e,t){this._queue.push({cb:e,elem:t})},stop:function(){this._isResuming||this._stops++},_triggerCB:function(e){var t,i=e.scope;i=i?i:this,t=e.fn?e.fn:e,"string"==typeof t&&(t=i[t]),e.scope.$Widget?t.call(i,null,e.args):t.call(i,e.args)},resume:function(){if(!(this._isResuming||(this._stops--,this._stops>0))){this._stops=0,this._isResuming=!0;var t=this._queue.length;if(null==e.rootTemplates||0===e.rootTemplates.length){for(var i=0;t>i;i++)this._triggerCB(this._queue[i].cb);return this._queue=[],void(this._isResuming=!1)}this.updateHierarchies(),this._updatedNodes.length=0;for(var r=this._hierarchies.length,a=0;r>a;a++)for(var n=this._hierarchies[a],s=0;t>s;s++){var o=this._queue[s],l=this._findInHierarchy(o,n);l&&(l.updated||(l.updated=!0,l.qElem=o,this._updatedNodes.push(l)),this._queue.splice(s,1),s--,t--)}this._computeMinimal();for(var o,c,i=0,u=this._nodesToRefresh.length;u>i;i++)o=this._nodesToRefresh[i].qElem,c=o.cb,this._triggerCB(c);for(var h=0;t>h;h++)o=this._queue[h],c=o.cb,this._triggerCB(c);this._queue=[],this._isResuming=!1}},isResuming:function(){return this._isResuming},_findInHierarchy:function(e,t){if(this._elemMatches(e,t))return t;if(null==t.content)return null;if(t.content.length>0)for(var i=0;i<t.content.length;i++){var r=t.content[i],a=this._findInHierarchy(e,r);if(null!=a)return a}return null},_elemMatches:function(e,t){var i=e.cb.args&&null!=e.cb.args.section;if(i){if("section"==t.type){var r=t.elem.tplCtxt;if(r!=e.elem)return!1;var a=e.cb.args.section,n=t.elem.id;return a==n}return!1}return"template"==t.type?e.elem==t.elem:"templateWidget"==t.type?t.elem.behavior?t.elem.behavior.subTplCtxt==e.elem:t.elem.subTplCtxt==e.elem:"widget"==t.type?t.elem.behavior._subTplCtxt==e.elem?!0:t.elem.behavior==e.elem:"section"==t.type?t.elem==e.elem:void 0},isStopped:function(){return this._stops>0},getHierarchies:function(){return this._hierarchies},updateHierarchies:function(){this._hierarchies.length=0;for(var t=0;t<e.rootTemplates.length;t++){var i=e.rootTemplates[t];if(i._mainSection){var r=this._fillNode(i);this._hierarchies.push(r)}}},_computeMinimal:function(){this._nodesToRefresh.length=0;for(var e=0;e<this._hierarchies.length;e++)this._markSubnodesToRefresh(this._hierarchies[e])},_markSubnodesToRefresh:function(e){if(e.updated){this._nodesToRefresh.push(e);var t=e.elem;if(!t.refreshManagerWholeUpdate)return;if(t.refreshManagerWholeUpdate())return}if(e.content&&e.content.length>0)for(var i=0;i<e.content.length;i++){var r=e.content[i];this._markSubnodesToRefresh(r)}},_fillNode:function(e){var t={type:null,elem:e,content:[]};if("aria.templates.TemplateCtxt"==e.$classpath){t.type="template";var i=e._mainSection._content;this._addContent(t,i)}else if("aria.widgets.Template"==e.$classpath){if(t.type="templateWidget",e.subTplCtxt&&e.subTplCtxt._mainSection){var r=e.subTplCtxt._mainSection._content;this._addContent(t,r)}}else if(1==e._type){var a=e.behavior;if("aria.widgets.Template"==a.$classpath){if(t.type="templateWidget",a.subTplCtxt&&a.subTplCtxt._mainSection){var r=a.subTplCtxt._mainSection._content;this._addContent(t,r)}}else if(t.type="widget",e.behavior._subTplCtxt){var n=e.behavior._subTplCtxt._mainSection._content;this._addContent(t,n)}else if("aria.widgets.form.DatePicker"==e.behavior.$classpath){if(e.behavior.controller._calendar&&e.behavior.controller._calendar._tplWidget){var s=[e.behavior.controller._calendar._tplWidget];this._addContent(t,s)}}else if("aria.widgets.form.MultiSelect"==e.behavior.$classpath){if(e.behavior.controller._listWidget){var s=[e.behavior.controller._listWidget._tplWidget];this._addContent(t,s)}}else t.content=null}else null!=e.idMap&&(t.type="section",this._addContent(t,e._content));return t},_addContent:function(e,t){for(var i=0;i<t.length;i++){var r=this._fillNode(t[i]);r[this.PARENT_PROP]=e,e.content.push(r)}}}});
//*******************
//LOGICAL-PATH:aria/templates/ModuleCtrl.js
//*******************
var e=require("../Aria"),t=require("./IModuleCtrl"),i=require("../utils/Json"),r=require("../utils/Type"),a=require("./ModuleCtrlFactory"),n=require("./RefreshManager"),s=require("../modules/RequestMgr"),o=require("./PublicWrapper"),l=require("../utils/Array"),u=require("../core/JsonValidator");module.exports=e.classDefinition({$classpath:"aria.templates.ModuleCtrl",$extends:o,$implements:[t],$constructor:function(){this.$PublicWrapper.constructor.call(this),this._data={},this._dataBeanName=null,this._smList=null,this.__resources=null,this._session=null,this.$requestHandler=null,this.$urlService=null,this.$requestJsonSerializer=null,this._enableMethodEvents=this._enableMethodEvents===!0,this._enableMethodEvents&&this.$addInterceptor(this.$publicInterfaceName,{fn:this._interceptPublicInterface,scope:this})},$destructor:function(){this.$raiseEvent({name:"beforeDispose",reloadingObject:this.__$reloadingObject}),this._enableMethodEvents&&this.$removeInterceptors(this.$publicInterfaceName,this,this._interceptPublicInterface),this._smLoads=null,this._data=null,this._resources=null,this._smList=null,a.__notifyModuleCtrlDisposed(this),this.$PublicWrapper.$destructor.call(this),this.$requestJsonSerializer=null},$statics:{INIT_CALLBACK_ERROR:"An error occured while processing a Module init callback in class %1",DATA_CONTENT_INVALID:"Content of datamodel does not match databean:\nbean name: %1,\nmodule class: %2"},$prototype:{$hasFlowCtrl:!1,$publicInterfaceName:"aria.templates.IModuleCtrl",$init:function(e){e.json=i},init:function(e,t){this.$callback(t,!0,this.INIT_CALLBACK_ERROR)},_interceptPublicInterface:function(e){"CallBegin"!=e.step||aria.templates.ModuleCtrl.prototype[e.method]||n.stop();var t={name:"method"+e.step,method:e.method};this.$raiseEvent(t),"CallEnd"!=e.step||aria.templates.ModuleCtrl.prototype[e.method]||n.resume()},submitJsonRequest:function(e,t,i,a){var n=r;if(n.isString(i)||n.isFunction(i)){var o={fn:i,scope:this};i=o}else n.isObject(i)&&null==i.scope&&(i.scope=this);a||(a={});var l={fn:this._submitJsonRequestCB,scope:this,args:{cb:i}},u={moduleName:this.$package,session:this._session,actionQueuing:null,requestHandler:this.$requestHandler,urlService:this.$urlService,requestJsonSerializer:this.$requestJsonSerializer,async:a.async,timeout:a.timeout,headers:a.headers};n.isString(e)?u.actionName=e:u.serviceSpec=e,s.submitJsonRequest(u,t,l)},_submitJsonRequestCB:function(e,t){n.stop(),this.$callback(t.cb,e),n.resume()},onSubModuleEvent:function(){},_onSubModuleBeforeDisposeEvent:function(e){var t=this._smList;if(t)for(var i=0,r=t.length;r>i;i++)if(t[i]==e.src){l.removeAt(t,i),e.reloadingObject&&e.reloadingObject.$onOnce({objectLoaded:{scope:this,fn:this.__onSubModuleReloaded}});break}},__onSubModuleReloaded:function(e){this._smList&&this._smList.push(e.object)},loadSubModules:function(e,t){a.__loadSubModules(this,e,{fn:this.__onLoadSubModulesComplete,scope:this,args:t})},__onLoadSubModulesComplete:function(e,t){var i=e.subModules;i&&i.length>0&&(this._smList||(this._smList=[]),this._smList=this._smList.concat(e.subModules)),this.$callback(t,e)},disposeSubModule:function(e){a.__disposeSubModule(this,e)},getData:function(){return this._data},setData:function(e,t){this.json.inject(e,this._data,t),this._dataBeanName&&(u.normalize({json:this._data,beanName:this._dataBeanName})||this.$logError(this.DATA_CONTENT_INVALID,[this._dataBeanName,this.$classpath]))},getResourceSet:function(){var e=this.__resources;if(!e){var t=this.$resources;if(t){this.__resources=e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=this[i])}}return e},getSubModuleCtrl:function(e){if(this._smList)for(var t=this._smList.length,i=0;t>i;i++){var r=this._smList[i];if(r&&e==r.getData())return r}return this.$publicInterface()},registerListener:function(e){var t=this.$publicInterface();this.$on({"*":e},t)},unregisterListeners:function(e){var t=this.$publicInterface();this.$unregisterListeners(e,t)},setSession:function(e){if(this._session=e,this._smList)for(var t=this._smList.length,i=0;t>i;i++){var r=this._smList[i];r&&r.setSession(e)}}}});
//*******************
//LOGICAL-PATH:aria/templates/Repeater.js
//*******************
var e=require("../Aria"),t=require("./Section"),i=require("../utils/Type"),r=require("../utils/Array"),a=require("../utils/Json");!function(){var n=null,s=null,o=null,l=null,c=function(e){return e&&(s.isFunction(e)||e.fn)};module.exports=e.classDefinition({$classpath:"aria.templates.Repeater",$extends:t,$constructor:function(e,t,i){if(null==t.id&&(t.id=n.getId(),this._dynamicId=t.id),this.$Section.constructor.call(this,e,t,i),this.cfgOk){if(t.macro)return this.cfgOk=!1,void this.$logError(this.REPEATER_MACRO_NOT_SUPPORTED,[this.tplCtxt.tplClasspath,this.id]);if(this.items=[],this.itemsMap=null,this._childIdSuffix=0,this._loopType=t.loopType,this.iteratedSet=t.content,!this._updateLoopType())return void(this.cfgOk=!1);this._registerIteratedSetListener(),this._setChildSectionsCfg(t.childSections)}},$destructor:function(){this._dynamicId&&n.releaseId(this._dynamicId),this._unregisterIteratedSetListener(),this.$Section.$destructor.call(this)},$onload:function(){n=new aria.utils.IdManager("__repeater"),s=i,o=a,l=r},$onunload:function(){n.$dispose(),n=null,s=null,l=null,o=null},$statics:{REPEATER_INVALID_ITERATED_SET:"Error in template '%1': the value declared in bindContentTo in the repeater '%2' is not valid or not compatible with the loopType property (%3).",VIEWS_NOT_SUPPORTED:"Template %1, repeater %2: support for views is not yet implemented in the repeater.",REPEATER_MACRO_NOT_SUPPORTED:"Error in template '%1', in the repeater '%2': the macro property is not supported for repeaters."},$prototype:{beforeRefresh:function(e){e.writerCallback={fn:this._refreshWriterCallback,scope:this}},_refreshWriterCallback:function(e){this.items=[],this.itemsMap={},this._childIdSuffix=0,this.writeContent(e)},_createSectionParam:function(e){var t=this._childSections,i=this._childSectCBProp,r=this._childSectConstProp,a={};e.sectionId=this.tplCtxt.evalCallback(t.id,e),a.id=e.sectionId;var n,s,o;for(n=0,s=i.length;s>n;n++)o=i[n],a[o]=this.tplCtxt.evalCallback(t[o],e);for(n=0,s=r.length;s>n;n++)o=r[n],a[o]=t[o];return a},_initItem:function(e){e.iteratedSet=this.iteratedSet,e.sectionIdSuffix=""+this._childIdSuffix,this._childIdSuffix++},_writeRepeaterItem:function(e){this._initItem(e),this.items[e.ct-1]=e;var t=this._createSectionParam(e);this.tplCtxt.__$insertSection(0,t)},_loopOver_array:function(e,t,i){for(var r=0,a=e.length;a>r;r++)t.call(this,{index:r,ct:r+1,item:e[r]},i)},_loopOver_sortedView:function(e,t,i){e.refresh();for(var r=e.items,a=0,n=r.length;n>a;a++){var s=r[a];t.call(this,{index:a,ct:a+1,info:s,item:s.value},i)}},_loopOver_filteredView:function(e,t,i){e.refresh();for(var r=e.items,a=1,n=0,s=r.length;s>n;n++){var o=r[n];o.filteredIn&&(t.call(this,{index:n,ct:a,info:o,item:o.value},i),a++)}},_loopOver_pagedView:function(e,t,i){e.refresh();for(var r=e.pages[e.currentPageIndex],a=e.items,n=1,s=r.firstItemIndex,o=r.lastItemIndex;o>=s;s++){var l=a[s];l.filteredIn&&(t.call(this,{index:s,ct:n,info:l,item:l.value},i),n++)}},_loopOver_map:function(e,t,i){var r=1;this.itemsMap={};for(var a in e)if(e.hasOwnProperty(a)&&!o.isMetadata(a)){var n={index:a,ct:r,item:e[a]};t.call(this,n,i),this.itemsMap[a]=n,r++}},_defaultCallback_id:function(e,t){return t+e.sectionIdSuffix},_defaultCallback_macro:function(e,t){var i=l.clone(t.args);return i.push(e),{name:t.name,args:i,scope:t.scope}},_setChildSectionsCfg:function(e){var t={},i=[],r=[];for(var a in e)if(e.hasOwnProperty(a)){var n=e[a];t[a]=n,c(n)?"id"!=a&&i.push(a):"id"==a||"macro"==a?("macro"==a&&(n=this.tplCtxt.checkMacro(n)),t[a]={fn:this["_defaultCallback_"+a],args:n,scope:this},"id"!=a&&i.push(a)):r.push(a)}this._childSectCBProp=i,this._childSectConstProp=r,this._childSections=t},_registerIteratedSetListener:function(){var e=this._loopType;if("array"==e||"map"==e){var t={scope:this,fn:this._notifyChange};o.addListener(this.iteratedSet,null,t),this._iteratedSetListener=t}},_unregisterIteratedSetListener:function(){var e=this._iteratedSetListener;e&&(o.removeListener(this.iteratedSet,null,e),this._iteratedSetListener=null)},_notifyIteratedSetReplaced:function(){this._unregisterIteratedSetListener(),this.tplCtxt.$refresh({section:this.id})},refreshManagerWholeUpdate:function(){return this.$assert(341,this._refreshMgrInfo),null==this._refreshMgrInfo.queue},_refreshManagerCallback:function(){var e=this._refreshMgrInfo;if(e){this._refreshMgrInfo=null;var t=e.queue;if(t)for(var i=0,r=t.length;r>i;i++)this._notifyChange(t[i]);else this.tplCtxt.$refresh(e.refreshArgs)}},_checkRefreshManager:function(e){if(aria.templates.RefreshManager.isStopped()){var t=this._registerInRefreshMgr().queue;return t&&t.push(e),!0}return!1},_notifyChange_array:function(e){if(!this._checkRefreshManager(e)){var t=e.change,i=this.items;if(t==o.VALUE_CHANGED||t==o.KEY_REMOVED||t==o.KEY_ADDED){var r=parseInt(e.dataName,10);if(r!=e.dataName||0>r)return;if(r<i.length)o.setValue(i[r],"item",e.newValue),this.tplCtxt.$refresh({section:i[r].sectionId});else{for(var a=i.length,n=[],s=a;r>=s;s++){var l={index:s,ct:s+1,item:s==r?e.newValue:void 0};i[s]=l,this._initItem(l),n[s-a]=this._createSectionParam(l)}this.tplCtxt.insertAdjacentSections({refSection:{domElt:this.getDom(),object:this},sections:n,position:"beforeEnd"})}}else if(t==o.SPLICE){var r=e.index,c=e.removed.length;if(c)for(var s=0;c>s;s++){var u=this.items[r+s],h=this.tplCtxt.$getElementById(u.sectionId);h.remove()}var p=e.added,d=p.length;if(d){for(var n=[],f=[r,c],s=0;d>s;s++){var l={index:r+s,ct:r+s+1,item:p[s]};f[s+2]=l,this._initItem(l),n[s]=this._createSectionParam(l)}if(i.splice.apply(i,f),r>0){var m=this.getSectionById(i[r-1].sectionId);this.tplCtxt.insertAdjacentSections({refSection:{domElt:m.getDom(),object:m},sections:n,position:"afterEnd"})}else this.tplCtxt.insertAdjacentSections({refSection:{domElt:this.getDom(),object:this},sections:n,position:"afterBegin"})}else i.splice(r,c);d!=c&&this._updateRemainingItems(r+d,!0)}}},_updateRemainingItems:function(e,t){var i=this.items,r=this._childSections.attributes;c(r)||(r=null);for(var a=i.length-1;a>=e;a--){var n=i[a];if(t&&o.setValue(n,"index",a),o.setValue(n,"ct",a+1),r){var s=this.getSectionById(n.sectionId);s.updateAttributes(this.tplCtxt.evalCallback(r,n))}}},_notifyChange_map:function(e){var t=e.change;if((t==o.VALUE_CHANGED||t==o.KEY_REMOVED||t==o.KEY_ADDED)&&!this._checkRefreshManager(e)){var i=this.itemsMap,r=this.items,a=this.iteratedSet,n=e.dataName;if(!o.isMetadata(n))if(i.hasOwnProperty(n)){var s=i[n];if(t==o.KEY_REMOVED){var l=this.tplCtxt.$getElementById(s.sectionId);l.remove(),r.splice(s.ct-1,1),delete i[n],this._updateRemainingItems(s.ct-1,!1)}else o.setValue(s,"item",a[n]),this.tplCtxt.$refresh({section:s.sectionId})}else if(t!=o.VALUE_CHANGED){var s={index:n,ct:r.length+1,item:a[n]};this._initItem(s),r[s.ct-1]=s,this.tplCtxt.insertAdjacentSections({refSection:{domElt:this.getDom(),object:this},sections:[this._createSectionParam(s)],position:"beforeEnd"})}}},_updateLoopType:function(){var e=!0,t=this._loopType,i=this.iteratedSet;return"array"==t?e=s.isArray(i):"map"==t?e=s.isObject(i):null!=t?(e=s.isInstanceOf(i,"aria.templates.View"),"view"==t&&(t="pagedView")):(s.isArray(i)?t="array":s.isInstanceOf(i,"aria.templates.View")?t="pagedView":s.isObject(i)?t="map":e=!1,this._loopType=t),e?"map"!=t&&"array"!=t?(this.$logError(this.VIEWS_NOT_SUPPORTED,[this.tplCtxt.tplClasspath,this.id]),!1):(this._loopOver=this["_loopOver_"+t],this._notifyChange=this["_notifyChange_"+t],!0):(this.$logError(this.REPEATER_INVALID_ITERATED_SET,[this.tplCtxt.tplClasspath,this.id,t],i),!1)},writeContent:function(){this._loopOver(this.iteratedSet,this._writeRepeaterItem)}}})}();
//*******************
//LOGICAL-PATH:aria/tools/contextual/environment/ContextualMenuCfgBeans.js
//*******************
var e=require("../../../Aria"),t=require("../../../core/JsonTypes"),i=require("../../../core/environment/EnvironmentBaseCfgBeans");module.exports=e.beanDefinitions({$package:"aria.tools.contextual.environment.ContextualMenuCfgBeans",$namespaces:{json:t,environmentBase:i},$beans:{AppCfg:{$type:"json:Object",$restricted:!1,$properties:{contextualMenu:{$type:"ContextualMenuCfg",$default:{}}}},ContextualMenuCfg:{$type:"json:Object",$properties:{enabled:{$type:"json:Boolean",$default:e.debug},template:{$type:"json:PackageName",$default:"aria.tools.contextual.ContextualDisplay"},moduleCtrl:{$type:"json:PackageName",$default:"aria.tools.contextual.ContextualModule"}}}}});
//*******************
//LOGICAL-PATH:aria/tools/contextual/environment/ContextualMenu.js
//*******************
var e=require("../../../Aria");require("./ContextualMenuCfgBeans");var t=require("../../../core/environment/EnvironmentBase");module.exports=e.classDefinition({$classpath:"aria.tools.contextual.environment.ContextualMenu",$extends:t,$singleton:!0,$prototype:{_cfgPackage:"aria.tools.contextual.environment.ContextualMenuCfgBeans.AppCfg",getContextualMenu:function(){return this.checkApplicationSettings("contextualMenu")}}});
//*******************
//LOGICAL-PATH:aria/utils/environment/VisualFocusCfgBeans.js
//*******************
var e=require("../../Aria"),t=require("../../core/JsonTypes");module.exports=e.beanDefinitions({$package:"aria.utils.environment.VisualFocusCfgBeans",$namespaces:{json:t},$beans:{AppCfg:{$type:"json:Object",$restricted:!1,$properties:{appOutlineStyle:{$type:"json:String",$default:null}}}}});
//*******************
//LOGICAL-PATH:aria/utils/environment/VisualFocus.js
//*******************
var e=require("../../Aria"),t=require("noder-js/promise"),i=require("noder-js/asyncRequire");require("./VisualFocusCfgBeans");var r=require("../../core/environment/EnvironmentBase"),a=t.done.then(e.empty),n=function(){return a.thenSync(function(){return i(require.resolve("../VisualFocus"))})};module.exports=e.classDefinition({$classpath:"aria.utils.environment.VisualFocus",$extends:r,$singleton:!0,$prototype:{_cfgPackage:"aria.utils.environment.VisualFocusCfgBeans.AppCfg",getAppOutlineStyle:function(){return this.checkApplicationSettings("appOutlineStyle")},_applyEnvironment:function(e){var t=this.checkApplicationSettings("appOutlineStyle");if(t){var i=n();if(e){var r=this;i=i.thenSync(function(){r.$callback(e)})}i.done()}else this.$callback(e)}}});
//*******************
//LOGICAL-PATH:aria/templates/Template.js
//*******************
var e=require("../Aria"),t=require("../utils/Array"),i=require("../tools/contextual/environment/ContextualMenu"),r=require("../core/AppEnvironment"),a=require("./ITemplate");require("./$Template").load(),function(){var n=function(i){i&&i.changedProperties&&!t.contains(i.changedProperties,"contextualMenu")||e.load({classes:["aria.tools.contextual.ContextualMenu"]})};require("../utils/environment/VisualFocus"),module.exports=e.classDefinition({$classpath:"aria.templates.Template",$extends:require("./BaseTemplate"),$statics:{EXCEPTION_IN_CONTROL_PARAMETERS:"line %2: Uncaught runtime exception in control %3 for parameters '%1'",EXCEPTION_IN_REPEATER_PARAMETER:"line %2: Uncaught runtime exception in repeater parameter '%1'"},$onload:function(){i.getContextualMenu().enabled||r.$on({environmentChanged:n,scope:{}})},$prototype:{$width:void 0,$height:void 0,$init:function(e,t){e.$BaseTemplate.constructor.classDefinition.$prototype.$init(e,t);var i=a.prototype;for(var r in i)i.hasOwnProperty(r)&&!e.hasOwnProperty(r)&&(e[r]=i[r]);e.$json=require("../utils/Json")},onModuleEvent:function(){},onFlowEvent:function(){},$dataReady:function(){},$viewReady:function(){},$displayReady:function(){}}})}();
//*******************
//LOGICAL-PATH:aria/templates/TemplateCtxt.js
//*******************
var e=require("../Aria"),t=require("./Layout");require("./CfgBeans");var i=require("../utils/Array"),r=require("../utils/Function"),a=require("../utils/Type"),s=require("./TemplateCtxtManager"),n=require("./RefreshManager"),o=require("./CSSMgr");require("../utils/Path");var l=require("../utils/Delegate"),c=require("./NavigationManager"),u=require("./SectionWrapper");require("../core/environment/Customizations");var h=require("../utils/Dom"),p=require("./DomElementWrapper"),d=require("./MarkupWriter"),f=require("../utils/DomOverlay"),m=require("./ITemplate"),_=require("./ITemplateCtxt"),g=require("./BaseCtxt"),v=require("../utils/Json"),y=require("../core/Cache"),$=require("../core/TplClassLoader"),E=require("../core/JsonValidator");!function(){var C,A,T,w=["$refresh","$getChild","$getElementById","$focus","$hdim","$vdim","getContainerScroll","setContainerScroll","__$writeId","__$processWidgetMarkup","__$beginContainerWidget","$getId","__$endContainerWidget","__$statementOnEvent","__$statementRepeater","__$createView","__$insertSection","$setFocusedWidget","$getFocusedWidget"],b=["data","moduleCtrl","flowCtrl","moduleRes"],S={},I=function(t){var i=S[t];return null==i&&(i=e.getClassRef(t),S[t]=i),void 0===i&&this.$logError(this.WIDGET_LIBRARY_NOT_FOUND,[t,this.tplClasspath]),i},x=0;module.exports=e.classDefinition({$classpath:"aria.templates.TemplateCtxt",$implements:[m,_],$extends:g,$onload:function(){C=t,A=E},$onunload:function(){C=null,A=null},$events:{Ready:""},$constructor:function(){this.$BaseCtxt.constructor.apply(this,arguments),this._differed=null,this._ready=!1,this.__dataGround=null,this.__wrappers=[],this.__loadingOverlays=[],this._cfg=null,this._persistentStorage=null,this._focusedWidgetPath=[],this._globalCssDepsLoaded=!1},$destructor:function(){if(s.remove(this),this._cssClasses){if(o.unloadDependencies(this),this._globalCssDepsLoaded){var e=["aria.templates.GlobalStyle"];aria.widgets&&aria.widgets.AriaSkin&&e.push("aria.templates.LegacyGeneralStyle"),o.unloadWidgetDependencies("aria.templates.Template",e),this._globalCssDepsLoaded=!1}this._cssClasses=null}this.__dataGround&&(v.setValue(this.__dataGround,"data",null),this.__dataGround=null),this.__disposeProcessingIndicators(),this.__disposeWrappers();var t=this._tpl;if(t){try{this.flowCtrl&&this.flowCtrl.$unregisterListeners(t),this.moduleCtrl&&this.moduleCtrl.$removeListeners({"*":{fn:t.onModuleEvent,scope:t,firstOnly:!0},beforeDispose:{fn:this._beforeModuleDispose,scope:this,firstOnly:!0}})}catch(i){this.$logError(this.TEMPLATE_EXCEPTION_REMOVING_LISTENERS,[this.tplClasspath],i)}try{t.$dispose()}catch(i){this.$logError(this.TEMPLATE_DESTR_ERROR,[this.tplClasspath],i)}t.__$write=null;for(var r,n=0;r=b[n];n++)delete t[r];for(n=0;r=w[n];n++)delete t[r]}var l=this._mainSection;l&&(l.$dispose(),this._mainSection=null);var c=this._cfg;if(c){var u=c.tplDiv;if(u&&(this.__removeDebugInfo(u),c.tplDiv=null),c.div){var p=a.isObject;(p(c.width)||p(c.height))&&C.unregisterAutoresize(c.div),h.replaceHTML(c.div,""),c.div=null}if(c.toDispose){for(var d=c.toDispose,f=d.length-1;f>=0;f--)d[f].$dispose();c.toDispose=null,d=null}c.data=null,c.macro=null,this._cfg=null}this.data=null,this.moduleRes=null,this.moduleCtrl=null,this.moduleCtrlPrivate=null,this.flowCtrl=null,this.flowCtrlPrivate=null,this._tpl=null,this.$BaseCtxt.$destructor.call(this)},$statics:{WIDGET_LIBRARY_NOT_FOUND:"Error in template '%2': widget library '%1' was not found.",INVALID_STATE_FOR_REFRESH:"Error in template '%1': calling $refresh while the template is being refreshed is not allowed.",SECTION_OUTPUT_NOT_FOUND:"Error while refreshing template '%1': section '%2' was not found.",VAR_NULL_OR_UNDEFINED:"Template %2 \nLine %1: expression is null or undefined.",TEMPLATE_EXCEPTION_REMOVING_LISTENERS:"Error in template '%1' while removing module or flow listeners.",TEMPLATE_NOT_READY_FOR_REFRESH:"Error in template '%1': the $refresh method was called, but the template is not yet ready to be refreshed.",FOCUS_FAILURE:"Focus failure: widget/element with id '%1' in '%2' does not exist or it is not yet ready for focus.",DATA_READY_EXCEPTION:"Error in template %1: an exception happened in $dataReady.",VIEW_READY_EXCEPTION:"Error in template %1: an exception happened in $viewReady.",DISPLAY_READY_EXCEPTION:"Error in template %1: an exception happened in $displayReady.",BEFORE_REFRESH_EXCEPTION:"Error in template %1: an exception happened in $beforeRefresh.",AFTER_REFRESH_EXCEPTION:"Error in template %1: an exception happened in $afterRefresh.",AFTER_ANIMATION_END_EXCEPTION:"Error in template %1: an exception happened in $onRefreshAnimationEnd.",ALREADY_REFRESHING:"$refresh was called while another refresh is happening on the same template (%1). This is not allowed. Please check bindings.",MISSING_MODULE_CTRL_FACTORY:"Template %1 cannot be initialized without aria.templates.ModuleCtrlFactory, make sure it is loaded",MISSING_SECTION_MACRO:"Error in template %1 : 'macro' property is missing in section %2"},$prototype:{dataReady:function(){try{this._tpl.$dataReady()}catch(e){this.$logError(this.DATA_READY_EXCEPTION,[this.tplClasspath],e)}},viewReady:function(){try{this._tpl.$viewReady()}catch(e){this.$logError(this.VIEW_READY_EXCEPTION,[this.tplClasspath],e)}},displayReady:function(){try{this._tpl.$displayReady()}catch(e){this.$logError(this.DISPLAY_READY_EXCEPTION,[this.tplClasspath],e)}},beforeRefresh:function(e){if(this._tpl.$beforeRefresh)try{this._tpl.$beforeRefresh(e)}catch(t){this.$logError(this.BEFORE_REFRESH_EXCEPTION,[this.tplClasspath],t)}},afterRefresh:function(e){if(this._tpl.$afterRefresh)try{this._tpl.$afterRefresh(e)}catch(t){this.$logError(this.AFTER_REFRESH_EXCEPTION,[this.tplClasspath],t)}},onRefreshAnimationEnd:function(e){if(this._tpl.$onRefreshAnimationEnd)try{this._tpl.$onRefreshAnimationEnd(e)}catch(t){this.$logError(this.AFTER_ANIMATION_END_EXCEPTION,[this.tplClasspath],t)}},$refresh:function(e){if(this._cfg)if(n.isStopped()){if(e){var t=e.section;if(t&&this._mainSection){var i=this._mainSection.getSectionById(t);if(i)return void i.notifyRefreshPlanned(e)}}n.queue({fn:this.$refresh,args:e,scope:this},this)}else{if(!this._cfg.tplDiv)return void this.$logError(this.TEMPLATE_NOT_READY_FOR_REFRESH,[this.tplClasspath]);this._refreshing&&this.$logError(this.ALREADY_REFRESHING,[this.tplClasspath]),this._refreshing=!0,n.stop(),o.stop(),this.$assert(304,!!this._tpl);var r={json:e,beanName:"aria.templates.CfgBeans.RefreshCfg"};A.normalize(r),e=r.json,this.beforeRefresh(e);var i=this.getRefreshedSection({section:e.section,macro:e.macro});this.__disposeProcessingIndicators(),i&&!i.id&&this.__disposeWrappers(),o.resume(),null!=i&&this.insertSection(i,!1,e),this._refreshing=!1,n.resume(),null!=i&&(this.afterRefresh(e),this.$raiseEvent({name:"SectionRefreshed",sectionID:i.id}))}},$getFocusedWidget:function(){return this._focusedWidgetPath},$setFocusedWidget:function(){var t=e.$window.document.activeElement;this._focusedWidgetPath=this._getWidgetPath(t)},_getWidgetPath:function(e){if("BODY"===e.tagName||!h.isInDom(e))return[];for(var t=[];!e.__widget;)e=e.parentElement||e.parentNode;var i=e.__widget.getId();if(!i)return[];t.unshift(i);for(var r=e.__widget._context;this!==r&&null!==r;){if(i=r.getOriginalId(),!i)return[];t.unshift(i),r=r.parent}return null===r?[]:t},getOriginalId:function(){return this._cfg.originalId},getMarkup:function(e){this.$assert(299,null==this._cfg.tplDiv),this.$assert(301,null==this._mainSection);var t=this.getRefreshedSection({macro:e});return t.html},linkToPreviousMarkup:function(e){var t=this._cfg;this.$assert(320,null!=e),this.$assert(322,null==t.tplDiv),this.$assert(324,null!=this._mainSection),t.tplDiv=e,t.div=e.parentNode?e.parentNode:null,this.__addDebugInfo(e),this.insertSection(this._mainSection,!0),this.afterRefresh(),this.$raiseEvent({name:"SectionRefreshed",sectionID:null})},__addDebugInfo:function(e){e&&e.setAttribute&&(e.setAttribute("_template",this.tplClasspath),e.__template=this._tpl,e.__moduleCtrl=this.moduleCtrlPrivate?this.moduleCtrlPrivate:this.moduleCtrl,e.__data=this.data)},__removeDebugInfo:function(e){e&&(e.__data=null,e.__moduleCtrl=null,e.__template=null)},getRefreshedSection:function(e){var t={json:e,beanName:"aria.templates.CfgBeans.GetRefreshedSectionCfg"};A.normalize(t),e=t.json;var i=e.section,r=null;if(null!=i){if(r=this._mainSection?this._mainSection.getSectionById(i):null,null==r)return this.$logError(this.SECTION_OUTPUT_NOT_FOUND,[this.tplClasspath,i]),null;r.beforeRefresh(e),r.stopListeners()}var a=e.writerCallback;null==a&&(a={fn:this._callMacro,args:e.macro,scope:this});var s=this.createSection(a,{ownIdMap:null==r});return null==s?null:(null==r?(this._mainSection&&this._mainSection.$dispose(),this._mainSection=s):(r.removeContent(),r.removeDelegateIdsAndCallbacks(),r.disposeProcessingIndicator(),s.moveContentTo(r),r.html=s.html,s.$dispose(),s=r,s.resumeListeners()),s)},_setOut:function(e){this._out=e;for(var t=this._macrolibs||[],i=0,r=t.length;r>i;i++)t[i]._setOut(e)},insertAdjacentSections:function(e){var t=e.position,i={json:e,beanName:"aria.templates.CfgBeans.InsertAdjacentSectionsCfg"};A.normalize(i);var r=this.createSection({fn:this.__dynamicSectionWriter,scope:this,args:e});h.insertAdjacentHTML(e.refSection.domElt,t,r.html),h.refreshDomElt(this._cfg.tplDiv);var a=e.refSection.object;("beforeBegin"==t||"afterEnd"==t)&&(a=a.parent),this.$assert(459,a);var s=r.moveContentTo(a);r.$dispose(),this.$assert(466,s),this.__processDifferedItems(s);for(var n=0;n<e.sections.length;n++)this.afterRefresh({section:e.sections[n].id})},__dynamicSectionWriter:function(e,t){for(var i=t.sections,r=0,a=i.length;a>r;r++)this.__$insertSection(null,i[r])},createSection:function(e,t){if(null!=this._out)return this.$logError(this.INVALID_STATE_FOR_REFRESH,[this.tplClasspath]),null;var i=new d(this,t),r=null;return this._setOut(i),this.$callback(e,i),r=i.getSection(),i.$dispose(),this._setOut(null),r},insertSection:function(e,t,i){var r,a=this._cfg,s=this._tpl,n=e.id?e.getDom():a.tplDiv;n&&(t||e.insertHTML(n,i),e.id||C.setDivSize(n,s.$width,s.$height,"hidden"),l.addExpando(n,e.delegateId),r=e.initWidgets(),this.__processDifferedItems(r)),t||(this.$assert(743,a.tplDiv&&s),h.refreshDomElt(a.tplDiv))},__processDifferedItems:function(e){if(e.length>0){for(var t=0,i=e.length;i>t;t++)e[t].$onOnce({ElementReady:this.__checkContextReadyCb,scope:this});this._differed=e}else this.__checkContextReadyCb()},__checkContextReadyCb:function(e){if(e){var t=e.src,r=this._differed;r&&i.remove(r,t)}r&&r.length||(this._differed=null,this._ready=!0,this.displayReady(),this.$raiseEvent("Ready"))},__$processWidgetMarkup:function(e,t,i,r){var a=this._out,s=I.call(this,e);s&&s.processWidgetMarkup(t,a,i,r)},__$beginContainerWidget:function(e,t,i,r){var a=this._out;a.skipContent=!1;var s=I.call(this,e);if(!s)return!1;var n=s.processWidgetMarkupBegin(t,a,i,r);return a.skipContent||null==n?(n&&n.writeMarkupEnd(a),!1):(a.addToCtrlStack(n),!0)},__$endContainerWidget:function(){var e=this._out,t=e.removeFromCtrlStack();t.writeMarkupEnd(e)},__$statementOnEvent:function(e,t){this._out.pushDelegate(e,t)},__$statementRepeater:function(e,t){this._out.repeater(t)},initTemplate:function(t){if(!A.normalize({json:t,beanName:"aria.templates.CfgBeans.InitTemplateCfg"}))return!1;this._out=null,this._cfg=t,t.id?this._id=t.id:(this._id="tpl"+x,x++),e.testMode&&(this._prefixIds={}),this.tplClasspath=t.classpath;var i;try{i=e.getClassInstance(t.classpath)}catch(a){return this.$logError(this.TEMPLATE_CONSTR_ERROR,[t.classpath],a),!1}this._tpl=i,null==t.macro&&(t.macro={name:"main",args:t.args,scope:i}),t.macro=this.checkMacro(t.macro);var n,o,l=t.context,c=t.moduleCtrl,u=t.data;if(l&&!c&&(u||(u=l.data),c=l.moduleCtrl),c)if(aria.templates.ModuleCtrlFactory){if(T||(T=aria.templates.ModuleCtrlFactory.__getModulePrivateInfoMethod()),n=T.call(this,c),!n)return!1;if(o=n.moduleCtrlPrivate,u){if(l){var h=o.getSubModuleCtrl(u);if(h!=c){if(c=h,n=T.call(this,c),!n)return!1;o=n.moduleCtrlPrivate}}}else u=o.getData()}else this.$logError(this.MISSING_MODULE_CTRL_FACTORY,[t.classpath]);this.data=u,this.moduleCtrl=c,n&&(this.flowCtrl=n.flowCtrl,this.flowCtrlPrivate=n.flowCtrlPrivate,this.moduleCtrlPrivate=o,this.moduleRes=o.getResourceSet()),t.data=u,t.moduleCtrl=c,s.add(this),null!=this.data&&(this.__dataGround={data:this.data});var p,d,f=this;for(p=0;d=b[p];p++)i[d]=this[d];var m=r;for(p=0;d=w[p];p++)i[d]=m.bind(this[d],this);i.__$write=function(e,t){return f.__$write(e,t,this.$classpath)},this.moduleCtrl&&this.moduleCtrl.$on({"*":{fn:i.onModuleEvent,scope:i},beforeDispose:{fn:this._beforeModuleDispose,scope:this}}),this.flowCtrl&&this.flowCtrl.$on({"*":i.onFlowEvent,scope:i}),this._width={},this._height={},this.$setViewportWidth(C.realWidth(t.width)),this.$setViewportHeight(C.realHeight(t.height)),this.$setSizeCfg(i.__$width,i.__$height),this.__addDebugInfo(t.tplDiv);var _=i.__$initTemplate();return this.__loadLibs(i.__$macrolibs,"macrolibs"),_},__$insertSection:function(e,t,i){if(a.isString(t)&&(t={id:t}),t.macro=t.macro||i,!t.macro){var r=t.id||"";this.$logError(this.MISSING_SECTION_MACRO,[this.tplClasspath,"'"+r+"'"])}return this._out.beginSection(t),this._out.endSection()},__$write:function(e,t,i){return(void 0===e||null===e)&&this.$logWarn(this.VAR_NULL_OR_UNDEFINED,[t,i]),this._out.write(e)},$hdim:function(e,t,i){return C.getSODim(this._width,e,t,i)},$vdim:function(e,t,i){return C.getSODim(this._height,e,t,i)},getContainerDiv:function(){return this._cfg&&this._cfg.div?this._cfg.div:null},$setViewportWidth:function(e){var t=this._width;return C.setSOViewport(t,e),this._tpl.$width!=t.value?(this._tpl.$width=t.value,!0):!1},$setViewportHeight:function(e){var t=this._height;return C.setSOViewport(t,e),this._tpl.$height!=t.value?(this._tpl.$height=t.value,!0):!1},$setSizeCfg:function(e,t){e&&C.setSOSizeCfg(this._width,e),this._tpl.$width=this._width.value,t&&C.setSOSizeCfg(this._height,t),this._tpl.$height=this._height.value},evalCallback:function(e,t,i){return this._tpl.$callback(e,t,i)},$getId:function(e){return[this._id,e].join("_")},$getAutoId:function(e){e=this._id+"_"+e.replace(/\+/g,"");var t=this._prefixIds,i=t[e]=(t[e]||0)+1;return e+"_auto_"+i},__$writeId:function(e){var t=this._out.tplCtxt._generateDomId(e);t&&this._out.write('id="'+t+'"')},_generateDomId:function(t){var t=t+"";return t&&-1!=t.indexOf("+")?e.testMode?this.$getAutoId(t):null:this.$getId(t)},$getElementById:function(e){var t=this.$getId(e),i=h.getElementById(t);if(!i)return null;var r,a=this._mainSection.getSectionById(e);return r=a?new u(i,a):new p(i,this),this.__wrappers&&this.__wrappers.push(r),r},$getChild:function(e,t){var i=h,r=this.$getId(e),a=i.getElementById(r);if(a)var s=i.getDomElementChild(a,t);if(s){var n=new p(s,this);return this.__wrappers&&this.__wrappers.push(n),n}return null},getBehaviorById:function(e){return null==this._mainSection?null:this._mainSection.getBehaviorById(e)},getPersistentStorage:function(){var t=this._persistentStorage;return null==t&&(this.data?(t=this.data[e.FRAMEWORK_PREFIX+"persist::"+this.tplClasspath],null==t&&(t={},this.data[e.FRAMEWORK_PREFIX+"persist::"+this.tplClasspath]=t)):t={},this._persistentStorage=t),t},$focus:function(e){l.ieFocusFix();var t;if(a.isArray(e)?(e=e.slice(0),t=e.shift()):(t=e,e=[]),t){var i=!1,r=this.getBehaviorById(t);if(r&&"undefined"!=typeof r.focus&&(r.focus(e),i=!0),!i){var s=this.$getId(t),n=h.getElementById(s);n&&(n.focus(),i=!0)}i||this.$logError(this.FOCUS_FAILURE,[t,this.tplClasspath])}},$focusFromParent:function(){if(this._tpl.$focusFromParent)return this._tpl.$focusFromParent();var e=h.getElementById(this._id);return c.focusFirst(e)},__$createView:function(e,t,i){var r=this.getPersistentStorage();t.unshift(e);for(var a,s=t.length,n=r,o=0;s-1>o;o++)a=t[o],n[a]||(n[a]=[]),n=n[a];return a=t[s-1],n[a]?(n=n[a],n.initialArray=i):(n[a]=new aria.templates.View(i),n=n[a]),n.refresh(),r[e]},isReady:function(){return this._ready},_beforeModuleDispose:function(t){var i=t.reloadingObject,r=this._getReloadCfg(),a=i&&this.moduleCtrl.getData()==r.data;if(e.disposeTemplate(r.div),i){var s=this;i.$on({scope:{},objectLoaded:function(e){r.moduleCtrl=e.object,a&&(r.data=e.object.getData()),s._callLoadTemplate(r)}})}},_getReloadCfg:function(){var e=this.getContainerDiv(),t=this._cfg.origClasspath?this._cfg.origClasspath:this._cfg.classpath,i={classpath:t,width:this._cfg.width,height:this._cfg.height,printOptions:this._cfg.printOptions,div:e,data:this._cfg.data,moduleCtrl:this.moduleCtrlPrivate,provideContext:!0,args:this._cfg.args};return this._cfg.toDispose=[],i},_callLoadTemplate:function(t,i){var r=t.div;if(!h.isInDom(r))return void this.$callback(i);var a=r.__widget;e.loadTemplate(t,function(e){if(e.success&&a){var t=e.tplCtxt,r=s;r.remove(t),e.tplCtxt._cfg.isRootTemplate=!1,r.add(t),a.subTplCtxt=t}null!=i&&this.$callback(i)})},$reload:function(t,i){var r=this._getReloadCfg();t&&aria.templates.TemplateManager.$onOnce({unloadTemplate:{fn:function(){var e=r.classpath.replace(/\./g,"/")+".tpl",i=y.getItem("files",e,!0);i.status=3,i.value=t},scope:this}}),r.reload=!0,r.reloadByPassCache=!0;var a=e.disposeTemplate(r.div);a?this._callLoadTemplate(r,i):this.$logError("Could not reload template: "+r.classpath)},getCSSDependencies:function(){var e;return this._tpl&&(e=this._tpl.$css),null==e&&(e=[]),e},getCSSClassNames:function(e){var t=this._cssClasses;if(!t){if(this._cfg.isRootTemplate){var i=["aria.templates.GlobalStyle"];aria.widgets&&aria.widgets.AriaSkin&&i.push("aria.templates.LegacyGeneralStyle"),o.loadWidgetDependencies("aria.templates.Template",i),this._globalCssDepsLoaded=!0}t=o.loadDependencies(this),this._cssClasses=t}if(e)return t.join(" ");var r=["xTplContent"];return t.length&&(r=r.concat(t)),$.addPrintOptions(r.join(" "),this._cfg.printOptions)},registerProcessingIndicator:function(e,t){this.$assert(1200,null!=t),e?this.__loadingOverlays.push(t):i.remove(this.__loadingOverlays,t)},refreshProcessingIndicator:function(){this._mainSection&&this._mainSection.refreshProcessingIndicator(!0)},__disposeProcessingIndicators:function(){f.disposeOverlays(this.__loadingOverlays),this.__loadingOverlays=[]},__disposeWrappers:function(){for(var e=this.__wrappers.length;e--;)this.__wrappers[e].$dispose(),this.__wrappers.splice(e,1)},getContainerScroll:function(){var e=null,t=this.getContainerDiv();return t&&(e={scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}),e},setContainerScroll:function(e){var t=this.getContainerDiv();t&&e&&(e.hasOwnProperty("scrollLeft")&&null!=e.scrollLeft&&(t.scrollLeft=e.scrollLeft),e.hasOwnProperty("scrollTop")&&null!=e.scrollTop&&(t.scrollTop=e.scrollTop))}}})}();
//*******************
//LOGICAL-PATH:aria/templates/TemplateManager.js
//*******************
var e=require("../Aria"),t=require("../core/Cache"),i=require("../core/ClassMgr");module.exports=e.classDefinition({$classpath:"aria.templates.TemplateManager",$singleton:!0,$events:{unloadTemplate:""},$prototype:{unloadTemplate:function(r,a,s){var n=i,o=r+"Script",l=e.getLogicalPath(o,".js");(e.nspace(o,!1)||t.getItem("files",l))&&n.unloadClass(o,a);var c=e.$classDefinitions[r];if(c){if(!e.nspace(r,!1)&&c.$css&&aria.templates.CSSMgr.unregisterDependencies(r,c.$css,!0,a),null!=c.$resources){var u=c.$resources;for(var h in u){var p=u[h];u.hasOwnProperty(h)&&!p.hasOwnProperty("provider")&&n.unloadClass(e.getClasspath(p),a)}}var d=e.getClasspath(c.$extends);null!=d&&"aria.templates.Template"!=d&&void 0!==s&&s!=r&&this.unloadTemplate(d,a,s)}n.unloadClass(r,a),this.$raiseEvent({name:"unloadTemplate",classpath:r})}}});
//*******************
//LOGICAL-PATH:aria/templates/TemplateTrait.js
//*******************
var e=require("../Aria");module.exports=e.classDefinition({$classpath:"aria.templates.TemplateTrait",$prototype:{_onModuleCtrlLoad:function(){var e=this._tplcfg;if(e)if(this._needCreatingModuleCtrl){var t=this._cfg.moduleCtrl;aria.templates.ModuleCtrlFactory.createModuleCtrl(t,{fn:this._onTplLoad,scope:this,args:{autoDispose:t.autoDispose}})}else this._onTplLoad({moduleCtrl:e.moduleCtrl},{autoDispose:!1})},__innerTplReadyCb:function(){this.subTplCtxt.viewReady(),this.$raiseEvent("ElementReady"),this.isDiffered=!1},_focusHelper:function(e){return e&&e.length?(this.subTplCtxt.$focus(e),!0):this.subTplCtxt.$focusFromParent()},_deleteTplcfg:function(){if(this._tplcfg){var e=this._tplcfg,t=e.toDispose;if(t)for(var i=t.length,r=0;i>r;r++)t[r].$dispose();e.toDispose=null,e.tplDiv=null,e.div=null,e.data=null,this._tplcfg=null}},focus:function(e,t){return this.subTplCtxt?this._focusHelper(e):(this.$onOnce({ElementReady:function(){var i=this._focusHelper(e);i===!1&&this.$callback(t)},scope:this}),!0)}}});
//*******************
//LOGICAL-PATH:aria/templates/TxtParser.js
//*******************
var e=require("../Aria"),t=require("./Parser");module.exports=e.classDefinition({$classpath:"aria.templates.TxtParser",$extends:t,$singleton:!0,$constructor:function(){this.$Parser.constructor.apply(this,arguments),this._keepWhiteSpace=!0},$prototype:{parseTemplate:function(e,t,i,r){return this.context=t,this._prepare(e,r),this._computeLineNumbers(),this._buildTree(r)}}});
//*******************
//LOGICAL-PATH:aria/templates/View.js
//*******************
var e=require("../Aria"),t=require("../utils/Json"),i=require("../utils/StackHashMap"),r=require("../utils/Type");!function(){var a,s=function(e,t){return e.sortKey==t.sortKey?0:e.sortKey>t.sortKey?1:-1},n=function(e,t){return e.sortKey==t.sortKey?0:e.sortKey>t.sortKey?-1:1},o=function(e,t){return e.value[t.propertyName]};module.exports=e.classDefinition({$classpath:"aria.templates.View",$onload:function(){a=t},$onunload:function(){a=null},$constructor:function(e){return r.isObject(e)||r.isArray(e)?(this.initialArray=e,this.sortOrder=this.SORT_INITIAL,this.sortName=null,this.sortKeyGetter=null,this.items=[],this.filteredInCount=0,this.pageSize=-1,this.pageMode=!1,this.currentPageIndex=0,this.pages=this.EMPTY_PAGES,this._currentState={initialArray:null,sortOrder:this.sortOrder,sortName:this.sortName,sortKeyGetter:this.sortKeyGetter,pageSize:this.pageSize,currentPageIndex:this.currentPageIndex},this._changes=0,this._jsonChangeCallback={fn:this._notifyDataChange,scope:this},void this._refreshInitialArray()):void this.$logError(this.INVALID_TYPE_OF_ARGUMENT)},$destructor:function(){this.items&&(this._removeListenersOnItems(this.items),this.items=null),this._jsonChangeCallback=null,this.initialArray=null,this.pages=null},$statics:{SORT_INITIAL:"I",SORT_ASCENDING:"A",SORT_DESCENDING:"D",FILTER_SET:0,FILTER_ADD:1,FILTER_REMOVE:2,CHANGED_INITIAL_ARRAY:1,CHANGED_SORT_CRITERIA:2,_CHANGED_FILTERED_IN:4,_CHANGED_PAGE_DATA:8,EMPTY_PAGES:[{pageIndex:0,pageNumber:1,firstItemIndex:0,lastItemIndex:-1,firstItemNumber:0,lastItemNumber:0}],INVALID_TYPE_OF_ARGUMENT:"Invalid type: a View can be created on Arrays or Objects",UNDEFINED_ARRAY_ELEMENT:"Invalid Array element: creating a View with an undefined element",propertySorter:function(e){return{scope:this,fn:o,args:{propertyName:e}}}},$prototype:{notifyChange:function(e){this._changes=this._changes|e},refresh:function(e){e&&this.notifyChange(e);var t=this._currentState;this._refreshInitialArray(),this.$assert(156,t.initialArray==this.initialArray),this.sortOrder==this.SORT_INITIAL?(t.sortOrder!=this.SORT_INITIAL&&this._resetSortOrder(),this.sortName=null,this.sortKeyGetter=null):t.sortKeyGetter!=this.sortKeyGetter||t.sortName!=this.sortName||this._changes&this.CHANGED_SORT_CRITERIA?this._sort():this.sortOrder!=t.sortOrder&&(this.$assert(167,this.sortOrder!=this.SORT_INITIAL&&t.sortKeyGetter==this.sortKeyGetter&&t.sortName==this.sortName&&!(this._changes&this.CHANGED_SORT_CRITERIA)),this.items.reverse(),t.sortOrder=this.sortOrder,this._changes=this._changes|this._CHANGED_PAGE_DATA),this.$assert(176,this.sortOrder==t.sortOrder),this.$assert(177,this.sortKeyGetter==t.sortKeyGetter),this.$assert(178,this.sortName==t.sortName),(t.pageSize!=this.pageSize||this._changes&(this._CHANGED_PAGE_DATA|this._CHANGED_FILTERED_IN))&&this._refreshPageData(),this.$assert(181,this.pageSize==t.pageSize),this.pageMode?(this.$assert(194,this.pages.length>=0),this.currentPageIndex<0?this.currentPageIndex=0:this.currentPageIndex>=this.pages.length&&(this.currentPageIndex=this.pages.length-1)):this.currentPageIndex=0,t.currentPageIndex=this.currentPageIndex,this._changes=0},_notifyDataChange:function(){this._changes=this._changes|this._CHANGED_FILTERED_IN},_removeListenersOnItems:function(e){for(var t=e.length,i=0;t>i;i++)a.removeListener(e[i],"filteredIn",this._jsonChangeCallback)},_refreshInitialArray:function(){var e,t=this._currentState,a=this.initialArray;if(t.initialArray!=a||this._changes&this.CHANGED_INITIAL_ARRAY){if(t.initialArray){e=new i;for(var s,n=this.items,o=n.length,l=0;o>l;l++)s=n[l],e.push(s.value,s)}if(r.isObject(a))var u=this._getItemsFromMap(e);else var u=this._getItemsFromArray(e);e&&(this._removeListenersOnItems(e.removeAll()),e.$dispose()),this.items=u.items;var c=u.filteredOutElements,h=this.items.length;t.initialArray=a,t.sortOrder=this.SORT_INITIAL,t.sortName=null,t.sortKeyGetter=null,t.pageSize=-1,this.filteredInCount=h-c,this.pages=[{pageIndex:0,pageNumber:1,firstItemIndex:0,lastItemIndex:h-1,firstItemNumber:h>0?1:0,lastItemNumber:this.filteredInCount}],this._changes=this._changes&!this.CHANGED_INITIAL_ARRAY}},_getItemsFromArray:function(e){for(var t=this.initialArray,i=[],r=0,s=t.length,n=0;s>n;n++){var o=t[n],l=null;e&&(l=e.pop(o)),null==l?null!=o?(l={value:o,initIndex:n,filteredIn:!0,sortKey:null,pageIndex:0},a.addListener(l,"filteredIn",this._jsonChangeCallback,!0)):this.$logError(this.UNDEFINED_ARRAY_ELEMENT):l.pageIndex=0,l&&(i[n]=l,l.filteredIn||r++)}return{items:i,filteredOutElements:r}},_getItemsFromMap:function(e){var t=0,i=[],r=0,s=this.initialArray;for(var n in s)if(s.hasOwnProperty(n)&&!a.isMetadata(n)){var o=s[n],l=null;e&&(l=e.pop(o)),null==l?(l={value:o,initIndex:n,filteredIn:!0,sortKey:null,pageIndex:0},a.addListener(l,"filteredIn",this._jsonChangeCallback,!0)):l.pageIndex=0,i[t]=l,l.filteredIn||r++,t++}return{items:i,filteredOutElements:r}},_resetSortOrder:function(){var e=this.items,t=e.length,s=[],n=this.initialArray;if(r.isObject(n)){for(var o,l=new i,u=0;t>u;u++)o=e[u],l.push(o.value,o);var c=0;for(var h in n)n.hasOwnProperty(h)&&!a.isMetadata(h)&&(s[c]=l.pop(n[h]),c++);l.$dispose()}else for(var u=0;t>u;u++){var p=e[u];s[p.initIndex]=p,delete e[u]}this.items=s;var d=this._currentState;d.sortOrder=this.SORT_INITIAL,d.sortName=null,d.sortKeyGetter=null,this._changes=this._changes|this._CHANGED_PAGE_DATA},_sort:function(){for(var e=this.sortKeyGetter,t=this.items,i=t.length,r=0;i>r;r++){var a=t[r];a.sortKey=e.fn.call(e.scope,a,e.args)}t.sort(this.sortOrder==this.SORT_ASCENDING?s:n);var o=this._currentState;o.sortKeyGetter=this.sortKeyGetter,o.sortOrder=this.sortOrder,o.sortName=this.sortName,this._changes=this._changes|this._CHANGED_PAGE_DATA},_refreshPageData:function(){var e=this.items,t=e.length,i=this.pageSize;0>=i&&(i=-1);for(var r=[],a=0,s=0,n=0,o=-1,l=0;t>l;l++){var u=e[l];u.filteredIn?(0===n&&(o=l),n++,u.pageIndex=s,n==i&&(r[a++]={pageIndex:s,pageNumber:s+1,firstItemIndex:o,lastItemIndex:l,firstItemNumber:s*i+1,lastItemNumber:(s+1)*i},s++,n=0)):u.pageIndex=-1}this._currentState.pageSize=i,this.pageMode=i>0,this.filteredInCount=s*i+n,n>0&&(r[a++]={pageIndex:s,pageNumber:s+1,firstItemIndex:o,lastItemIndex:t-1,firstItemNumber:s*i+1,lastItemNumber:this.filteredInCount}),0===a&&(r=this.EMPTY_PAGES),this.pages=r},allFilteredIn:function(e){null==e&&(e=!0),this._refreshInitialArray();for(var t=this.items,i=t.length,r=0;i>r;r++)a.setValue(t[r],"filteredIn",e,this._jsonChangeCallback);this.notifyChange(this._CHANGED_FILTERED_IN)},allFilteredOut:function(e){null==e&&(e=!0),this.allFilteredIn(!e)},toggleSortOrder:function(e,t){this.$assert(326,null!=e&&null!=t),this.sortOrder!=this.SORT_INITIAL&&this.sortName==e?this.sortOrder==this.SORT_ASCENDING?this.sortOrder=this.SORT_DESCENDING:(this.$assert(330,this.sortOrder==this.SORT_DESCENDING),this.sortOrder=this.SORT_ASCENDING,this.sortName=e,this.sortKeyGetter=this.$normCallback(t)):(this.sortName=e,this.sortKeyGetter=this.$normCallback(t),this.sortOrder=this.SORT_ASCENDING)},setPageSize:function(e){this.pageSize=e,this.refresh()},setCurrentPageIndex:function(e){this.currentPageIndex=e,this.refresh()},setSort:function(e,t,i){this.sortOrder=e,this.sortName=t,this.sortKeyGetter=this.$normCallback(i),this.refresh()},filterIn:function(e,t){t=this.$normCallback(t);var i=t.fn,r=t.scope;this._refreshInitialArray();for(var s=this.items,n=s.length,o=0;n>o;o++){var l=s[o],u=l.filteredIn;(e==this.FILTER_SET||u===(e==this.FILTER_REMOVE))&&(u=i.call(r,l,t.args),a.setValue(l,"filteredIn",u))}},getNewIndex:function(e,t){for(var i=0,r=e.length;r>i;i+=1)if(e[i].initIndex==t)return i},updateInitialArray:function(e){return r.isObject(e)||r.isArray(e)?(this.initialArray=e,void this._refreshInitialArray()):void this.$logError(this.INVALID_TYPE_OF_ARGUMENT)}}})}();
//*******************
//LOGICAL-PATH:aria/widgetLibs/BaseWidget.js
//*******************
var e=require("../Aria"),t=require("../utils/IdManager"),i=require("../templates/CSSMgr"),r=require("../utils/Array");!function(){var a=null,s=null,n=function(e,t){return e._context&&(t||(t=[]),t.unshift("Template: "+e._context.tplClasspath+", Line: "+e._lineNumber+"\n")),t};module.exports=e.classDefinition({$classpath:"aria.widgetLibs.BaseWidget",$onload:function(){a=new t("w"),s=r},$onunload:function(){a.$dispose(),a=null,s=null},$constructor:function(e,t,r){this._cfg=e,this._context=t,this._lineNumber=r,this._dynamicIds=null,i.loadWidgetDependencies(this.$classpath,this.$css),this.__cssLoaded=!0},$destructor:function(){this._releaseAllDynamicIds(),this.__cssLoaded?(i.unloadWidgetDependencies(this.$classpath,this.$css),this.__cssLoaded=!1):this.$logError(this.WIDGET_DISPOSED_TWICE),this._context=null,this._cfg=null},$statics:{WIDGET_CONTAINER_ONLY:"%1This widget must be used as a container.",WIDGET_NOT_CONTAINER:"%1This widget cannot be used as a container.",WIDGET_DISPOSED_TWICE:"This widget was disposed twice."},$prototype:{writeMarkup:function(){this.$logError(this.WIDGET_CONTAINER_ONLY)},writeMarkupBegin:function(){this.$logError(this.WIDGET_NOT_CONTAINER)},getDom:function(){return null},$logError:function(e,t,i){this.$JsObject.$logError.call(this,e,n(this,t),i)},$logWarn:function(e,t,i){this.$JsObject.$logWarn.call(this,e,n(this,t),i)},$logInfo:function(e,t,i){this.$JsObject.$logInfo.call(this,e,n(this,t),i)},$logDebug:function(e,t,i){this.$JsObject.$logDebug.call(this,e,n(this,t),i)},writeMarkupEnd:function(){},initWidget:function(){},_createDynamicId:function(){var e=a.getId();return this._dynamicIds?this._dynamicIds.push(e):this._dynamicIds=[e],e},_releaseDynamicId:function(e){var t=this._dynamicIds;if(t){var i=s.indexOf(t,e);-1!=i&&(a.releaseId(e),1==t.length?this._dynamicIds=null:s.removeAt(t,i))}},_releaseAllDynamicIds:function(){var e=this._dynamicIds;if(e){for(var t=e.length-1;t>=0;t--)a.releaseId(e[t]);this._dynamicIds=null}}}})}();
//*******************
//LOGICAL-PATH:aria/widgetLibs/BindableWidget.js
//*******************
var e=require("../Aria"),t=require("../utils/Json"),i=require("../utils/Type"),r=require("./BaseWidget");module.exports=e.classDefinition({$classpath:"aria.widgetLibs.BindableWidget",$extends:r,$statics:{INVALID_BEAN:"%1Invalid property '%2' in widget's '%3' configuration."},$constructor:function(e,t,i){this.$BaseWidget.constructor.call(this,e,t,i),this._bindingListeners={}},$destructor:function(){var e=this._bindingListeners,i=t;for(var r in e)if(e.hasOwnProperty(r)){var a=e[r];i.removeListener(a.inside,a.to,a.cb)}this._bindingListeners=null,this.$BaseWidget.$destructor.call(this)},$prototype:{_registerBindings:function(){var e=this._cfg.bind;if(e)for(var t in e)e.hasOwnProperty(t)&&this._registerSingleProperty(t)},_registerSingleProperty:function(e){var i=this._cfg.bind,r=i[e],a=t;if(r){var s={fn:this._notifyDataChange,scope:this,args:e};try{a.addListener(r.inside,r.to,s,!0),this._bindingListeners[e]={inside:r.inside,to:r.to,transform:r.transform,cb:s};var n=this._transform(r.transform,r.inside[r.to],"toWidget");this.setWidgetProperty(e,n)}catch(o){this.$logError(this.INVALID_BEAN,[e,"bind"])}}},_notifyDataChange:e.empty,setWidgetProperty:e.empty,_transform:function(t,r,a){var s=r;if(t){var n=!1,o=i;o.isString(t)&&-1!=t.indexOf(".")&&(t=e.getClassInstance(t),n=!0),t[a]?s=this.evalCallback(t[a],s):o.isFunction(t)&&(s=this.evalCallback(t,s)),n&&t.$dispose()}return s},evalCallback:function(e,t){return this._context?this._context.evalCallback(e,t):void 0}}});
//*******************
//LOGICAL-PATH:aria/widgetLibs/CommonBeans.js
//*******************
var e=require("../Aria"),t=require("../core/JsonTypes");module.exports=e.beanDefinitions({$package:"aria.widgetLibs.CommonBeans",$namespaces:{json:t},$beans:{Callback:{$type:"json:MultiTypes",$contentTypes:[{$type:"json:Object",$properties:{fn:{$type:"FunctionName"},scope:{$type:"json:ObjectRef"},args:{$type:"json:MultiTypes"}}},{$type:"FunctionName"}]},FunctionName:{$type:"json:MultiTypes",$contentTypes:[{$type:"json:String"},{$type:"json:FunctionRef"}]},BindingRef:{$type:"json:Object",$properties:{to:{$type:"json:JsonProperty"},inside:{$type:"json:ObjectRef"},transform:{$type:"TransformRef"}}},TransformRef:{$type:"json:MultiTypes",$contentTypes:[{$type:"json:Object",$properties:{toWidget:{$type:"FunctionName"},fromWidget:{$type:"FunctionName"}}},{$type:"FunctionName"}]}}});
//*******************
//LOGICAL-PATH:aria/widgetLibs/WidgetLib.js
//*******************
var e=require("../Aria");module.exports=e.classDefinition({$classpath:"aria.widgetLibs.WidgetLib",$statics:{UNKWOWN_WIDGET:"Unknown widget name in the library.",ERROR_WIDGET_INIT:"Template %1, line %2: an error occurred while initializing widget %3. Please check the name and classpath of the widget in the library, the constructor of the widget and its %4 method."},$prototype:{widgets:{},getWidgetDependencies:function(t,i){var r=this.widgets[t];return null==r?null:i||null==e.getClassRef(r)?[r]:[]},processWidgetMarkup:function(t,i,r,a){var s=this.widgets[t];try{if(!s)throw this.UNKWOWN_WIDGET;r||(r={});var n=e.getClassRef(s),o=new n(r,i.tplCtxt,a);i.registerBehavior(o),o.writeMarkup(i)}catch(l){i.write("#Error in widget:"+t+"#"),this.$logError(this.ERROR_WIDGET_INIT,[i.tplCtxt.tplClasspath,a,t,"writeMarkup"],l)}},processWidgetMarkupBegin:function(t,i,r,a){var s=this.widgets[t];try{if(s){r||(r={});var n=e.getClassRef(s),o=new n(r,i.tplCtxt,a);return i.registerBehavior(o),o.writeMarkupBegin(i),o}throw this.UNKWOWN_WIDGET}catch(l){i.write("#Error in widget:"+t+"#"),this.$logError(this.ERROR_WIDGET_INIT,[i.tplCtxt.tplClasspath,a,t,"writeMarkupBegin"],l)}}}});